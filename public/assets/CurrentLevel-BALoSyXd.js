import{p as b,j as e,r as m,a1 as E,n as F,b as N,S as O,_ as B,d as G,t as $,aH as H,B as k,w as _,l as s,f as z,g as V,h as Q,db as D,L as w,i as A,u as U,H as q,P as r,aq as W,ar as X,Q as v,as as J,I as K,D as M,e as Y}from"./index-B8PQHtjc.js";import{S as Z}from"./School-F8mJoAwr.js";import{a as ee}from"./studentColumns-mOrPrRKB.js";import{M as te,t as se,C as ne}from"./CustomizedMaterialTable-BQoTtwVw.js";import{b as re}from"./studentAPI-DyXUet_8.js";import{D as oe}from"./DialogActions-BmNk8sop.js";import{u as ie}from"./useLevelById-K7PyoswH.js";import{s as ae}from"./student_ico-BGUw5C9J.js";import{G as ce}from"./Group-BzuzwgJj.js";import{L as C}from"./ListItem-CQImyTSy.js";import{L as S}from"./ListItemText-DzMM1D1F.js";import{P as le}from"./Person-mhly5Vw0.js";import{R as de}from"./RefreshRounded-DD-ja5GB.js";import{G as p}from"./Grid2-B2FVLpOz.js";import{N as xe}from"./Note-Dty2gGWL.js";import{N as he}from"./NoteAltRounded-B38TZnH0.js";import{B as me}from"./Back-D8wcFeGb.js";import"./gradeColor-B1MTvGsq.js";import"./CircleRounded-YWo57tpF.js";import"./TabPanel-WHfZdNAn.js";import"./useThemeProps-CEPKeDia.js";import"./Toolbar-YM__bEFh.js";import"./Chip-DmEpgF7y.js";import"./Autocomplete-Dw57Ihk7.js";import"./Skeleton-DWRiBFRT.js";import"./ButtonGroup-ZC3qSltg.js";import"./InputAdornment-DAOlZ4uj.js";import"./index-BqG4A_N5.js";import"./ListItemSecondaryAction-DOVMjMKm.js";import"./Link-kLE4_HTq.js";import"./ListItemButton-Di0YOqWQ.js";import"./listItemButtonClasses-DySKLRoc.js";import"./Check-JB41DPzl.js";import"./DeleteOutline-BlPFLwFk.js";import"./images-B5fNBSni.js";const R=b(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-8.29 13.29c-.39.39-1.02.39-1.41 0L5.71 12.7a.996.996 0 0 1 0-1.41c.39-.39 1.02-.39 1.41 0L10 14.17l6.88-6.88c.39-.39 1.02-.39 1.41 0s.39 1.02 0 1.41z"}),"CheckBoxRounded"),P=b(e.jsx("path",{d:"M12 6c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6m1 8.91c2.56-.47 4.5-2.71 4.5-5.41C17.5 6.46 15.04 4 12 4S6.5 6.46 6.5 9.5c0 2.7 1.94 4.94 4.5 5.41V17h-1c-.55 0-1 .45-1 1s.45 1 1 1h1v1c0 .55.45 1 1 1s1-.45 1-1v-1h1c.55 0 1-.45 1-1s-.45-1-1-1h-1z"}),"FemaleRounded"),T=b(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m-1-4h2v2h-2zm1.61-9.96c-2.06-.3-3.88.97-4.43 2.79-.18.58.26 1.17.87 1.17h.2c.41 0 .74-.29.88-.67.32-.89 1.27-1.5 2.3-1.28.95.2 1.65 1.13 1.57 2.1-.1 1.34-1.62 1.63-2.45 2.88 0 .01-.01.01-.01.02-.01.02-.02.03-.03.05-.09.15-.18.32-.25.5-.01.03-.03.05-.04.08-.01.02-.01.04-.02.07-.12.34-.2.75-.2 1.25h2c0-.42.11-.77.28-1.07.02-.03.03-.06.05-.09.08-.14.18-.27.28-.39.01-.01.02-.03.03-.04.1-.12.21-.23.33-.34.96-.91 2.26-1.65 1.99-3.56-.24-1.74-1.61-3.21-3.35-3.47"}),"HelpOutlineRounded"),pe=b(e.jsx("path",{d:"M19 4h-4c-.55 0-1 .45-1 1s.45 1 1 1h1.58l-3.97 3.97C11.73 9.36 10.66 9 9.5 9 6.46 9 4 11.46 4 14.5S6.46 20 9.5 20s5.5-2.46 5.5-5.5c0-1.16-.36-2.23-.97-3.12L18 7.42V9c0 .55.45 1 1 1s1-.45 1-1V5c0-.55-.45-1-1-1M9.5 18C7.57 18 6 16.43 6 14.5S7.57 11 9.5 11s3.5 1.57 3.5 3.5S11.43 18 9.5 18"}),"MaleRounded");function je(){var L;const{userState:{session:n}}=m.useContext(E),{state:a}=F(),d=N(),[x,c]=m.useState([]),[o,i]=m.useState(!0),{schoolSessionState:t,schoolSessionDispatch:j}=m.useContext(O),l=t.fileData;m.useEffect(()=>{if(l.data.length>0){const f=l.columns.map(g=>({title:B.upperCase(g),field:g}));c(f)}i(!1)},[l]);const h=()=>{z.fire({title:"Exiting",text:"Do you want to exit?",showCancelButton:!0,backdrop:!1}).then(({isConfirmed:f})=>{f&&j({type:"closeFileDialog"})})},{mutateAsync:u}=G({mutationFn:re}),y=()=>{i(!0);const f={students:l.data,session:{sessionId:n.sessionId,termId:n.termId,levelId:a.levelId},type:l.type};z.fire({title:"Importing students",text:"Do you want to import ?",showCancelButton:!0,backdrop:!1}).then(({isConfirmed:g})=>{g&&u(f,{onSettled:()=>{d.invalidateQueries(["current-students"]),i(!1)},onSuccess:I=>{j(V(I))},onError:I=>{j(Q(I))}}),i(!1)})};return e.jsxs($,{open:l.open,fullScreen:!0,fullWidth:!0,children:[e.jsx(H,{children:"Preview"}),e.jsxs(oe,{sx:{paddingX:3},children:[e.jsx(k,{onClick:h,children:"Cancel"}),e.jsx(k,{variant:"contained",loading:o,onClick:y,children:"Save"})]}),e.jsx(_,{children:((L=l.data)==null?void 0:L.length)===0?e.jsx(s,{children:"No data available"}):e.jsx(te,{title:"Students",isPending:o,icons:se,columns:x,data:l.data,options:{pageSize:10,pageSizeOptions:[10,20,30,50]}})})]})}function fe({subjects:n=[]}){const[a,d]=m.useState(null),x=t=>{d(t.currentTarget)},c=()=>{d(null)},o=!!a,i=o?"simple-popover":void 0;return e.jsxs(e.Fragment,{children:[e.jsx(T,{"aria-describedby":i,variant:"contained",onClick:x}),e.jsx(D,{id:i,open:o,anchorEl:a,onClose:c,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:e.jsxs(w,{children:[e.jsx(C,{secondaryAction:e.jsx("small",{children:"Core"}),children:e.jsx(S,{primary:"Subject",slotProps:{primary:{fontSize:"12px"}}})}),n==null?void 0:n.map(t=>e.jsx(C,{secondaryAction:t!=null&&t.isCore?e.jsx(R,{}):null,children:e.jsx(S,{primary:t==null?void 0:t.name,slotProps:{primary:{fontSize:"12px"}}})},t==null?void 0:t._id))]})})]})}function ue({grades:n=[]}){const[a,d]=m.useState(null),x=t=>{d(t.currentTarget)},c=()=>{d(null)},o=!!a,i=o?"simple-popover":void 0;return e.jsxs(e.Fragment,{children:[e.jsx(T,{"aria-describedby":i,variant:"contained",onClick:x}),e.jsx(D,{id:i,open:o,anchorEl:a,onClose:c,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:e.jsxs(w,{children:[e.jsx(C,{children:e.jsx(S,{primary:"Grading System",slotProps:{primary:{fontSize:"12px"}}})}),n==null?void 0:n.map(t=>e.jsx(C,{secondaryAction:t!=null&&t.isCore?e.jsx(R,{}):null,children:e.jsx(S,{primary:`${t==null?void 0:t.lowestMark} - ${t==null?void 0:t.highestMark} - ${t==null?void 0:t.grade}  - ${t==null?void 0:t.remarks}`,slotProps:{primary:{fontSize:"12px"}}})},t==null?void 0:t._id))]})})]})}const ye=()=>{var u,y;const{id:n,type:a}=A(),d=U(),{students:x,gradeSystem:c,subjects:o,rollNumber:i,levelLoading:t,refetch:j}=ie(n),l=()=>{d(`/level/attendance/${n}/${a}`)};if(t)return e.jsx(q,{value:"Loading Student Information"});const h=B.groupBy(x,"gender");return e.jsxs(r,{children:[e.jsx(W,{sx:{margin:"auto",padding:2},children:e.jsxs(X,{children:[e.jsxs(r,{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",children:[e.jsxs(r,{display:"flex",alignItems:"center",gap:2,flex:1,children:[e.jsxs(r,{children:[e.jsxs(r,{sx:{position:"relative",display:"inline-flex"},children:[e.jsx(v,{variant:"determinate",value:100,size:90,thickness:3,sx:{color:"lightgray"}}),e.jsx(v,{variant:"determinate",value:0,size:90,thickness:3,sx:{position:"absolute",left:0}}),e.jsx(r,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(s,{variant:"h6",component:"div",color:"text.primary",children:"0"})})]}),e.jsx(s,{children:"Performance "})]}),e.jsxs(r,{children:[e.jsxs(s,{variant:"h3",children:[a,e.jsx(J,{color:"success",variant:"dot",overlap:"circular",sx:{marginLeft:1},children:e.jsx(le,{color:"success"})})]}),e.jsx(s,{variant:"body2",color:"text.secondary",textTransform:"uppercase",children:0})]})]}),e.jsx(K,{sx:{justifySelf:"flex-end"},onClick:j,children:e.jsx(de,{sx:{width:{xs:24,md:40},height:{xs:24,md:40}}})})]}),e.jsxs(r,{mt:2,children:[e.jsx(s,{variant:"body2",color:"text.primary",children:"Below is the state of school results by distinct academic year and semesters."}),e.jsx(s,{variant:"body2",color:"text.primary",children:"Only 5 academic year/semester results out of 6 have been approved."})]}),e.jsx(M,{sx:{my:2}}),e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{size:2.3,children:e.jsxs(r,{textAlign:"center",children:[e.jsx(ce,{color:"info"}),e.jsx(s,{variant:"h6",color:"info.main",children:i}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"Students"})]})}),e.jsx(p,{size:2.3,children:e.jsxs(r,{textAlign:"center",children:[e.jsx(pe,{color:"success"}),e.jsx(s,{variant:"h6",color:"success",children:((u=h==null?void 0:h.male)==null?void 0:u.length)??0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"Males"})]})}),e.jsx(p,{size:2.3,children:e.jsxs(r,{textAlign:"center",children:[e.jsx(P,{color:"error"}),e.jsx(s,{variant:"h6",color:"error",children:((y=h==null?void 0:h.female)==null?void 0:y.length)??0}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"Females"})]})}),e.jsx(p,{size:2.3,children:e.jsxs(r,{textAlign:"center",children:[e.jsx(xe,{color:"error"}),e.jsx(s,{variant:"h6",color:"error",children:(o==null?void 0:o.length)??0}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:["Subjects ",e.jsx(fe,{subjects:o})]})]})}),e.jsx(p,{size:2.3,children:e.jsxs(r,{textAlign:"center",children:[e.jsx(P,{color:"error"}),e.jsx(s,{variant:"h6",color:"error",children:c==null?void 0:c.name}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:["Grade System ",e.jsx(ue,{grades:c==null?void 0:c.ratings})]})]})})]}),e.jsx(M,{sx:{my:2}}),e.jsx(r,{children:e.jsx(k,{variant:"contained",startIcon:e.jsx(he,{}),onClick:l,children:"Mark Attendance"})})]})}),e.jsx(ne,{search:!0,isPending:t,title:a,subtitle:`${i} Students`,exportFileName:a||"",columns:ee,data:x,actions:[],icon:ae,style:{}}),e.jsx(je,{})]})},et=()=>{const{type:n}=A();return e.jsxs(e.Fragment,{children:[e.jsx(me,{to:"/level",color:"primary.main"}),e.jsx(Y,{title:"Current Level",subtitle:"Track,manage and control academic and class activities",icon:e.jsx(Z,{color:"inherit",sx:{width:50,height:50}}),color:"primary.main",right:e.jsx(s,{variant:"h5",whiteSpace:"nowrap",pr:2,children:n})}),e.jsx(ye,{})]})};export{et as default};
