import{r,a0 as j,S as C,b as T,d as B,j as o,C as d,y as W,M as w,A as E,l as I,T as a,E as A,fD as N,g as m,h as p,fE as D,e as M,D as k}from"./index-ce442eb1.js";import{C as F}from"./CustomImageChooser-841df1e5.js";const L="/assets/settings_ico-71e8260e.svg";function U(){const s=JSON.parse(localStorage.getItem("@school_info")),{userDispatch:h}=r.useContext(j),[x,g]=r.useState(`https://school-portal-aivn.onrender.com/api/frebbys/v1/images/users/${s==null?void 0:s.badge}`),{schoolSessionDispatch:l}=r.useContext(C),c=T(),{mutateAsync:b}=B({mutationFn:N}),f=(e,n)=>{b(e,{onSettled:()=>{n.setSubmitting(!1),c.invalidateQueries(["school"])},onSuccess:t=>{localStorage.setItem("@school_info",JSON.stringify(e)),h({type:"setUserInfo",payload:t}),l(m(t))},onError:t=>{l(p(t))}})},S=async e=>{var t;const n=(t=e.target)==null?void 0:t.files[0];try{const i=await D(n);l(m("School Image Uploaded")),c.invalidateQueries(["school"]),g(`https://school-portal-aivn.onrender.com/api/frebbys/v1/images/users/${i}`),s.badge=i,localStorage.setItem("@school_info",JSON.stringify(s))}catch{l(p("Error updating school logo"))}};return o.jsx(d,{maxWidth:"md",children:o.jsx(W,{initialValues:s,onSubmit:f,enableReinitialize:!0,children:({values:e,errors:n,touched:t,handleChange:i,handleSubmit:y,isSubmitting:u})=>o.jsxs(o.Fragment,{children:[o.jsx(w,{sx:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",marginY:2},children:o.jsx(F,{handleImageUpload:S,children:o.jsx(E,{src:x,sx:{width:120,height:120,justifySelf:"center",alignSelf:"center"}})})}),o.jsxs(I,{spacing:3,pt:4,children:[o.jsx(a,{label:"School Name",placeholder:"School Name",type:"text",fullWidth:!0,value:e==null?void 0:e.name,onChange:i("name"),error:!!(t.name&&n.name),helperText:t.name&&n.name}),o.jsx(a,{label:"Address",placeholder:"Address",type:"text",fullWidth:!0,value:e==null?void 0:e.address,onChange:i("address"),error:!!(t.address&&n.address),helperText:t.address&&n.address}),o.jsx(a,{label:"Location",placeholder:"Location",type:"text",fullWidth:!0,value:e==null?void 0:e.location,onChange:i("location"),error:!!(t.location&&n.location),helperText:t.location&&n.location}),o.jsx(a,{label:"Email Address",placeholder:"Email Address",type:"email",inputMode:"email",fullWidth:!0,value:e==null?void 0:e.email,onChange:i("email"),error:!!(t.email&&n.email),helperText:t.email&&n.email}),o.jsx(a,{label:"Website",placeholder:"Website",type:"text",fullWidth:!0,value:e==null?void 0:e.website,onChange:i("website"),error:!!(t.website&&n.website),helperText:t.website&&n.website}),o.jsx(a,{label:"Phone Number",placeholder:"e.g. 0244192831-0233847287",type:"text",fullWidth:!0,value:e==null?void 0:e.phonenumber,onChange:i("phonenumber"),error:!!(t.phonenumber&&n.phonenumber),helperText:t.phonenumber&&n.phonenumber?n.phonenumber:'Separate multiple phone numbers with " - "'}),o.jsx(a,{label:"Motto",placeholder:"Motto",type:"text",fullWidth:!0,value:e==null?void 0:e.motto,onChange:i("motto"),error:!!(t.motto&&n.motto),helperText:t.motto&&n.motto}),o.jsx(A,{loading:u,variant:"contained",color:"primary",onClick:y,children:"Save Settings"})]})]})})})}const _=()=>o.jsxs(d,{children:[o.jsx(M,{title:"Settings",subtitle:"Customize and configure system settings to tailor the platform to your school's specific needs.",img:L,backColor:"#012e54"}),o.jsx(k,{}),o.jsx(U,{})]});_.propTypes={};export{_ as default};
