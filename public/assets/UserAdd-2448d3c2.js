import{r as m,f as W,g as z,i as P,j as e,a as A,n as I,aj as N,J as L,S as x,A as R,Y as k,T as U,Z as o,b as r,q as O,h as D,s as E,t as F,ak as v}from"./index-a08c4904.js";import{C as M}from"./CustomDatePicker-c37da33c.js";import{u as Y}from"./initialValues-b083bf80.js";import{T as q,N as Q}from"./nationality-728e96f8.js";import{C as V}from"./CustomTitle-d0e5d50c.js";import{B as $}from"./Back-26c0fe57.js";import{M as n}from"./MenuItem-ddd79fe9.js";import{A as h}from"./Autocomplete-62a3dcdf.js";import"./useMediaQuery-dbbfc5b2.js";import"./InputAdornment-16e34158.js";import"./ListItem-559aef15.js";import"./listItemButtonClasses-628cfd1a.js";import"./ListItemSecondaryAction-33dcc31c.js";import"./Chip-a33d5899.js";import"./ArrowBackRounded-b2e199d9.js";import"./listItemTextClasses-cdd81f8c.js";function me(){const{schoolSessionDispatch:f}=m.useContext(W),j=z(),[b,u]=m.useState(null),[c,g]=m.useState(null),[y]=m.useState(Y),{mutateAsync:w}=P(v),T=(s,t)=>{s.dateofbirth=D(c).format("L"),s.fullname=`${s==null?void 0:s.firstname} ${s==null?void 0:s.lastname}`,w(s,{onSettled:()=>{j.invalidateQueries(["users"]),t.setSubmitting(!1)},onSuccess:a=>{f(E(a)),t.resetForm(),u(null)},onError:a=>{f(F(a))}})};return e.jsxs(e.Fragment,{children:[e.jsx($,{color:"#012e54"}),e.jsx(V,{title:"New User",subtitle:"Track,manage and control courses assigned to you",icon:e.jsx(A,{color:"primary",sx:{width:50,height:50}}),color:"primary.main"}),e.jsx(I,{initialValues:y,onSubmit:T,enableReinitialize:!0,validationSchema:N,children:({values:s,errors:t,touched:a,setFieldValue:d,handleChange:i,handleSubmit:S,isSubmitting:C})=>{const B=l=>{d("profile",l.target.files[0]),u(URL.createObjectURL(l.target.files[0]))};return e.jsx(L,{bgcolor:"#fff",p:2,children:e.jsxs(x,{padding:2,spacing:2,children:[e.jsxs(x,{sx:{position:"relative"},children:[e.jsx(R,{src:b,sx:{width:100,height:100,alignSelf:"center"}}),e.jsx(k,{handleImageUpload:B})]}),e.jsx(U,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Personal information"}),e.jsxs(o,{children:[e.jsx(r,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:s.firstname,onChange:i("firstname"),error:!!(a.firstname&&t.firstname),helperText:a.firstname&&t.firstname}),e.jsx(r,{label:"Lastname",type:"text",fullWidth:!0,size:"small",value:s.lastname,onChange:i("lastname"),error:!!(a.lastname&&t.lastname),helperText:a.lastname&&t.lastname})]}),e.jsx(r,{label:"Username",type:"text",fullWidth:!0,size:"small",value:s.username,onChange:i("username"),error:!!(a.username&&t.username),helperText:a.username&&t.username}),e.jsxs(o,{children:[e.jsx(M,{label:"Date of Birth",date:c,setDate:g,disableFuture:!0,touched:!!(a.dateofbirth&&t.dateofbirth),error:a.dateofbirth&&t.dateofbirth}),e.jsxs(r,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:s.gender,onChange:i("gender"),error:!!(a.gender&&t.gender),helperText:a.gender&&t.gender,children:[e.jsx(n,{value:"male",children:"male"}),e.jsx(n,{value:"female",children:"female"})]})]}),e.jsxs(r,{label:"Role",select:!0,fullWidth:!0,size:"small",value:s.role,onChange:i("role"),error:!!(a.role&&t.role),helperText:a.role&&t.role,children:[e.jsx(n,{value:"administrator",children:"Administrator"}),e.jsx(n,{value:"director",children:"Director"}),e.jsx(n,{value:"secretary",children:"Secretary"}),e.jsx(n,{value:"coordinator",children:"Exams Coordinator"})]}),e.jsxs(o,{children:[e.jsx(r,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:s.email,onChange:i("email"),error:!!(a.email&&t.email),helperText:a.email&&t.email}),e.jsx(r,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:s.phonenumber,onChange:i("phonenumber"),error:!!(a.phonenumber&&t.phonenumber),helperText:a.phonenumber&&t.phonenumber})]}),e.jsx(r,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,value:s.address,onChange:i("address"),error:!!(a.address&&t.address),helperText:a.address&&t.address}),e.jsxs(o,{children:[e.jsx(h,{freeSolo:!0,fullWidth:!0,size:"small",options:q,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:l=>l||"",value:s.residence,onChange:(l,p)=>d("residence",p),renderInput:l=>e.jsx(r,{...l,label:"Residence",fullWidth:!0,size:"small",error:!!(a.residence&&t.residence),helperText:a.residence&&t.residence})}),e.jsx(h,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:Q,noOptionsText:"No Nationality available",getOptionLabel:l=>l||"",value:s.nationality,onChange:(l,p)=>d("nationality",p),renderInput:l=>e.jsx(r,{...l,label:"Nationality",fullWidth:!0,size:"small",error:!!(a.nationality&&t.nationality),helperText:a.nationality&&t.nationality})})]}),e.jsxs(o,{children:[e.jsx(r,{type:"password",label:"Password",fullWidth:!0,size:"small",value:s.password,onChange:i("password"),error:!!(a.password&&t.password),helperText:a.password&&t.password}),e.jsx(r,{type:"password",label:"Confirm Password",fullWidth:!0,size:"small",value:s.confirmPassword,onChange:i("confirmPassword"),error:!!(a.confirmPassword&&t.confirmPassword),helperText:a.confirmPassword&&t.confirmPassword})]}),e.jsx(x,{direction:"row",justifyContent:"flex-end",spacing:2,paddingY:2,children:e.jsx(O,{loading:C,variant:"contained",color:"primary",sx:{minWidth:{xs:100,sm:150}},onClick:S,children:"Save User"})})]})})}})]})}export{me as default};
