import{W as N,b as R,r as m,S as L,eX as F,m as S,d as O,j as e,s as P,t as k,w as Q,fp as U,v as M,k as T,A as $,l as q,T as l,$ as C,y as G,g as W,h as z}from"./index-DrgqF6h7.js";import{c as V}from"./studentAPI-RzOrRYDb.js";import{C as u}from"./CustomFormControl-BOFleHo6.js";import{C as X}from"./CustomDatePicker-D2bLCilT.js";import{T as Y,N as H}from"./nationality-Dhsqpti8.js";import{C as J}from"./CustomImageChooser-B_xkuEqQ.js";import{A as B}from"./Autocomplete-D4vPEd6T.js";import{D as K}from"./DialogActions-Cx2GHHEW.js";import"./AdapterMoment-Dv21LUiO.js";import"./index-_n9xtSlI.js";import"./useThemeProps-DLRF2U3R.js";import"./generateUtilityClasses-CIQngnWt.js";import"./createTheme-xb4osIQ4.js";import"./createStyled-CRj7xEq5.js";import"./InputAdornment-EcTjtcuD.js";import"./ListItem-yCsexoBs.js";import"./ListItemSecondaryAction-mmiMbVqP.js";import"./listItemButtonClasses-CLhmtlXH.js";import"./Chip-BcLQNplL.js";const v=()=>{const x=R(),[c,b]=m.useState(null),[g,j]=m.useState(null),{schoolSessionDispatch:d}=m.useContext(L),{studentState:{editStudentData:p},studentDispatch:D}=m.useContext(F),s=p==null?void 0:p.data;m.useEffect(()=>{b(S(s==null?void 0:s.dateofbirth)),j(s==null?void 0:s.profile)},[s]);const y=()=>{D({type:"editStudent",payload:{open:!1,data:{}}})},{mutateAsync:I,isLoading:w}=O({mutationFn:V}),A=n=>{n.dateofbirth=S(c).format("L"),n.profile=g,I(n,{onSettled:()=>{x.invalidateQueries(["student-profile"])},onSuccess:t=>{d(W(t)),y()},onError:t=>{d(z(t))}})},E=async n=>{var a;const t=(a=n.target)==null?void 0:a.files[0];try{const r=new FileReader;r.onload=function(i){const f=i.target.result;j(f),d(W("Photo Updated"))},r.readAsDataURL(t)}catch(r){d(z(r))}x.invalidateQueries(["students"]),x.invalidateQueries(["student-by-id"])};return e.jsxs(P,{open:p.open,maxWidth:"lg",fullWidth:!0,children:[e.jsx(k,{title:"Edit Student Information",onClose:y}),e.jsx(Q,{initialValues:s,onSubmit:A,enableReinitialize:!0,validationSchema:U,children:({values:n,errors:t,touched:a,setFieldValue:r,handleChange:i,handleSubmit:f})=>e.jsxs(e.Fragment,{children:[e.jsx(M,{sx:{display:"flex",justifyContent:"center"},children:e.jsxs(T,{padding:2,spacing:1,children:[e.jsx(T,{alignSelf:"center",children:e.jsx(J,{handleImageUpload:E,children:e.jsx($,{srcSet:g,sx:{width:100,height:100,alignSelf:"center"}})})}),e.jsx(q,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Personal information"}),e.jsx(l,{label:"Student ID",type:"text",sx:{maxWidth:300},size:"small",value:n.indexnumber,onChange:i("indexnumber"),error:!!(a.indexnumber&&t.indexnumber),helperText:a.indexnumber&&t.indexnumber}),e.jsxs(u,{children:[e.jsx(l,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:n.firstname||"",onChange:i("firstname"),error:!!(a.firstname&&t.firstname),helperText:a.firstname&&t.firstname}),e.jsx(l,{label:"Surname",fullWidth:!0,size:"small",value:n.surname||"",onChange:i("surname"),error:!!(a.surname&&t.surname),helperText:a.surname&&t.surname}),e.jsx(l,{label:"Othername",fullWidth:!0,size:"small",value:n.othername||"",onChange:i("othername"),error:!!(a.othername&&t.othername),helperText:a.othername&&t.othername})]}),e.jsxs(u,{children:[e.jsx(X,{label:"Date of Birth",date:c,setDate:b,disableFuture:!0,error:!!(a.dateofbirth&&t.dateofbirth),helperText:a.dateofbirth&&t.dateofbirth}),e.jsxs(l,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:n.gender||"",onChange:i("gender"),error:!!(a.gender&&t.gender),helperText:a.gender&&t.gender,children:[e.jsx(C,{value:"male",children:"male"}),e.jsx(C,{value:"female",children:"female"})]})]}),e.jsxs(u,{children:[e.jsx(l,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:n.email||"",onChange:i("email"),error:!!(a.email&&t.email),helperText:a.email&&t.email}),e.jsx(l,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:n.phonenumber||"",onChange:i("phonenumber"),error:!!(a.phonenumber&&t.phonenumber),helperText:a.phonenumber&&t.phonenumber})]}),e.jsx(l,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,value:n.address||"",onChange:i("address"),error:!!(a.address&&t.address),helperText:a.address&&t.address}),e.jsxs(u,{children:[e.jsx(B,{freeSolo:!0,fullWidth:!0,size:"small",options:Y,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:o=>o||"",value:n.residence||"",onChange:(o,h)=>r("residence",h),renderInput:o=>e.jsx(l,{...o,label:"Residence",fullWidth:!0,size:"small",error:!!(a.residence&&t.residence),helperText:a.residence&&t.residence})}),e.jsx(B,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:H,noOptionsText:"No Nationality available",getOptionLabel:o=>o||"",value:n.nationality||"",onChange:(o,h)=>r("nationality",h),renderInput:o=>e.jsx(l,{...o,label:"Nationality",fullWidth:!0,size:"small",error:!!(a.nationality&&t.nationality),helperText:a.nationality&&t.nationality})})]})]})}),e.jsx(K,{children:e.jsx(G,{loading:w,variant:"contained",color:"primary",onClick:f,children:"Save Changes"})})]})})]})};v.propTypes={};const be=N.memo(v);export{be as default};
