import{p as Q,j as e,r as j,aE as U,aD as X,aF as J,B as u,I as Z,aK as ee,i as G,b as se,c as F,d as te,t as O,v as re,x as oe,ao as ne,O as ae,w as z,k as d,T as P,l as c,L as ie,aI as le,_ as A,X as ce,bt as V,fl as H,am as xe,aH as de,D as T,A as Y,C as he}from"./index-B8PQHtjc.js";import{g as k}from"./gradeColor-B1MTvGsq.js";import{L as je}from"./ListItemButton-Di0YOqWQ.js";import{L as C}from"./ListItemText-DzMM1D1F.js";import{L as pe}from"./ListItemSecondaryAction-DOVMjMKm.js";import{f as me,g as ue}from"./ExaminationAPI-gfcTwHm9.js";import{G as E}from"./Grid2-B2FVLpOz.js";import{A as fe}from"./Autocomplete-Dw57Ihk7.js";import{D as W}from"./DialogActions-BmNk8sop.js";import{R as Se}from"./index-DThQnLGZ.js";import{R as x,E as ge,a as R}from"./ReportItemUnderline-MmYFOo6z.js";import{s as ye,f as be,C as Ce}from"./createTheme-DxYQS8Dz.js";import{u as ve,e as we}from"./extendSxProp-CRL7S0jW.js";import{g as Re}from"./generateUtilityClasses-BPC_uuYP.js";import{B as Ae}from"./ButtonGroup-ZC3qSltg.js";import{R as Te}from"./ReportRounded-783hZjIF.js";import"./listItemButtonClasses-DySKLRoc.js";import"./Chip-DmEpgF7y.js";const Ie=Q(e.jsx("path",{d:"M18 13h-5v5c0 .55-.45 1-1 1s-1-.45-1-1v-5H6c-.55 0-1-.45-1-1s.45-1 1-1h5V6c0-.55.45-1 1-1s1 .45 1 1v5h5c.55 0 1 .45 1 1s-.45 1-1 1"}),"AddRounded"),Be=["className","component"];function De(t={}){const{themeId:i,defaultTheme:o,defaultClassName:n="MuiBox-root",generateClassName:a}=t,s=ye("div",{shouldForwardProp:r=>r!=="theme"&&r!=="sx"&&r!=="as"})(be);return j.forwardRef(function(f,b){const S=ve(o),w=we(f),{className:I,component:B="div"}=w,D=U(w,Be);return e.jsx(s,X({as:B,ref:b,className:J(I,a?a(n):n),theme:i&&S[i]||S},D))})}const Le=Re("MuiBox",["root"]),v=De({defaultClassName:Le.root,generateClassName:Ce.generate}),N=({item:t,removeSubject:i,title:o})=>e.jsxs(je,{divider:!0,children:[e.jsx(C,{sx:{width:120},secondary:t==null?void 0:t.subject,secondaryTypographyProps:{color:"primary"}}),e.jsx(C,{secondary:t==null?void 0:t.classScore}),e.jsx(C,{secondary:t==null?void 0:t.examsScore}),e.jsx(C,{secondary:t==null?void 0:t.totalScore}),e.jsx(C,{secondary:t==null?void 0:t.grade}),e.jsx(u,{size:"small",sx:{color:o?"text.main":k(t==null?void 0:t.totalScore).color,bgcolor:o?"transparent":k(t==null?void 0:t.totalScore).bg,mx:2},children:t==null?void 0:t.remarks}),e.jsx(pe,{sx:{ml:2,pl:2},children:!o&&e.jsx(Z,{className:"ico",onClick:()=>i(t.subject),children:e.jsx(ee,{})})})]}),Pe=(t,i)=>{const o=Number(t)+Number(i);let n="",a="";return o>=75?(n="A1",a="Excellent"):o>=70?(n="B2",a="Very Good"):o>=65?(n="B3",a="Good"):o>=60?(n="C4",a="Good"):o>=55?(n="C5",a="Average"):o>=50?(n="C6",a="Average"):o>=45?(n="D7",a="Pass"):o>=40?(n="E8",a="Weak"):(n="F9",a="Fail"),{totalScore:o,grade:n,remarks:a}},Ee=({open:t,setOpen:i,levelId:o})=>{const{examsId:n}=G(),a=se(),[s,p]=j.useState([]),[r,f]=j.useState([]),[b,S]=j.useState({severity:"",text:""});F({queryKey:["subjects"],queryFn:()=>le(o),enabled:!!o,onSuccess:({subjects:l})=>{p(l)}});const w={subject:"",classScore:0,examsScore:0},I={subject:"Subject",classScore:"Class",examsScore:"Exams",totalScore:"Total",grade:"Grade"},B=(l,h)=>{const g=Pe(l.classScore,l.examsScore),y={...l,...g},L=A.merge(A.keyBy([...r,y],"subject"));f(A.values(L)),h.resetForm()},D=l=>{f(h=>h.filter(({subject:y})=>y!==l))},{isPending:$,mutateAsync:K}=te({mutationFn:me}),M=()=>{K({examsId:n,scores:r},{onSettled:()=>{a.invalidateQueries(["student-records"])},onSuccess:()=>{S({severity:"info",text:"Student Scores updated successfully!!!"})}})};return e.jsxs(O,{open:t,onClose:()=>i(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(re,{title:"Student Assessment Information"}),e.jsx(oe,{initialValues:w,validationSchema:ne,onSubmit:B,children:({values:l,errors:h,touched:g,handleChange:y,handleSubmit:L,setFieldValue:_})=>e.jsxs(e.Fragment,{children:[b.text&&e.jsx(ae,{sx:{marginY:1},severity:b.severity,onClose:()=>S({text:""}),children:b.text}),e.jsx(z,{children:e.jsxs(E,{container:!0,spacing:2,rowGap:2,children:[e.jsxs(E,{item:!0,xs:12,md:6,padding:2,children:[e.jsxs(d,{spacing:2,paddingY:2,children:[e.jsx(fe,{freeSolo:!0,options:s,getOptionLabel:m=>m||"",value:l.subject,onChange:(m,q)=>_("subject",q),renderInput:m=>e.jsx(P,{...m,label:"Subject",size:"small",error:!!h.subject,helperText:g.subject&&h.subject})}),e.jsx(P,{type:"number",label:"Class Score",size:"small",value:l.classScore,onChange:y("classScore"),error:!!h.classScore,helperText:g.classScore&&h.classScore}),e.jsx(P,{type:"number",label:"Exams Score",size:"small",value:l.examsScore,onChange:y("examsScore"),error:!!h.examsScore,helperText:g.examsScore&&h.examsScore})]}),e.jsx(u,{variant:"contained",size:"small",onClick:L,children:"Add"})]}),e.jsx(E,{item:!0,xs:12,md:6,padding:2,children:e.jsxs(d,{children:[e.jsx(c,{variant:"caption",children:"Preview"}),e.jsx(N,{item:I,title:!0}),e.jsx(ie,{sx:{maxHeight:300,overflowY:"scroll"},children:r.map(m=>e.jsx(N,{item:m,removeSubject:D},m.subject))})]})})]})}),e.jsx(W,{sx:{padding:2},children:e.jsx(u,{loading:$,variant:"contained",disabled:r.length===0,onClick:M,children:"Save Results"})})]})})]})},ke=()=>{const{palette:t}=V(),i=j.useRef(),{studentState:o,studentDispatch:n}=j.useContext(H),a=o.showCurrentStudentAcademicsReportView.show,s=o.showCurrentStudentAcademicsReportView.examsDetails,p=()=>{n({type:"showCurrentStudentAcademicsReportView",payload:{show:!1,examsDetails:{}}})};return e.jsxs(O,{open:a,onClose:p,fullWidth:!0,maxWidth:"md",TransitionComponent:xe,children:[e.jsx(de,{children:"Report Card"}),e.jsxs(z,{ref:i,children:[e.jsx(T,{}),e.jsxs(d,{spacing:1,children:[e.jsxs(d,{justifyContent:"center",alignItems:"center",children:[e.jsx(c,{variant:"h4",children:"Christ Goodness International School"}),e.jsx(c,{sx:{fontSize:"14px"},children:"Post Office Box KS 134"}),e.jsx(c,{sx:{fontSize:"14px"},children:"Kumasi"}),e.jsx(c,{sx:{textAlign:"center",textDecoration:"underline",borderTop:`solid 5px ${t.secondary.main}`,bgcolor:"primary.main",color:"primary.contrastText",width:"100%",padding:1},children:"Report Card"})]}),e.jsx(d,{justifyContent:"center",alignItems:"center",children:e.jsx(Y,{src:(s==null?void 0:s.profile)===""||(s==null?void 0:s.profile)===void 0||(s==null?void 0:s.profile)===null?null:s==null?void 0:s.profile,sx:{width:65,height:65}})}),e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(v,{children:e.jsx("table",{children:e.jsxs("tbody",{children:[e.jsx(x,{title:"Full Name",text:s==null?void 0:s.fullName}),e.jsx(x,{title:"Class",text:`${s==null?void 0:s.level}`}),e.jsx(x,{title:"No. On Roll",text:s==null?void 0:s.rollNumber}),e.jsx(x,{title:"Grade",text:"35"}),e.jsx(x,{title:"Promoted",text:"Six(6)"})]})})}),e.jsxs(v,{sx:{flexGrow:1,alignItems:"center",textAlign:"center",paddingRight:4},children:[e.jsx("p",{children:"Position"}),e.jsx(c,{variant:"h5",children:"6"})]}),e.jsx(v,{children:e.jsx("table",{children:e.jsxs("tbody",{children:[e.jsx(x,{title:"Academic Year",text:s==null?void 0:s.academicYear}),e.jsx(x,{title:"Term",text:s==null?void 0:s.term}),e.jsx(x,{title:"Vacation Date",text:s==null?void 0:s.vacationDate}),e.jsx(x,{title:"Reopening Date",text:s==null?void 0:s.reOpeningDate})]})})})]}),e.jsx(d,{children:e.jsxs("table",{style:{textAlign:"center",borderCollapse:"collapse"},border:"1",children:[e.jsx("thead",{style:{bgcolor:"primary.main",color:"secondary.main"},children:e.jsxs("tr",{children:[e.jsx("th",{children:"Subject"}),e.jsx("th",{children:" Class Score (50%)"}),e.jsx("th",{children:" Exams Score (50%)"}),e.jsx("th",{children:"Total Score (100%)"}),e.jsx("th",{children:"Position"}),e.jsx("th",{children:"Grade"}),e.jsx("th",{children:"Remarks"})]})}),e.jsx("tbody",{children:(s==null?void 0:s.scores)!==void 0?(s==null?void 0:s.scores.length)!==0&&(s==null?void 0:s.scores.map(r=>e.jsx(ge,{item:r},r.subject))):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",style:{padding:"3px 1px",fontSize:"20px"},children:"No Student Record Available"})})}),e.jsx("tfoot",{style:{textAlign:"center",textDecoration:"underline",borderTop:`solid 5px ${t.secondary.main}`,bgcolor:"primary.main",color:"primary.contrastText",width:"100%",padding:1},children:e.jsxs("tr",{children:[e.jsx("th",{children:"Overall Score"}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{children:A.sumBy(s==null?void 0:s.scores,"totalScore")}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{})]})})]})}),e.jsx(v,{children:e.jsx("table",{width:"100%",children:e.jsxs("tbody",{children:[e.jsx("tr",{children:e.jsxs("td",{width:"100%",style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[e.jsx(x,{title:"Attendance",text:"11"}),e.jsx(x,{title:"Out Of",text:s==null?void 0:s.totalLevelAttendance})]})}),e.jsx("tr",{children:e.jsx("td",{width:"50%",children:e.jsx(R,{title:"Conduct & Attitude",text:"Hardworking"})})}),e.jsx("tr",{children:e.jsx("td",{width:"50%",children:e.jsx(R,{title:"Interest",text:"Hardworking"})})}),e.jsx("tr",{children:e.jsx("td",{width:"100%",children:e.jsx(R,{title:"Class Teacher's Remarks",text:"Excellent Performance Keep it up!"})})}),e.jsx("tr",{children:e.jsx("td",{width:"100%",children:e.jsx(R,{title:"Headmaster's Remarks",text:"Proud of her performance."})})})]})})}),e.jsx(T,{}),e.jsxs(d,{justifyContent:"center",alignItems:"center",children:[e.jsx(c,{children:"Bill"}),e.jsxs("table",{width:"60%",border:"1",style:{borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{children:"GHS"}),e.jsx("th",{children:"GHP"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{paddingLeft:"5px",fontSize:"14px"},children:"Tuition Fee"}),e.jsx("td",{}),e.jsx("td",{})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{paddingLeft:"5px",fontSize:"14px"},children:"Others"}),e.jsx("td",{}),e.jsx("td",{})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{paddingLeft:"5px",fontSize:"14px"},children:"Arreas"}),e.jsx("td",{}),e.jsx("td",{})]})]}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Total"}),e.jsx("th",{}),e.jsx("th",{})]})})]})]}),e.jsx(c,{style:{fontSize:"10px",fontStyle:"italic"},children:"Powered by FrebbyTech Consults (0543772591)"})]})]}),e.jsxs(W,{children:[e.jsx(u,{sx:{displayPrint:!1},children:"Ok"}),e.jsx(Se,{pageStyle:'width:8.5in";min-height:11in"; margin:auto",padding:8px;',trigger:()=>e.jsx(u,{variant:"contained",children:"Print Report"}),content:()=>i.current})]})]})},Ne=ce.memo(ke),es=()=>{const{examsId:t}=G(),{palette:i}=V(),[o,n]=j.useState(""),{studentDispatch:a}=j.useContext(H),[s,p]=j.useState(!1),{data:r}=F(["student-records",t],()=>ue(t)),f=()=>{n(r==null?void 0:r.levelId),a({type:"showCurrentStudentAcademicsReportView",payload:{show:!0,examsDetails:r}})};return e.jsxs(he,{sx:{paddingY:2},maxWidth:"lg",children:[e.jsxs("div",{id:"printPage",children:[e.jsx(d,{justifyContent:"flex-end",direction:"row",children:e.jsx(c,{variant:"h3",children:"Student Examination Report"})}),e.jsx(T,{}),e.jsxs(d,{paddingY:2,justifyContent:"center",alignItems:"center",children:[e.jsx(Y,{src:(r==null?void 0:r.profile)===""||(r==null?void 0:r.profile)===void 0||(r==null?void 0:r.profile)===null?null:r==null?void 0:r.profile,sx:{width:80,height:80}}),e.jsx(c,{variant:"h5",sx:{textTransform:"capitalize"},children:r==null?void 0:r.fullName}),e.jsx(c,{variant:"body2",children:r==null?void 0:r.level})]}),e.jsx(T,{}),e.jsxs(d,{children:[e.jsx(c,{variant:"h5",sx:{textAlign:"center",textDecoration:"underline",borderTop:`solid 5px ${i.secondary.main}`,bgcolor:"primary.main",color:"primary.contrastText",width:"100%",padding:1},children:"Examination Report"}),e.jsx(d,{justifyContent:"flex-end",direction:"row",paddingY:2,children:e.jsxs(Ae,{children:[e.jsx(u,{startIcon:e.jsx(Ie,{}),variant:"contained",onClick:()=>p(!0),children:"New Score"}),e.jsx(u,{startIcon:e.jsx(Te,{}),onClick:f,children:"View Report"})]})})]})]}),e.jsx(Ne,{}),e.jsx(Ee,{open:s,setOpen:p,levelId:o})]})};export{es as default};
