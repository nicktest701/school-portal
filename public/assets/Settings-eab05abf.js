import{r,a0 as y,f as C,g as B,i as T,j as o,C as d,n as W,J as w,Y as I,A,S as E,b as s,q as N,f8 as k,s as m,t as p,f9 as D,D as F}from"./index-a08c4904.js";import{C as J}from"./CustomTitle-d0e5d50c.js";const L="/assets/settings_ico-71e8260e.svg";function M(){const a=JSON.parse(localStorage.getItem("@school_info")),{userDispatch:x}=r.useContext(y),[h,g]=r.useState(`/images/users/${a==null?void 0:a.badge}`),{schoolSessionDispatch:l}=r.useContext(C),c=B(),{mutateAsync:b}=T({mutationFn:k}),f=(e,n)=>{b(e,{onSettled:()=>{n.setSubmitting(!1),c.invalidateQueries(["school"])},onSuccess:t=>{localStorage.setItem("@school_info",JSON.stringify(e)),x({type:"setUserInfo",payload:t}),l(m(t))},onError:t=>{l(p(t))}})},S=async e=>{var t;const n=(t=e.target)==null?void 0:t.files[0];try{const i=await D(n);l(m("School Image Uploaded")),c.invalidateQueries(["school"]),g(`/images/users/${i}`),a.badge=i,localStorage.setItem("@school_info",JSON.stringify(a))}catch{l(p("Error updating school logo"))}};return o.jsx(d,{maxWidth:"md",children:o.jsx(W,{initialValues:a,onSubmit:f,enableReinitialize:!0,children:({values:e,errors:n,touched:t,handleChange:i,handleSubmit:u,isSubmitting:j})=>o.jsxs(o.Fragment,{children:[o.jsx(w,{sx:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",marginY:2},children:o.jsx(I,{handleImageUpload:S,children:o.jsx(A,{src:h,sx:{width:120,height:120,justifySelf:"center",alignSelf:"center"}})})}),o.jsxs(E,{spacing:3,pt:4,children:[o.jsx(s,{label:"School Name",placeholder:"School Name",type:"text",fullWidth:!0,value:e==null?void 0:e.name,onChange:i("name"),error:!!(t.name&&n.name),helperText:t.name&&n.name}),o.jsx(s,{label:"Address",placeholder:"Address",type:"text",fullWidth:!0,value:e==null?void 0:e.address,onChange:i("address"),error:!!(t.address&&n.address),helperText:t.address&&n.address}),o.jsx(s,{label:"Location",placeholder:"Location",type:"text",fullWidth:!0,value:e==null?void 0:e.location,onChange:i("location"),error:!!(t.location&&n.location),helperText:t.location&&n.location}),o.jsx(s,{label:"Email Address",placeholder:"Email Address",type:"email",inputMode:"email",fullWidth:!0,value:e==null?void 0:e.email,onChange:i("email"),error:!!(t.email&&n.email),helperText:t.email&&n.email}),o.jsx(s,{label:"Website",placeholder:"Website",type:"text",fullWidth:!0,value:e==null?void 0:e.website,onChange:i("website"),error:!!(t.website&&n.website),helperText:t.website&&n.website}),o.jsx(s,{label:"Phone Number",placeholder:"e.g. 0244192831-0233847287",type:"text",fullWidth:!0,value:e==null?void 0:e.phonenumber,onChange:i("phonenumber"),error:!!(t.phonenumber&&n.phonenumber),helperText:t.phonenumber&&n.phonenumber?n.phonenumber:'Separate multiple phone numbers with " - "'}),o.jsx(s,{label:"Motto",placeholder:"Motto",type:"text",fullWidth:!0,value:e==null?void 0:e.motto,onChange:i("motto"),error:!!(t.motto&&n.motto),helperText:t.motto&&n.motto}),o.jsx(N,{loading:j,variant:"contained",color:"primary",onClick:u,children:"Save Settings"})]})]})})})}const U=()=>o.jsxs(d,{children:[o.jsx(J,{title:"Settings",subtitle:"Customize and configure system settings to tailor the platform to your school's specific needs.",img:L,backColor:"#012e54"}),o.jsx(F,{}),o.jsx(M,{})]});U.propTypes={};export{U as default};
