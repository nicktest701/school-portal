import{W as p,j as x,T as Ue,n as z,a as zt,r as Ye,S as ft,b as yt,c as Qt,d as ht,v as gt,w as mt,x as vt,l as Pe,m as Kt,D as _t,E as xt,g as bt,h as Vt,al as Gt,F as Jt,$ as Xt,fq as Zt,V as er}from"./index-ce442eb1.js";import{c as tr,p as rr,e as sr}from"./termAPI-177926e4.js";import{L as ir,A as ar,D as nr}from"./AdapterMoment-20f157db.js";import{D as Ft}from"./DialogActions-c9d7df2e.js";import{s as lr}from"./initialValues-876203b9.js";import{g as ur}from"./sessionColumns-a7ba1da8.js";import{D as je}from"./react-datetime-9b766c95.js";import"./useMediaQuery-5bcb3f64.js";import"./InputAdornment-92a613d9.js";import"./ListItem-2727fabf.js";import"./listItemButtonClasses-c7063ebe.js";import"./ListItemSecondaryAction-660d9daa.js";import"./Chip-15117b24.js";import"./currencyFormatter-1910a788.js";import"./CircleRounded-06f2dceb.js";import"./Edit-009e8578.js";import"./Delete-fb41f478.js";import"./ListItemText-b107adf9.js";var ge=e=>e.type==="checkbox",le=e=>e instanceof Date,R=e=>e==null;const St=e=>typeof e=="object";var C=e=>!R(e)&&!Array.isArray(e)&&St(e)&&!le(e),At=e=>C(e)&&e.target?ge(e.target)?e.target.checked:e.target.value:e,or=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,Dt=(e,r)=>e.has(or(r)),dr=e=>{const r=e.constructor&&e.constructor.prototype;return C(r)&&r.hasOwnProperty("isPrototypeOf")},Me=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function N(e){let r;const t=Array.isArray(e);if(e instanceof Date)r=new Date(e);else if(e instanceof Set)r=new Set(e);else if(!(Me&&(e instanceof Blob||e instanceof FileList))&&(t||C(e)))if(r=t?[]:{},!t&&!dr(e))r=e;else for(const i in e)e.hasOwnProperty(i)&&(r[i]=N(e[i]));else return e;return r}var De=e=>Array.isArray(e)?e.filter(Boolean):[],k=e=>e===void 0,c=(e,r,t)=>{if(!r||!C(e))return t;const i=De(r.split(/[,[\].]+?/)).reduce((a,n)=>R(a)?a:a[n],e);return k(i)||i===e?k(e[r])?t:e[r]:i},H=e=>typeof e=="boolean",Re=e=>/^\w*$/.test(e),pt=e=>De(e.replace(/["|']|\]/g,"").split(/\.|\[/)),D=(e,r,t)=>{let i=-1;const a=Re(r)?[r]:pt(r),n=a.length,o=n-1;for(;++i<n;){const f=a[i];let _=t;if(i!==o){const b=e[f];_=C(b)||Array.isArray(b)?b:isNaN(+a[i+1])?{}:[]}if(f==="__proto__")return;e[f]=_,e=e[f]}return e};const be={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},K={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},X={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},cr=p.createContext(null),Ie=()=>p.useContext(cr);var wt=(e,r,t,i=!0)=>{const a={defaultValues:r._defaultValues};for(const n in e)Object.defineProperty(a,n,{get:()=>{const o=n;return r._proxyFormState[o]!==K.all&&(r._proxyFormState[o]=!i||K.all),t&&(t[o]=!0),e[o]}});return a},W=e=>C(e)&&!Object.keys(e).length,Et=(e,r,t,i)=>{t(e);const{name:a,...n}=e;return W(n)||Object.keys(n).length>=Object.keys(r).length||Object.keys(n).find(o=>r[o]===(!i||K.all))},ye=e=>Array.isArray(e)?e:[e],kt=(e,r,t)=>!e||!r||e===r||ye(e).some(i=>i&&(t?i===r:i.startsWith(r)||r.startsWith(i)));function Be(e){const r=p.useRef(e);r.current=e,p.useEffect(()=>{const t=!e.disabled&&r.current.subject&&r.current.subject.subscribe({next:r.current.next});return()=>{t&&t.unsubscribe()}},[e.disabled])}function fr(e){const r=Ie(),{control:t=r.control,disabled:i,name:a,exact:n}=e||{},[o,f]=p.useState(t._formState),_=p.useRef(!0),b=p.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),g=p.useRef(a);return g.current=a,Be({disabled:i,next:v=>_.current&&kt(g.current,v.name,n)&&Et(v,b.current,t._updateFormState)&&f({...t._formState,...v}),subject:t._subjects.state}),p.useEffect(()=>(_.current=!0,b.current.isValid&&t._updateValid(!0),()=>{_.current=!1}),[t]),wt(o,t,b.current,!1)}var G=e=>typeof e=="string",Ct=(e,r,t,i,a)=>G(e)?(i&&r.watch.add(e),c(t,e,a)):Array.isArray(e)?e.map(n=>(i&&r.watch.add(n),c(t,n))):(i&&(r.watchAll=!0),t);function yr(e){const r=Ie(),{control:t=r.control,name:i,defaultValue:a,disabled:n,exact:o}=e||{},f=p.useRef(i);f.current=i,Be({disabled:n,subject:t._subjects.values,next:g=>{kt(f.current,g.name,o)&&b(N(Ct(f.current,t._names,g.values||t._formValues,!1,a)))}});const[_,b]=p.useState(t._getWatch(i,a));return p.useEffect(()=>t._removeUnmounted()),_}function hr(e){const r=Ie(),{name:t,disabled:i,control:a=r.control,shouldUnregister:n}=e,o=Dt(a._names.array,t),f=yr({control:a,name:t,defaultValue:c(a._formValues,t,c(a._defaultValues,t,e.defaultValue)),exact:!0}),_=fr({control:a,name:t,exact:!0}),b=p.useRef(a.register(t,{...e.rules,value:f,...H(e.disabled)?{disabled:e.disabled}:{}}));return p.useEffect(()=>{const g=a._options.shouldUnregister||n,v=(j,E)=>{const w=c(a._fields,j);w&&w._f&&(w._f.mount=E)};if(v(t,!0),g){const j=N(c(a._options.defaultValues,t));D(a._defaultValues,t,j),k(c(a._formValues,t))&&D(a._formValues,t,j)}return()=>{(o?g&&!a._state.action:g)?a.unregister(t):v(t,!1)}},[t,a,o,n]),p.useEffect(()=>{c(a._fields,t)&&a._updateDisabledField({disabled:i,fields:a._fields,name:t,value:c(a._fields,t)._f.value})},[i,t,a]),{field:{name:t,value:f,...H(i)||_.disabled?{disabled:_.disabled||i}:{},onChange:p.useCallback(g=>b.current.onChange({target:{value:At(g),name:t},type:be.CHANGE}),[t]),onBlur:p.useCallback(()=>b.current.onBlur({target:{value:c(a._formValues,t),name:t},type:be.BLUR}),[t,a]),ref:p.useCallback(g=>{const v=c(a._fields,t);v&&g&&(v._f.ref={focus:()=>g.focus(),select:()=>g.select(),setCustomValidity:j=>g.setCustomValidity(j),reportValidity:()=>g.reportValidity()})},[a._fields,t])},formState:_,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!c(_.errors,t)},isDirty:{enumerable:!0,get:()=>!!c(_.dirtyFields,t)},isTouched:{enumerable:!0,get:()=>!!c(_.touchedFields,t)},isValidating:{enumerable:!0,get:()=>!!c(_.validatingFields,t)},error:{enumerable:!0,get:()=>c(_.errors,t)}})}}const pe=e=>e.render(hr(e));var jt=(e,r,t,i,a)=>r?{...t[e],types:{...t[e]&&t[e].types?t[e].types:{},[i]:a||!0}}:{},et=e=>({isOnSubmit:!e||e===K.onSubmit,isOnBlur:e===K.onBlur,isOnChange:e===K.onChange,isOnAll:e===K.all,isOnTouch:e===K.onTouched}),tt=(e,r,t)=>!t&&(r.watchAll||r.watch.has(e)||[...r.watch].some(i=>e.startsWith(i)&&/^\.\w+/.test(e.slice(i.length))));const he=(e,r,t,i)=>{for(const a of t||Object.keys(e)){const n=c(e,a);if(n){const{_f:o,...f}=n;if(o){if(o.refs&&o.refs[0]&&r(o.refs[0],a)&&!i)return!0;if(o.ref&&r(o.ref,o.name)&&!i)return!0;if(he(f,r))break}else if(C(f)&&he(f,r))break}}};var gr=(e,r,t)=>{const i=ye(c(e,t));return D(i,"root",r[t]),D(e,t,i),e},Ne=e=>e.type==="file",Z=e=>typeof e=="function",Ve=e=>{if(!Me)return!1;const r=e?e.ownerDocument:0;return e instanceof(r&&r.defaultView?r.defaultView.HTMLElement:HTMLElement)},xe=e=>G(e),We=e=>e.type==="radio",Fe=e=>e instanceof RegExp;const rt={value:!1,isValid:!1},st={value:!0,isValid:!0};var Tt=e=>{if(Array.isArray(e)){if(e.length>1){const r=e.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:r,isValid:!!r.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!k(e[0].attributes.value)?k(e[0].value)||e[0].value===""?st:{value:e[0].value,isValid:!0}:st:rt}return rt};const it={isValid:!1,value:null};var Ot=e=>Array.isArray(e)?e.reduce((r,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:r,it):it;function at(e,r,t="validate"){if(xe(e)||Array.isArray(e)&&e.every(xe)||H(e)&&!e)return{type:t,message:xe(e)?e:"",ref:r}}var ne=e=>C(e)&&!Fe(e)?e:{value:e,message:""},nt=async(e,r,t,i,a)=>{const{ref:n,refs:o,required:f,maxLength:_,minLength:b,min:g,max:v,pattern:j,validate:E,name:w,valueAsNumber:ee,mount:I,disabled:B}=e._f,V=c(r,w);if(!I||B)return{};const U=o?o[0]:n,J=F=>{i&&U.reportValidity&&(U.setCustomValidity(H(F)?"":F||""),U.reportValidity())},T={},ie=We(n),me=ge(n),re=ie||me,ae=(ee||Ne(n))&&k(n.value)&&k(V)||Ve(n)&&n.value===""||V===""||Array.isArray(V)&&!V.length,q=jt.bind(null,w,t,T),ve=(F,S,O,M=X.maxLength,Q=X.minLength)=>{const $=F?S:O;T[w]={type:F?M:Q,message:$,ref:n,...q(F?M:Q,$)}};if(a?!Array.isArray(V)||!V.length:f&&(!re&&(ae||R(V))||H(V)&&!V||me&&!Tt(o).isValid||ie&&!Ot(o).isValid)){const{value:F,message:S}=xe(f)?{value:!!f,message:f}:ne(f);if(F&&(T[w]={type:X.required,message:S,ref:U,...q(X.required,S)},!t))return J(S),T}if(!ae&&(!R(g)||!R(v))){let F,S;const O=ne(v),M=ne(g);if(!R(V)&&!isNaN(V)){const Q=n.valueAsNumber||V&&+V;R(O.value)||(F=Q>O.value),R(M.value)||(S=Q<M.value)}else{const Q=n.valueAsDate||new Date(V),$=ce=>new Date(new Date().toDateString()+" "+ce),oe=n.type=="time",de=n.type=="week";G(O.value)&&V&&(F=oe?$(V)>$(O.value):de?V>O.value:Q>new Date(O.value)),G(M.value)&&V&&(S=oe?$(V)<$(M.value):de?V<M.value:Q<new Date(M.value))}if((F||S)&&(ve(!!F,O.message,M.message,X.max,X.min),!t))return J(T[w].message),T}if((_||b)&&!ae&&(G(V)||a&&Array.isArray(V))){const F=ne(_),S=ne(b),O=!R(F.value)&&V.length>+F.value,M=!R(S.value)&&V.length<+S.value;if((O||M)&&(ve(O,F.message,S.message),!t))return J(T[w].message),T}if(j&&!ae&&G(V)){const{value:F,message:S}=ne(j);if(Fe(F)&&!V.match(F)&&(T[w]={type:X.pattern,message:S,ref:n,...q(X.pattern,S)},!t))return J(S),T}if(E){if(Z(E)){const F=await E(V,r),S=at(F,U);if(S&&(T[w]={...S,...q(X.validate,S.message)},!t))return J(S.message),T}else if(C(E)){let F={};for(const S in E){if(!W(F)&&!t)break;const O=at(await E[S](V,r),U,S);O&&(F={...O,...q(S,O.message)},J(O.message),t&&(T[w]=F))}if(!W(F)&&(T[w]={ref:U,...F},!t))return T}}return J(!0),T};function mr(e,r){const t=r.slice(0,-1).length;let i=0;for(;i<t;)e=k(e)?i++:e[r[i++]];return e}function vr(e){for(const r in e)if(e.hasOwnProperty(r)&&!k(e[r]))return!1;return!0}function L(e,r){const t=Array.isArray(r)?r:Re(r)?[r]:pt(r),i=t.length===1?e:mr(e,t),a=t.length-1,n=t[a];return i&&delete i[n],a!==0&&(C(i)&&W(i)||Array.isArray(i)&&vr(i))&&L(e,t.slice(0,-1)),e}var Te=()=>{let e=[];return{get observers(){return e},next:a=>{for(const n of e)n.next&&n.next(a)},subscribe:a=>(e.push(a),{unsubscribe:()=>{e=e.filter(n=>n!==a)}}),unsubscribe:()=>{e=[]}}},Se=e=>R(e)||!St(e);function te(e,r){if(Se(e)||Se(r))return e===r;if(le(e)&&le(r))return e.getTime()===r.getTime();const t=Object.keys(e),i=Object.keys(r);if(t.length!==i.length)return!1;for(const a of t){const n=e[a];if(!i.includes(a))return!1;if(a!=="ref"){const o=r[a];if(le(n)&&le(o)||C(n)&&C(o)||Array.isArray(n)&&Array.isArray(o)?!te(n,o):n!==o)return!1}}return!0}var Lt=e=>e.type==="select-multiple",_r=e=>We(e)||ge(e),Oe=e=>Ve(e)&&e.isConnected,Yt=e=>{for(const r in e)if(Z(e[r]))return!0;return!1};function Ae(e,r={}){const t=Array.isArray(e);if(C(e)||t)for(const i in e)Array.isArray(e[i])||C(e[i])&&!Yt(e[i])?(r[i]=Array.isArray(e[i])?[]:{},Ae(e[i],r[i])):R(e[i])||(r[i]=!0);return r}function Pt(e,r,t){const i=Array.isArray(e);if(C(e)||i)for(const a in e)Array.isArray(e[a])||C(e[a])&&!Yt(e[a])?k(r)||Se(t[a])?t[a]=Array.isArray(e[a])?Ae(e[a],[]):{...Ae(e[a])}:Pt(e[a],R(r)?{}:r[a],t[a]):t[a]=!te(e[a],r[a]);return t}var _e=(e,r)=>Pt(e,r,Ae(r)),Ut=(e,{valueAsNumber:r,valueAsDate:t,setValueAs:i})=>k(e)?e:r?e===""?NaN:e&&+e:t&&G(e)?new Date(e):i?i(e):e;function Le(e){const r=e.ref;if(!(e.refs?e.refs.every(t=>t.disabled):r.disabled))return Ne(r)?r.files:We(r)?Ot(e.refs).value:Lt(r)?[...r.selectedOptions].map(({value:t})=>t):ge(r)?Tt(e.refs).value:Ut(k(r.value)?e.ref.value:r.value,e)}var xr=(e,r,t,i)=>{const a={};for(const n of e){const o=c(r,n);o&&D(a,n,o._f)}return{criteriaMode:t,names:[...e],fields:a,shouldUseNativeValidation:i}},fe=e=>k(e)?e:Fe(e)?e.source:C(e)?Fe(e.value)?e.value.source:e.value:e;const lt="AsyncFunction";var br=e=>(!e||!e.validate)&&!!(Z(e.validate)&&e.validate.constructor.name===lt||C(e.validate)&&Object.values(e.validate).find(r=>r.constructor.name===lt)),Vr=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function ut(e,r,t){const i=c(e,t);if(i||Re(t))return{error:i,name:t};const a=t.split(".");for(;a.length;){const n=a.join("."),o=c(r,n),f=c(e,n);if(o&&!Array.isArray(o)&&t!==n)return{name:t};if(f&&f.type)return{name:n,error:f};a.pop()}return{name:t}}var Fr=(e,r,t,i,a)=>a.isOnAll?!1:!t&&a.isOnTouch?!(r||e):(t?i.isOnBlur:a.isOnBlur)?!e:(t?i.isOnChange:a.isOnChange)?e:!0,Sr=(e,r)=>!De(c(e,r)).length&&L(e,r);const Ar={mode:K.onSubmit,reValidateMode:K.onChange,shouldFocusError:!0};function Dr(e={}){let r={...Ar,...e},t={submitCount:0,isDirty:!1,isLoading:Z(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1},i={},a=C(r.defaultValues)||C(r.values)?N(r.defaultValues||r.values)||{}:{},n=r.shouldUnregister?{}:N(a),o={action:!1,mount:!1,watch:!1},f={mount:new Set,unMount:new Set,array:new Set,watch:new Set},_,b=0;const g={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},v={values:Te(),array:Te(),state:Te()},j=et(r.mode),E=et(r.reValidateMode),w=r.criteriaMode===K.all,ee=s=>l=>{clearTimeout(b),b=setTimeout(s,l)},I=async s=>{if(g.isValid||s){const l=r.resolver?W((await re()).errors):await q(i,!0);l!==t.isValid&&v.state.next({isValid:l})}},B=(s,l)=>{(g.isValidating||g.validatingFields)&&((s||Array.from(f.mount)).forEach(u=>{u&&(l?D(t.validatingFields,u,l):L(t.validatingFields,u))}),v.state.next({validatingFields:t.validatingFields,isValidating:!W(t.validatingFields)}))},V=(s,l=[],u,h,y=!0,d=!0)=>{if(h&&u){if(o.action=!0,d&&Array.isArray(c(i,s))){const m=u(c(i,s),h.argA,h.argB);y&&D(i,s,m)}if(d&&Array.isArray(c(t.errors,s))){const m=u(c(t.errors,s),h.argA,h.argB);y&&D(t.errors,s,m),Sr(t.errors,s)}if(g.touchedFields&&d&&Array.isArray(c(t.touchedFields,s))){const m=u(c(t.touchedFields,s),h.argA,h.argB);y&&D(t.touchedFields,s,m)}g.dirtyFields&&(t.dirtyFields=_e(a,n)),v.state.next({name:s,isDirty:F(s,l),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else D(n,s,l)},U=(s,l)=>{D(t.errors,s,l),v.state.next({errors:t.errors})},J=s=>{t.errors=s,v.state.next({errors:t.errors,isValid:!1})},T=(s,l,u,h)=>{const y=c(i,s);if(y){const d=c(n,s,k(u)?c(a,s):u);k(d)||h&&h.defaultChecked||l?D(n,s,l?d:Le(y._f)):M(s,d),o.mount&&I()}},ie=(s,l,u,h,y)=>{let d=!1,m=!1;const A={name:s},Y=!!(c(i,s)&&c(i,s)._f&&c(i,s)._f.disabled);if(!u||h){g.isDirty&&(m=t.isDirty,t.isDirty=A.isDirty=F(),d=m!==A.isDirty);const P=Y||te(c(a,s),l);m=!!(!Y&&c(t.dirtyFields,s)),P||Y?L(t.dirtyFields,s):D(t.dirtyFields,s,!0),A.dirtyFields=t.dirtyFields,d=d||g.dirtyFields&&m!==!P}if(u){const P=c(t.touchedFields,s);P||(D(t.touchedFields,s,u),A.touchedFields=t.touchedFields,d=d||g.touchedFields&&P!==u)}return d&&y&&v.state.next(A),d?A:{}},me=(s,l,u,h)=>{const y=c(t.errors,s),d=g.isValid&&H(l)&&t.isValid!==l;if(e.delayError&&u?(_=ee(()=>U(s,u)),_(e.delayError)):(clearTimeout(b),_=null,u?D(t.errors,s,u):L(t.errors,s)),(u?!te(y,u):y)||!W(h)||d){const m={...h,...d&&H(l)?{isValid:l}:{},errors:t.errors,name:s};t={...t,...m},v.state.next(m)}},re=async s=>{B(s,!0);const l=await r.resolver(n,r.context,xr(s||f.mount,i,r.criteriaMode,r.shouldUseNativeValidation));return B(s),l},ae=async s=>{const{errors:l}=await re(s);if(s)for(const u of s){const h=c(l,u);h?D(t.errors,u,h):L(t.errors,u)}else t.errors=l;return l},q=async(s,l,u={valid:!0})=>{for(const h in s){const y=s[h];if(y){const{_f:d,...m}=y;if(d){const A=f.array.has(d.name),Y=y._f&&br(y._f);Y&&g.validatingFields&&B([h],!0);const P=await nt(y,n,w,r.shouldUseNativeValidation&&!l,A);if(Y&&g.validatingFields&&B([h]),P[d.name]&&(u.valid=!1,l))break;!l&&(c(P,d.name)?A?gr(t.errors,P,d.name):D(t.errors,d.name,P[d.name]):L(t.errors,d.name))}!W(m)&&await q(m,l,u)}}return u.valid},ve=()=>{for(const s of f.unMount){const l=c(i,s);l&&(l._f.refs?l._f.refs.every(u=>!Oe(u)):!Oe(l._f.ref))&&we(s)}f.unMount=new Set},F=(s,l)=>(s&&l&&D(n,s,l),!te(qe(),a)),S=(s,l,u)=>Ct(s,f,{...o.mount?n:k(l)?a:G(s)?{[s]:l}:l},u,l),O=s=>De(c(o.mount?n:a,s,e.shouldUnregister?c(a,s,[]):[])),M=(s,l,u={})=>{const h=c(i,s);let y=l;if(h){const d=h._f;d&&(!d.disabled&&D(n,s,Ut(l,d)),y=Ve(d.ref)&&R(l)?"":l,Lt(d.ref)?[...d.ref.options].forEach(m=>m.selected=y.includes(m.value)):d.refs?ge(d.ref)?d.refs.length>1?d.refs.forEach(m=>(!m.defaultChecked||!m.disabled)&&(m.checked=Array.isArray(y)?!!y.find(A=>A===m.value):y===m.value)):d.refs[0]&&(d.refs[0].checked=!!y):d.refs.forEach(m=>m.checked=m.value===y):Ne(d.ref)?d.ref.value="":(d.ref.value=y,d.ref.type||v.values.next({name:s,values:{...n}})))}(u.shouldDirty||u.shouldTouch)&&ie(s,y,u.shouldTouch,u.shouldDirty,!0),u.shouldValidate&&ce(s)},Q=(s,l,u)=>{for(const h in l){const y=l[h],d=`${s}.${h}`,m=c(i,d);(f.array.has(s)||!Se(y)||m&&!m._f)&&!le(y)?Q(d,y,u):M(d,y,u)}},$=(s,l,u={})=>{const h=c(i,s),y=f.array.has(s),d=N(l);D(n,s,d),y?(v.array.next({name:s,values:{...n}}),(g.isDirty||g.dirtyFields)&&u.shouldDirty&&v.state.next({name:s,dirtyFields:_e(a,n),isDirty:F(s,d)})):h&&!h._f&&!R(d)?Q(s,d,u):M(s,d,u),tt(s,f)&&v.state.next({...t}),v.values.next({name:o.mount?s:void 0,values:{...n}})},oe=async s=>{o.mount=!0;const l=s.target;let u=l.name,h=!0;const y=c(i,u),d=()=>l.type?Le(y._f):At(s),m=A=>{h=Number.isNaN(A)||te(A,c(n,u,A))};if(y){let A,Y;const P=d(),se=s.type===be.BLUR||s.type===be.FOCUS_OUT,qt=!Vr(y._f)&&!r.resolver&&!c(t.errors,u)&&!y._f.deps||Fr(se,c(t.touchedFields,u),t.isSubmitted,E,j),ke=tt(u,f,se);D(n,u,P),se?(y._f.onBlur&&y._f.onBlur(s),_&&_(0)):y._f.onChange&&y._f.onChange(s);const Ce=ie(u,P,se,!1),$t=!W(Ce)||ke;if(!se&&v.values.next({name:u,type:s.type,values:{...n}}),qt)return g.isValid&&(e.mode==="onBlur"?se&&I():I()),$t&&v.state.next({name:u,...ke?{}:Ce});if(!se&&ke&&v.state.next({...t}),r.resolver){const{errors:Xe}=await re([u]);if(m(P),h){const Ht=ut(t.errors,i,u),Ze=ut(Xe,i,Ht.name||u);A=Ze.error,u=Ze.name,Y=W(Xe)}}else B([u],!0),A=(await nt(y,n,w,r.shouldUseNativeValidation))[u],B([u]),m(P),h&&(A?Y=!1:g.isValid&&(Y=await q(i,!0)));h&&(y._f.deps&&ce(y._f.deps),me(u,Y,A,Ce))}},de=(s,l)=>{if(c(t.errors,l)&&s.focus)return s.focus(),1},ce=async(s,l={})=>{let u,h;const y=ye(s);if(r.resolver){const d=await ae(k(s)?s:y);u=W(d),h=s?!y.some(m=>c(d,m)):u}else s?(h=(await Promise.all(y.map(async d=>{const m=c(i,d);return await q(m&&m._f?{[d]:m}:m)}))).every(Boolean),!(!h&&!t.isValid)&&I()):h=u=await q(i);return v.state.next({...!G(s)||g.isValid&&u!==t.isValid?{}:{name:s},...r.resolver||!s?{isValid:u}:{},errors:t.errors}),l.shouldFocus&&!h&&he(i,de,s?y:f.mount),h},qe=s=>{const l={...o.mount?n:a};return k(s)?l:G(s)?c(l,s):s.map(u=>c(l,u))},$e=(s,l)=>({invalid:!!c((l||t).errors,s),isDirty:!!c((l||t).dirtyFields,s),error:c((l||t).errors,s),isValidating:!!c(t.validatingFields,s),isTouched:!!c((l||t).touchedFields,s)}),It=s=>{s&&ye(s).forEach(l=>L(t.errors,l)),v.state.next({errors:s?t.errors:{}})},He=(s,l,u)=>{const h=(c(i,s,{_f:{}})._f||{}).ref,y=c(t.errors,s)||{},{ref:d,message:m,type:A,...Y}=y;D(t.errors,s,{...Y,...l,ref:h}),v.state.next({name:s,errors:t.errors,isValid:!1}),u&&u.shouldFocus&&h&&h.focus&&h.focus()},Bt=(s,l)=>Z(s)?v.values.subscribe({next:u=>s(S(void 0,l),u)}):S(s,l,!0),we=(s,l={})=>{for(const u of s?ye(s):f.mount)f.mount.delete(u),f.array.delete(u),l.keepValue||(L(i,u),L(n,u)),!l.keepError&&L(t.errors,u),!l.keepDirty&&L(t.dirtyFields,u),!l.keepTouched&&L(t.touchedFields,u),!l.keepIsValidating&&L(t.validatingFields,u),!r.shouldUnregister&&!l.keepDefaultValue&&L(a,u);v.values.next({values:{...n}}),v.state.next({...t,...l.keepDirty?{isDirty:F()}:{}}),!l.keepIsValid&&I()},ze=({disabled:s,name:l,field:u,fields:h,value:y})=>{if(H(s)&&o.mount||s){const d=s?void 0:k(y)?Le(u?u._f:c(h,l)._f):y;D(n,l,d),ie(l,d,!1,!1,!0)}},Ee=(s,l={})=>{let u=c(i,s);const h=H(l.disabled)||H(e.disabled);return D(i,s,{...u||{},_f:{...u&&u._f?u._f:{ref:{name:s}},name:s,mount:!0,...l}}),f.mount.add(s),u?ze({field:u,disabled:H(l.disabled)?l.disabled:e.disabled,name:s,value:l.value}):T(s,!0,l.value),{...h?{disabled:l.disabled||e.disabled}:{},...r.progressive?{required:!!l.required,min:fe(l.min),max:fe(l.max),minLength:fe(l.minLength),maxLength:fe(l.maxLength),pattern:fe(l.pattern)}:{},name:s,onChange:oe,onBlur:oe,ref:y=>{if(y){Ee(s,l),u=c(i,s);const d=k(y.value)&&y.querySelectorAll&&y.querySelectorAll("input,select,textarea")[0]||y,m=_r(d),A=u._f.refs||[];if(m?A.find(Y=>Y===d):d===u._f.ref)return;D(i,s,{_f:{...u._f,...m?{refs:[...A.filter(Oe),d,...Array.isArray(c(a,s))?[{}]:[]],ref:{type:d.type,name:s}}:{ref:d}}}),T(s,!1,void 0,d)}else u=c(i,s,{}),u._f&&(u._f.mount=!1),(r.shouldUnregister||l.shouldUnregister)&&!(Dt(f.array,s)&&o.action)&&f.unMount.add(s)}}},Qe=()=>r.shouldFocusError&&he(i,de,f.mount),Nt=s=>{H(s)&&(v.state.next({disabled:s}),he(i,(l,u)=>{const h=c(i,u);h&&(l.disabled=h._f.disabled||s,Array.isArray(h._f.refs)&&h._f.refs.forEach(y=>{y.disabled=h._f.disabled||s}))},0,!1))},Ke=(s,l)=>async u=>{let h;u&&(u.preventDefault&&u.preventDefault(),u.persist&&u.persist());let y=N(n);if(v.state.next({isSubmitting:!0}),r.resolver){const{errors:d,values:m}=await re();t.errors=d,y=m}else await q(i);if(L(t.errors,"root"),W(t.errors)){v.state.next({errors:{}});try{await s(y,u)}catch(d){h=d}}else l&&await l({...t.errors},u),Qe(),setTimeout(Qe);if(v.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:W(t.errors)&&!h,submitCount:t.submitCount+1,errors:t.errors}),h)throw h},Wt=(s,l={})=>{c(i,s)&&(k(l.defaultValue)?$(s,N(c(a,s))):($(s,l.defaultValue),D(a,s,N(l.defaultValue))),l.keepTouched||L(t.touchedFields,s),l.keepDirty||(L(t.dirtyFields,s),t.isDirty=l.defaultValue?F(s,N(c(a,s))):F()),l.keepError||(L(t.errors,s),g.isValid&&I()),v.state.next({...t}))},Ge=(s,l={})=>{const u=s?N(s):a,h=N(u),y=W(s),d=y?a:h;if(l.keepDefaultValues||(a=u),!l.keepValues){if(l.keepDirtyValues)for(const m of f.mount)c(t.dirtyFields,m)?D(d,m,c(n,m)):$(m,c(d,m));else{if(Me&&k(s))for(const m of f.mount){const A=c(i,m);if(A&&A._f){const Y=Array.isArray(A._f.refs)?A._f.refs[0]:A._f.ref;if(Ve(Y)){const P=Y.closest("form");if(P){P.reset();break}}}}i={}}n=e.shouldUnregister?l.keepDefaultValues?N(a):{}:N(d),v.array.next({values:{...d}}),v.values.next({values:{...d}})}f={mount:l.keepDirtyValues?f.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!g.isValid||!!l.keepIsValid||!!l.keepDirtyValues,o.watch=!!e.shouldUnregister,v.state.next({submitCount:l.keepSubmitCount?t.submitCount:0,isDirty:y?!1:l.keepDirty?t.isDirty:!!(l.keepDefaultValues&&!te(s,a)),isSubmitted:l.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:y?{}:l.keepDirtyValues?l.keepDefaultValues&&n?_e(a,n):t.dirtyFields:l.keepDefaultValues&&s?_e(a,s):l.keepDirty?t.dirtyFields:{},touchedFields:l.keepTouched?t.touchedFields:{},errors:l.keepErrors?t.errors:{},isSubmitSuccessful:l.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1})},Je=(s,l)=>Ge(Z(s)?s(n):s,l);return{control:{register:Ee,unregister:we,getFieldState:$e,handleSubmit:Ke,setError:He,_executeSchema:re,_getWatch:S,_getDirty:F,_updateValid:I,_removeUnmounted:ve,_updateFieldArray:V,_updateDisabledField:ze,_getFieldArray:O,_reset:Ge,_resetDefaultValues:()=>Z(r.defaultValues)&&r.defaultValues().then(s=>{Je(s,r.resetOptions),v.state.next({isLoading:!1})}),_updateFormState:s=>{t={...t,...s}},_disableForm:Nt,_subjects:v,_proxyFormState:g,_setErrors:J,get _fields(){return i},get _formValues(){return n},get _state(){return o},set _state(s){o=s},get _defaultValues(){return a},get _names(){return f},set _names(s){f=s},get _formState(){return t},set _formState(s){t=s},get _options(){return r},set _options(s){r={...r,...s}}},trigger:ce,register:Ee,handleSubmit:Ke,watch:Bt,setValue:$,getValues:qe,reset:Je,resetField:Wt,clearErrors:It,unregister:we,setError:He,setFocus:(s,l={})=>{const u=c(i,s),h=u&&u._f;if(h){const y=h.refs?h.refs[0]:h.ref;y.focus&&(y.focus(),l.shouldSelect&&y.select())}},getFieldState:$e}}function Mt(e={}){const r=p.useRef(),t=p.useRef(),[i,a]=p.useState({isDirty:!1,isValidating:!1,isLoading:Z(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:Z(e.defaultValues)?void 0:e.defaultValues});r.current||(r.current={...Dr(e),formState:i});const n=r.current.control;return n._options=e,Be({subject:n._subjects.state,next:o=>{Et(o,n._proxyFormState,n._updateFormState,!0)&&a({...n._formState})}}),p.useEffect(()=>n._disableForm(e.disabled),[n,e.disabled]),p.useEffect(()=>{if(n._proxyFormState.isDirty){const o=n._getDirty();o!==i.isDirty&&n._subjects.state.next({isDirty:o})}},[n,i.isDirty]),p.useEffect(()=>{e.values&&!te(e.values,t.current)?(n._reset(e.values,n._options.resetOptions),t.current=e.values,a(o=>({...o}))):n._resetDefaultValues()},[e.values,n]),p.useEffect(()=>{e.errors&&n._setErrors(e.errors)},[e.errors,n]),p.useEffect(()=>{n._state.mount||(n._updateValid(),n._state.mount=!0),n._state.watch&&(n._state.watch=!1,n._subjects.state.next({...n._formState})),n._removeUnmounted()}),p.useEffect(()=>{e.shouldUnregister&&n._subjects.values.next({values:n._getWatch()})},[e.shouldUnregister,n]),r.current.formState=wt(i,n),r.current}const ot=({name:e,control:r,label:t,rules:i,defaultValue:a="",...n})=>x.jsx(pe,{name:e,control:r,rules:i,defaultValue:a,render:({field:{onChange:o,value:f,onBlur:_},fieldState:{error:b}})=>x.jsx(Ue,{label:t,value:f,onChange:o,onBlur:_,error:!!b,helperText:b?b.message:null,...n})}),ue=({name:e,control:r,label:t,rules:i,disableFuture:a,style:n})=>x.jsx(pe,{name:e,control:r,rules:i,render:({field:{onChange:o,value:f},fieldState:{error:_}})=>x.jsx(ir,{dateAdapter:ar,children:x.jsx(nr,{label:t,value:f||null,onChange:b=>{o(z(new Date(b)))},format:"Do MMMM YYYY",disableMaskedInput:!0,disableFuture:a,slotProps:{textField:{fullWidth:!0,size:"small",error:!!_,helperText:_?_.message:null}},sx:{width:"100%",...n}})})}),pr=()=>{var j;const[e,r]=zt(),{schoolSessionDispatch:t}=Ye.useContext(ft),i=yt(),a=Qt({queryKey:["terms/:id",e.get("_id")],queryFn:()=>tr(e.get("_id")),initialData:(j=i.getQueryData(["terms"]))==null?void 0:j.find(E=>(E==null?void 0:E.termId)===e.get("_id")),enabled:e.get("_id")!==null&&!!e.get("edit_session")!==null}),{handleSubmit:n,reset:o,control:f}=Mt({defaultValues:{id:"",from:null,to:null,vacationDate:null,reOpeningDate:null,academicYear:"",term:"",session:""}});Ye.useEffect(()=>{var E,w,ee,I,B,V,U;o({id:e.get("_id"),from:z(new Date((E=a==null?void 0:a.data)==null?void 0:E.from)),to:z(new Date((w=a==null?void 0:a.data)==null?void 0:w.to)),vacationDate:z(new Date((ee=a==null?void 0:a.data)==null?void 0:ee.vacationDate)),reOpeningDate:z(new Date((I=a==null?void 0:a.data)==null?void 0:I.reOpeningDate)),academicYear:(B=a==null?void 0:a.data)==null?void 0:B.academicYear,term:(V=a==null?void 0:a.data)==null?void 0:V.term,session:(U=a==null?void 0:a.data)==null?void 0:U.sessionId})},[a.data,o]);const{mutateAsync:_,isLoading:b}=ht({mutationFn:rr}),g=E=>{_(E,{onSettled:()=>{i.invalidateQueries(["terms"]),i.invalidateQueries(["terms/:id",e.get("_id")])},onSuccess:w=>{t(bt(w)),v()},onError:w=>{t(Vt(w))}})},v=()=>{r(E=>(E.delete("_id"),E.delete("edit_session"),E))};return x.jsxs(gt,{open:e.get("edit_session")!==null,onClose:v,fullWidth:!0,maxWidth:"sm",children:[x.jsx(mt,{title:"Edit Session",onClose:v}),a!=null&&a.isLoading?x.jsx("p",{children:"Please Wait.."}):x.jsxs("form",{onSubmit:n(g),children:[x.jsx(vt,{children:x.jsxs(Pe,{spacing:2,paddingY:2,children:[x.jsx(ot,{label:"Academic Year",name:"academicYear",control:f,InputProps:{readOnly:!0},fullWidth:!0,margin:"normal",size:"small"}),x.jsx(ue,{label:"Start of Academic Term",name:"from",control:f}),x.jsx(ue,{label:"End of Academic Term",name:"to",control:f}),x.jsx(ot,{label:"Term/Semester",size:"small",name:"term",control:f,InputProps:{readOnly:!0},fullWidth:!0,margin:"normal"}),x.jsx(Kt,{fontSize:13,children:"Vacation"}),x.jsx(ue,{label:"Vacation Date",name:"vacationDate",control:f}),x.jsx(ue,{label:"Next Term Begins",name:"reOpeningDate",control:f}),x.jsx(_t,{})]})}),x.jsx(Ft,{sx:{padding:2},children:x.jsx(xt,{type:"submit",loading:b,variant:"contained",onClick:n,children:b?"Please Wait..":"Save Changes"})})]})]})},dt=(e,r,t)=>{if(e&&"reportValidity"in e){const i=c(t,r);e.setCustomValidity(i&&i.message||""),e.reportValidity()}},Rt=(e,r)=>{for(const t in r.fields){const i=r.fields[t];i&&i.ref&&"reportValidity"in i.ref?dt(i.ref,t,e):i.refs&&i.refs.forEach(a=>dt(a,t,e))}},wr=(e,r)=>{r.shouldUseNativeValidation&&Rt(e,r);const t={};for(const i in e){const a=c(r.fields,i),n=Object.assign(e[i]||{},{ref:a&&a.ref});if(Er(r.names||Object.keys(e),i)){const o=Object.assign({},c(t,i));D(o,"root",n),D(t,i,o)}else D(t,i,n)}return t},Er=(e,r)=>e.some(t=>t.startsWith(r+"."));function kr(e,r,t){return r===void 0&&(r={}),t===void 0&&(t={}),function(i,a,n){try{return Promise.resolve(function(o,f){try{var _=(r.context,Promise.resolve(e[t.mode==="sync"?"validateSync":"validate"](i,Object.assign({abortEarly:!1},r,{context:a}))).then(function(b){return n.shouldUseNativeValidation&&Rt({},n),{values:t.raw?i:b,errors:{}}}))}catch(b){return f(b)}return _&&_.then?_.then(void 0,f):_}(0,function(o){if(!o.inner)throw o;return{values:{},errors:wr((f=o,_=!n.shouldUseNativeValidation&&n.criteriaMode==="all",(f.inner||[]).reduce(function(b,g){if(b[g.path]||(b[g.path]={message:g.message,type:g.type}),_){var v=b[g.path].types,j=v&&v[g.type];b[g.path]=jt(g.path,_,b,g.type,j?[].concat(j,g.message):g.message)}return b},{})),n)};var f,_}))}catch(o){return Promise.reject(o)}}}const Cr=je.default?je.default:je,ct=({name:e,control:r,label:t,rules:i})=>x.jsx(pe,{name:e,control:r,rules:i,render:({field:{onChange:a,value:n},fieldState:{error:o}})=>x.jsx(Cr,{label:t,value:n||null,dateFormat:"YYYY",timeFormat:!1,initialValue:z().format("YYYY"),closeOnSelect:!0,onChange:f=>{a(f.format("YYYY"))},renderInput:f=>x.jsx(Ue,{...f,error:!!o,helperText:o?o.message:null,label:t,size:"small",fullWidth:!0})})}),jr=({children:e,name:r,control:t,label:i,rules:a,defaultValue:n="",...o})=>x.jsx(pe,{name:r,control:t,rules:a,defaultValue:n,render:({field:{onChange:f,value:_,onBlur:b},fieldState:{error:g}})=>x.jsx(Ue,{select:!0,label:i,value:_,onChange:f,onBlur:b,error:!!g,helperText:g?g.message:null,...o,children:e})}),Tr=()=>{const{schoolSessionState:e,schoolSessionDispatch:r}=Ye.useContext(ft),t=yt(),i=new Date().getFullYear(),{handleSubmit:a,control:n}=Mt({resolver:kr(Zt),defaultValues:{...lr,academicYear:`${i}/${i}`,start:z().format("YYYY"),end:z().format("YYYY"),from:z(),to:z(),term:""}}),{mutateAsync:o,isLoading:f}=ht({mutationFn:sr}),_=g=>{var B,V;const{start:v,end:j,from:E,to:w,...ee}=g,I={...ee,academicYear:`${v}/${j}`,from:(B=z(new Date(E)))==null?void 0:B.format("l"),to:(V=z(new Date(w)))==null?void 0:V.format("l")};o(I,{onSettled:()=>{t.invalidateQueries(["terms"])},onSuccess:U=>{r(bt(U)),b()},onError:U=>{r(Vt(U))}})};function b(){r({type:"displayAddSession",payload:!1})}return x.jsxs(gt,{open:e.displayAddSession,fullWidth:!0,maxWidth:"sm",TransitionComponent:Gt,children:[x.jsx(mt,{title:"Add Session",onClose:b}),x.jsxs("form",{onSubmit:a(_),children:[x.jsx(vt,{children:x.jsxs(Pe,{spacing:2,paddingY:2,children:[x.jsx(Jt,{sx:{fontSize:13},children:"Academic Year"}),x.jsxs(Pe,{direction:"row",columnGap:2,children:[x.jsx(ct,{label:"From",name:"start",control:n}),x.jsx(ct,{label:"To",name:"end",control:n})]}),x.jsx(ue,{label:"Start of Academic Term/Semester",name:"from",control:n}),x.jsx(ue,{label:"End of Academic Term/Semester",name:"to",control:n}),x.jsx(jr,{label:"Term/Semester",size:"small",name:"term",control:n,fullWidth:!0,margin:"normal",children:ur.map(g=>x.jsx(Xt,{value:g,children:g},g))}),x.jsx(_t,{})]})}),x.jsx(Ft,{sx:{padding:2},children:x.jsx(xt,{type:"submit",loading:f,variant:"contained",children:f?"Saving":"Save"})})]})]})};function es(){return x.jsxs(x.Fragment,{children:[x.jsx(er,{}),x.jsx(Tr,{}),x.jsx(pr,{})]})}export{es as default};
