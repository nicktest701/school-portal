import{a4 as Pe,j as e,r as T,U as it,S as fe,g as Se,b0 as ue,bi as bt,i as we,z as Tt,l as Ie,m as P,n as R,T as g,t as rt,B as G,ak as $,F as be,bj as St,v as Y,q as I,bk as B,b3 as Ct,aM as Q,bl as ge,bm as Ce,bn as Pt,a8 as U,bo as tt,bp as wt,aF as It,aG as vt,u as st,h as ot,C as lt,X as pt,ap as zt,bq as Wt,_ as je,a as b,b9 as At,w as dt,x as mt,f as ct,br as yt,bs as Nt,bt as Dt,bu as Bt,bv as Lt,bw as Rt,bx as Ft,a9 as kt,aa as Ot,G as Et,by as Mt,a_ as _t,bz as Vt,ag as qt,aD as Gt,W as Ht,bA as Ut,ae as $t,Z as Yt,$ as Xt,a7 as Kt,bB as Qt,bC as Jt,J as Zt,M as en,N as nt,A as tn}from"./index-97ebb758.js";import{g as nn}from"./termAPI-510d896e.js";import{a as an,p as rn,b as sn}from"./studentAPI-95ea0a9f.js";import{M as X}from"./MedicalAllergy-8dac2d4f.js";import{N as on}from"./NoteRounded-632424b0.js";import{I as ln}from"./studentColumns-d0a36e3e.js";const pn=Pe(e.jsx("path",{d:"M20 21v-3h3v-2h-3v-3h-2v3h-3v2h3v3zm-4.97.5H5.66c-.72 0-1.38-.38-1.73-1l-2.36-4.1c-.36-.62-.35-1.38.01-2L7.92 3.49c.36-.61 1.02-.99 1.73-.99h4.7c.71 0 1.37.38 1.73.99l4.48 7.71c-.5-.13-1.02-.2-1.56-.2-.28 0-.56.02-.84.06L14.35 4.5h-4.7L3.31 15.41l2.35 4.09h7.89c.35.77.85 1.45 1.48 2M13.34 15c-.22.63-.34 1.3-.34 2H7.25l-.73-1.27 4.58-7.98h1.8l2.53 4.42c-.56.42-1.05.93-1.44 1.51l-2-3.49L9.25 15z"}),"AddToDrive"),ve=Pe(e.jsx("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward"),dn=Pe(e.jsx("path",{d:"M9 16.17 5.53 12.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0z"}),"CheckRounded");function mn({open:d,setOpen:l}){const{userState:{session:j}}=T.useContext(it),{schoolSessionDispatch:w}=T.useContext(fe),[t,n]=T.useState({_id:"",levelType:"",students:[]}),[i,o]=T.useState({termId:"",sessionId:"",label:""}),a=Se({queryKey:["terms"],queryFn:()=>nn(),enabled:!!(j!=null&&j.sessionId),select:r=>r.filter(({to:c})=>ue(new Date(j.to))>ue(new Date(c))).map(({termId:c,sessionId:m,academicYear:y,term:f})=>({termId:c,sessionId:m,label:`${y},${f}`}))}),p=Se({queryKey:["previous-levels",i==null?void 0:i.termId],queryFn:()=>bt(i),enabled:!!(i!=null&&i.termId),select:r=>r.map(({_id:u,level:c,students:m})=>({_id:u,levelType:`${c.name}${c.type}`,students:m}))}),s=()=>{var r;((r=t==null?void 0:t.students)==null?void 0:r.length)!==0&&w({type:"openAddStudentFileDialog",payload:{data:t==null?void 0:t.students,type:"previous"}})};return e.jsxs(we,{open:d,maxWidth:"xs",fullWidth:!0,children:[e.jsx(Tt,{children:" Students from Session"}),e.jsx(Ie,{children:e.jsxs(P,{spacing:2,paddingY:2,children:[e.jsx(R,{size:"small",options:a.data??[],noOptionsText:"No session available",disableClearable:!0,fullWidth:!0,value:i,onChange:(r,u)=>{n({_id:"",levelType:"",students:[]}),o(u)},isOptionEqualToValue:(r,u)=>r.termId===u.termId||u.termId===""||u.termId===null||u.termId===void 0,getOptionLabel:r=>r.label||"",renderInput:r=>e.jsx(g,{...r,label:"Select School Session"})}),e.jsx(R,{size:"small",options:(p==null?void 0:p.data)??[],noOptionsText:"No level available",disableClearable:!0,fullWidth:!0,value:t,onChange:(r,u)=>n(u),isOptionEqualToValue:(r,u)=>r._id===u._id||u._id===""||u._id===null||u._id===void 0,getOptionLabel:r=>r.levelType||"",renderInput:r=>e.jsx(g,{...r,label:"Select Level"})})]})}),e.jsxs(rt,{children:[e.jsx(G,{onClick:()=>l(!1),children:"Cancel"}),e.jsx(G,{variant:"contained",onClick:s,disabled:!(t!=null&&t._id),children:"Load Students"})]})]})}const xt=({setMode:d})=>{const{studentState:{newStudent:{personal:l}},studentDispatch:j}=T.useContext($),[w,t]=T.useState(""),[n,i]=T.useState(ue(l==null?void 0:l.dateofbirth)),o=Se({queryKey:["student-exist",w],queryFn:()=>an(w),enabled:!!w,refetchOnMount:!0,refetchOnWindowFocus:!0}),a=(p,s)=>{p.dateofbirth=ue(n).format("L"),j({type:"addNewStudent",payload:{personal:{...p,isCompleted:!0}}}),s.setSubmitting(!1),d("photo-info")};return e.jsx(be,{initialValues:l,onSubmit:a,enableReinitialize:!0,validationSchema:St,children:({values:p,errors:s,touched:r,setFieldValue:u,handleChange:c,handleSubmit:m,isSubmitting:y})=>e.jsxs(P,{py:2,spacing:2,children:[e.jsx(P,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(Y,{loading:y,variant:"contained",color:"primary",onClick:m,endIcon:e.jsx(ve,{}),disabled:o==null?void 0:o.isError,children:"Continue"})}),e.jsx(I,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Personal Details"}),e.jsx(g,{label:"Student ID",type:"text",sx:{maxWidth:300},size:"small",value:p.indexnumber,onChange:f=>{u("indexnumber",f.target.value),t(f.target.value)},error:o.isError||!!(r!=null&&r.indexnumber&&(s!=null&&s.indexnumber)),helperText:(o==null?void 0:o.error)||(r==null?void 0:r.indexnumber)&&(s==null?void 0:s.indexnumber)}),e.jsxs(B,{children:[e.jsx(g,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:p.firstname,onChange:c("firstname"),error:!!(r.firstname&&s.firstname),helperText:r.firstname&&s.firstname}),e.jsx(g,{label:"Surname",fullWidth:!0,size:"small",value:p.surname,onChange:c("surname"),error:!!(r.surname&&s.surname),helperText:r.surname&&s.surname}),e.jsx(g,{label:"Othername",fullWidth:!0,size:"small",value:p.othername,onChange:c("othername"),error:!!(r.othername&&s.othername),helperText:r.othername&&s.othername})]}),e.jsxs(B,{children:[e.jsx(Ct,{label:"Date of Birth",date:n,setDate:i,disableFuture:!0,error:!!(r.dateofbirth&&s.dateofbirth),helperText:r.dateofbirth&&s.dateofbirth}),e.jsxs(g,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:p.gender,onChange:c("gender"),error:!!(r.gender&&s.gender),helperText:r.gender&&s.gender,children:[e.jsx(Q,{value:"male",children:"Male"}),e.jsx(Q,{value:"female",children:"Female"})]})]}),e.jsxs(B,{children:[e.jsx(g,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:p.email,onChange:c("email"),error:!!(r.email&&s.email),helperText:r.email&&s.email}),e.jsx(g,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:p.phonenumber,onChange:c("phonenumber"),error:!!(r.phonenumber&&s.phonenumber),helperText:r.phonenumber&&s.phonenumber})]}),e.jsx(g,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,value:p.address,onChange:c("address"),error:!!(r.address&&s.address),helperText:r.address&&s.address}),e.jsxs(B,{children:[e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",options:ge,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:f=>f||"",value:p.residence,onChange:(f,z)=>u("residence",z),renderInput:f=>e.jsx(g,{...f,label:"Residence",fullWidth:!0,size:"small",error:!!(r.residence&&s.residence),helperText:r.residence&&s.residence})}),e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:Ce,noOptionsText:"No Nationality available",getOptionLabel:f=>f||"",value:p.nationality,onChange:(f,z)=>u("nationality",z),renderInput:f=>e.jsx(g,{...f,label:"Nationality",fullWidth:!0,size:"small",error:!!(r.nationality&&s.nationality),helperText:r.nationality&&s.nationality})})]})]})})};xt.propTypes={};const cn=({setMode:d})=>{const{studentState:{newStudent:{parent:l}},studentDispatch:j}=T.useContext($),w=(t,n)=>{j({type:"addNewStudent",payload:{parent:{...t,isCompleted:!0}}}),n.setSubmitting(!1),d("medical-info")};return e.jsx(be,{initialValues:l,onSubmit:w,enableReinitialize:!0,validationSchema:Pt,children:({values:t,errors:n,touched:i,setFieldValue:o,handleChange:a,handleSubmit:p,isSubmitting:s})=>{var r,u,c,m,y,f,z,M,V,_,x,h,L,F,q,W,v,k,O,E,J,Z,ee,te,ne,ae,ie,re,se,oe,le,pe,de,me,ce,ye,xe,Te,H,ze,We,Ae,Ne,De,Be,Le,Re,Fe,ke,Oe,Ee,Me,_e,Ve,qe,Ge,He,Ue,$e,Ye,Xe,Ke,Qe,Je,Ze,et;return e.jsxs(P,{py:2,spacing:1,children:[e.jsxs("div",{style:{maxHeight:350,overflowY:"auto"},children:[e.jsxs(P,{py:2,spacing:1,children:[e.jsxs(P,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:[e.jsx(I,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Parent/Guardian Information"}),e.jsx(U,{sx:{width:30,height:30,bgcolor:"primary.main"},children:"1"})]}),e.jsxs(B,{children:[e.jsx(g,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:(r=t==null?void 0:t.parent1)==null?void 0:r.firstname,onChange:a("parent1.firstname"),error:!!((u=i.parent1)!=null&&u.firstname&&((c=n.parent1)!=null&&c.firstname)),helperText:((m=i.parent1)==null?void 0:m.firstname)&&((y=n.parent1)==null?void 0:y.firstname)}),e.jsx(g,{label:"Surname",fullWidth:!0,size:"small",value:(f=t==null?void 0:t.parent1)==null?void 0:f.surname,onChange:a("parent1.surname"),error:!!((z=i.parent1)!=null&&z.surname&&((M=n.parent1)!=null&&M.surname)),helperText:((V=i.parent1)==null?void 0:V.surname)&&((_=n.parent1)==null?void 0:_.surname)})]}),e.jsxs(B,{children:[e.jsxs(g,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:(x=t==null?void 0:t.parent1)==null?void 0:x.gender,onChange:a("parent1.gender"),error:!!((h=i.parent1)!=null&&h.gender&&((L=n.parent1)!=null&&L.gender)),helperText:((F=i.parent1)==null?void 0:F.gender)&&((q=n.parent1)==null?void 0:q.gender),children:[e.jsx(Q,{value:"male",children:"Male"}),e.jsx(Q,{value:"female",children:"Female"})]}),e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",options:tt,loadingText:"Please wait....",noOptionsText:"No Relationship available",getOptionLabel:S=>S||"",value:(W=t==null?void 0:t.parent1)==null?void 0:W.relationship,onInputChange:(S,C)=>o("parent1.relationship",C),renderInput:S=>{var C,A,N,D;return e.jsx(g,{...S,label:"Relationship",fullWidth:!0,size:"small",error:!!((C=i.parent1)!=null&&C.relationship&&((A=n.parent1)!=null&&A.relationship)),helperText:((N=i.parent1)==null?void 0:N.relationship)&&((D=n.parent1)==null?void 0:D.relationship)})}})]}),e.jsxs(B,{children:[e.jsx(g,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:(v=t==null?void 0:t.parent1)==null?void 0:v.email,onChange:a("parent1.email"),error:!!((k=i.parent1)!=null&&k.email&&((O=n.parent1)!=null&&O.email)),helperText:((E=i.parent1)==null?void 0:E.email)&&((J=n.parent1)==null?void 0:J.email)}),e.jsx(g,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(Z=t==null?void 0:t.parent1)==null?void 0:Z.phonenumber,onChange:a("parent1.phonenumber"),error:!!((ee=i.parent1)!=null&&ee.phonenumber&&((te=n.parent1)!=null&&te.phonenumber)),helperText:((ne=i.parent1)==null?void 0:ne.phonenumber)&&((ae=n.parent1)==null?void 0:ae.phonenumber)})]}),e.jsx(g,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,multiline:!0,value:(ie=t==null?void 0:t.parent1)==null?void 0:ie.address,onChange:a("parent1.address"),error:!!((re=i.parent1)!=null&&re.address&&((se=n.parent1)!=null&&se.address)),helperText:((oe=i.parent1)==null?void 0:oe.address)&&((le=n.parent1)==null?void 0:le.address)}),e.jsxs(B,{children:[e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",options:ge,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:S=>S||"",value:(pe=t==null?void 0:t.parent1)==null?void 0:pe.residence,onChange:(S,C)=>o("parent1.residence",C),renderInput:S=>{var C,A,N,D;return e.jsx(g,{...S,label:"Residence",fullWidth:!0,size:"small",error:!!((C=i.parent1)!=null&&C.residence&&((A=n.parent1)!=null&&A.residence)),helperText:((N=i.parent1)==null?void 0:N.residence)&&((D=n.parent1)==null?void 0:D.residence)})}}),e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:Ce,noOptionsText:"No Nationality available",getOptionLabel:S=>S||"",value:(de=t==null?void 0:t.parent1)==null?void 0:de.nationality,onChange:(S,C)=>o("parent1.nationality",C),renderInput:S=>{var C,A,N,D;return e.jsx(g,{...S,label:"Nationality",fullWidth:!0,size:"small",error:!!((C=i.parent1)!=null&&C.nationality&&((A=n.parent1)!=null&&A.nationality)),helperText:((N=i.parent1)==null?void 0:N.nationality)&&((D=n.parent1)==null?void 0:D.nationality)})}})]})]}),e.jsxs(P,{py:2,spacing:1,children:[e.jsxs(P,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:[e.jsx(I,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Parent/Guardian Information"}),e.jsx(U,{sx:{width:30,height:30,bgcolor:"primary.main"},children:"2"})]}),e.jsxs(B,{children:[e.jsx(g,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:(me=t==null?void 0:t.parent2)==null?void 0:me.firstname,onChange:a("parent2.firstname"),error:!!((ce=i.parent2)!=null&&ce.firstname&&((ye=n.parent2)!=null&&ye.firstname)),helperText:((xe=i.parent2)==null?void 0:xe.firstname)&&((Te=n.parent2)==null?void 0:Te.firstname)}),e.jsx(g,{label:"Surname",fullWidth:!0,size:"small",value:(H=t==null?void 0:t.parent2)==null?void 0:H.surname,onChange:a("parent2.surname"),error:!!((ze=i.parent2)!=null&&ze.surname&&((We=n.parent2)!=null&&We.surname)),helperText:((Ae=i.parent2)==null?void 0:Ae.surname)&&((Ne=n.parent2)==null?void 0:Ne.surname)})]}),e.jsxs(B,{children:[e.jsxs(g,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:(De=t==null?void 0:t.parent2)==null?void 0:De.gender,onChange:a("parent2.gender"),error:!!((Be=i.parent2)!=null&&Be.gender&&((Le=n.parent2)!=null&&Le.gender)),helperText:((Re=i.parent2)==null?void 0:Re.gender)&&((Fe=n.parent2)==null?void 0:Fe.gender),children:[e.jsx(Q,{value:"male",children:"Male"}),e.jsx(Q,{value:"female",children:"Female"})]}),e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",options:tt,loadingText:"Please wait....",noOptionsText:"No Relationship available",getOptionLabel:S=>S||"",value:(ke=t==null?void 0:t.parent2)==null?void 0:ke.relationship,onInputChange:(S,C)=>o("parent2.relationship",C),renderInput:S=>{var C,A,N,D;return e.jsx(g,{...S,label:"Relationship",fullWidth:!0,size:"small",error:!!((C=i.parent2)!=null&&C.relationship&&((A=n.parent2)!=null&&A.relationship)),helperText:((N=i.parent2)==null?void 0:N.relationship)&&((D=n.parent2)==null?void 0:D.relationship)})}})]}),e.jsxs(B,{children:[e.jsx(g,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:(Oe=t==null?void 0:t.parent2)==null?void 0:Oe.email,onChange:a("parent2.email"),error:!!((Ee=i.parent2)!=null&&Ee.email&&((Me=n.parent2)!=null&&Me.email)),helperText:((_e=i.parent2)==null?void 0:_e.email)&&((Ve=n.parent2)==null?void 0:Ve.email)}),e.jsx(g,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(qe=t==null?void 0:t.parent2)==null?void 0:qe.phonenumber,onChange:a("parent2.phonenumber"),error:!!((Ge=i.parent2)!=null&&Ge.phonenumber&&((He=n.parent2)!=null&&He.phonenumber)),helperText:((Ue=i.parent2)==null?void 0:Ue.phonenumber)&&(($e=n.parent2)==null?void 0:$e.phonenumber)})]}),e.jsx(g,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,multiline:!0,value:(Ye=t==null?void 0:t.parent2)==null?void 0:Ye.address,onChange:a("parent2.address"),error:!!((Xe=i.parent2)!=null&&Xe.address&&((Ke=n.parent2)!=null&&Ke.address)),helperText:((Qe=i.parent2)==null?void 0:Qe.address)&&((Je=n.parent2)==null?void 0:Je.address)}),e.jsxs(B,{children:[e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",options:ge,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:S=>S||"",value:(Ze=t==null?void 0:t.parent2)==null?void 0:Ze.residence,onChange:(S,C)=>o("parent2.residence",C),renderInput:S=>{var C,A,N,D;return e.jsx(g,{...S,label:"Residence",fullWidth:!0,size:"small",error:!!((C=i.parent2)!=null&&C.residence&&((A=n.parent2)!=null&&A.residence)),helperText:((N=i.parent2)==null?void 0:N.residence)&&((D=n.parent2)==null?void 0:D.residence)})}}),e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:Ce,noOptionsText:"No Nationality available",getOptionLabel:S=>S||"",value:(et=t==null?void 0:t.parent2)==null?void 0:et.nationality,onChange:(S,C)=>o("parent2.nationality",C),renderInput:S=>{var C,A,N,D;return e.jsx(g,{...S,label:"Nationality",fullWidth:!0,size:"small",error:!!((C=i.parent2)!=null&&C.nationality&&((A=n.parent2)!=null&&A.nationality)),helperText:((N=i.parent2)==null?void 0:N.nationality)&&((D=n.parent2)==null?void 0:D.nationality)})}})]})]})]}),e.jsx(P,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(Y,{loading:s,variant:"contained",color:"primary",onClick:p,children:"Save & Continue"})})]})}})},ht=({setMode:d})=>{const{studentState:{newStudent:{medical:l}},studentDispatch:j}=T.useContext($),w=(t,n)=>{j({type:"addNewStudent",payload:{medical:{...t,isCompleted:!0}}}),n.setSubmitting(!1),d("academic-info")};return e.jsx(be,{initialValues:l,onSubmit:w,enableReinitialize:!0,validationSchema:wt,children:({values:t,errors:n,touched:i,handleChange:o,handleSubmit:a,isSubmitting:p})=>{var s,r,u,c,m,y,f,z,M,V,_,x,h,L,F;return e.jsxs(P,{padding:2,spacing:1,children:[e.jsx(P,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(Y,{loading:p,variant:"contained",color:"primary",onClick:a,endIcon:e.jsx(ve,{}),children:"Continue"})}),e.jsx(I,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Medical Records"}),e.jsx(I,{variant:"body2",color:"primary.main",children:"(Kindly note that this section, even though required, will not affect your child’s admission into the school)."}),e.jsxs(P,{width:{xs:"100%",md:"80%"},py:5,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(X,{title:"1. Heart Disease",value:t.heartDisease,setValue:o("heartDisease")}),e.jsx(X,{title:"2. Visual Impairment",value:t.visualImpairment,setValue:o("visualImpairment")})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(X,{title:"3. Asthma",value:t.asthma,setValue:o("asthma")}),e.jsx(X,{title:"4. Hearing Impairment",value:t.hearingImpairment,setValue:o("hearingImpairment")})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(X,{title:"5. Siezures",value:t.siezures,setValue:o("siezures")}),e.jsx(X,{title:"6. Physical Disability",value:t.physicalDisability,setValue:o("physicalDisability")})]})]}),e.jsxs(P,{py:2,spacing:1,children:[e.jsx(I,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Emergency Contact"}),e.jsxs(B,{children:[e.jsx(g,{label:"Fullname",type:"text",fullWidth:!0,size:"small",value:(s=t==null?void 0:t.emergencyContact)==null?void 0:s.fullname,onChange:o("emergencyContact.fullname"),error:!!((r=i==null?void 0:i.emergencyContact)!=null&&r.fullname&&((u=n==null?void 0:n.emergencyContact)!=null&&u.fullname)),helperText:((c=i==null?void 0:i.emergencyContact)==null?void 0:c.fullname)&&((m=n==null?void 0:n.emergencyContact)==null?void 0:m.fullname)}),e.jsx(g,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(y=t==null?void 0:t.emergencyContact)==null?void 0:y.phonenumber,onChange:o("emergencyContact.phonenumber"),error:!!((f=i==null?void 0:i.emergencyContact)!=null&&f.phonenumber&&((z=n==null?void 0:n.emergencyContact)!=null&&z.phonenumber)),helperText:((M=i==null?void 0:i.emergencyContact)==null?void 0:M.phonenumber)&&((V=n==null?void 0:n.emergencyContact)==null?void 0:V.phonenumber)})]}),e.jsx(B,{children:e.jsx(g,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,value:(_=t==null?void 0:t.emergencyContact)==null?void 0:_.address,onChange:o("emergencyContact.address"),error:!!((x=i==null?void 0:i.emergencyContact)!=null&&x.address&&((h=n==null?void 0:n.emergencyContact)!=null&&h.address)),helperText:((L=i==null?void 0:i.emergencyContact)==null?void 0:L.address)&&((F=n==null?void 0:n.emergencyContact)==null?void 0:F.address)})})]})]})}})};ht.propTypes={};function K({title:d,value:l}){return e.jsxs(P,{direction:"row",justifyContent:"space-between",alignItems:"center",spacing:3,pr:6,children:[e.jsx(I,{textAlign:"right",fontSize:11,children:d}),e.jsx(It,{sx:{fontSize:11},value:l,control:e.jsx(vt,{size:"small",checked:!0}),label:l,slotProps:{typography:{sx:{fontSize:11}}}})]})}function yn({open:d,setOpen:l,setMode:j}){var F,q,W,v,k,O,E,J,Z,ee,te,ne,ae,ie,re,se,oe,le,pe,de,me,ce,ye,xe;const w=st(),t=JSON.parse(localStorage.getItem("@school_info")),{studentState:{newStudent:{personal:n,photo:i,medical:o,parent:a,academic:p},studentDispatch:s}}=T.useContext($),{schoolSessionDispatch:r}=T.useContext(fe),u=T.useRef(),[c,m]=T.useState(""),[y,f]=T.useState(!1),{mutateAsync:z,isLoading:M}=ot({mutationFn:rn}),V=()=>{n.profile=i==null?void 0:i.profile,z({personal:n,medical:o,parent:a,academic:p},{onSettled:()=>{w.invalidateQueries(["students-by-current-level"]),w.invalidateQueries(["all-students"])},onSuccess:H=>{H&&(r(dt("New Student Added")),f(!0),m(H),localStorage.removeItem("@student"))},onError:H=>{r(mt(H))}})},_=()=>{c?(j("personal-info"),l(!1),s({type:"addNewStudent",payload:{}})):l(!1)},x={fontSize:12,color:"primary",fontWeight:"700"},h={fontSize:10},L={width:"100%",borderBottom:"1px solid black",backgroundColor:"black",color:"#fff",padding:"2px"};return e.jsxs(we,{open:d,fullWidth:!0,maxWidth:"lg",onClose:()=>l(!1),children:[e.jsx(lt,{title:"Admission Form",subtitle:"Preview of student information. Please check before saving your information.",onClose:_}),e.jsxs(pt,{display:"flex",gap:2,justifyContent:"center",alignItems:"center",pt:2,children:[e.jsx(zt,{trigger:()=>e.jsx(G,{variant:"outlined",children:"Print Form"}),content:()=>u.current,documentTitle:"Admission"}),e.jsx(Y,{loading:M,variant:"contained",color:"primary",onClick:V,children:"Save Student Data"})]}),e.jsx(Ie,{children:e.jsxs("div",{ref:u,children:[e.jsxs(P,{justifyContent:"center",alignItems:"center",sx:{maxWidth:"8.5in",minHeight:"11in",margin:"auto",padding:"16px",border:"1px solid lightgray",position:"relative",backgroundSize:"contain",backgroundPosition:"center center !important"},children:[e.jsx(I,{variant:"body1",sx:{justifySelf:"start",py:4},children:"Admission Form"}),t!=null&&t.badge?e.jsx(U,{alt:"school logo",loading:"lazy",srcSet:`/images/users/${t==null?void 0:t.badge}`,sx:{width:100,height:100}}):e.jsx(Wt,{sx:{width:100,height:100}}),e.jsxs(P,{justifyContent:"center",alignItems:"center",width:"100%",children:[e.jsx(I,{variant:"h4",children:je.startCase(t==null?void 0:t.name)}),e.jsx(I,{variant:"caption",children:t==null?void 0:t.address}),e.jsx(I,{variant:"caption",children:t==null?void 0:t.location}),e.jsx(I,{variant:"caption",fontStyle:"italic",children:t==null?void 0:t.motto})]}),e.jsx(I,{variant:"h3",textTransform:"uppercase",my:2,children:`${n==null?void 0:n.surname} ${n==null?void 0:n.firstname} ${n==null?void 0:n.othername}`})]}),e.jsxs(P,{className:"admission-form",spacing:1,sx:{maxWidth:"8.5in",minHeight:"11in",margin:"auto",padding:"16px",border:"1px solid lightgray",position:"relative",backgroundSize:"contain",backgroundPosition:"center center !important"},children:[c&&e.jsx("small",{style:{position:"absolute",bottom:"0",right:0,paddingRight:"8px",paddingBottom:"8px"},children:c}),e.jsx("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:e.jsx(U,{variant:"square",src:i==null?void 0:i.profile,sx:{alignSelf:"center",width:80,height:80}})}),e.jsxs("div",{style:{paddingBottom:"8px"},children:[e.jsx("legend",{style:L,children:"Personal Data"}),e.jsx(b,{secondary:"Student ID",primary:n==null?void 0:n.indexnumber,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(b,{secondary:"Full Name",primary:`${n==null?void 0:n.surname} ${n==null?void 0:n.firstname} ${n==null?void 0:n.othername}`,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Date of Birth",primary:ue(new Date(n==null?void 0:n.dateofbirth)).format("LL"),primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Gender",primary:n==null?void 0:n.gender,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Email Address",primary:n==null?void 0:n.email,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Phone Number",primary:n==null?void 0:n.phonenumber,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Residence",primary:n==null?void 0:n.residence,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Nationality",primary:n==null?void 0:n.nationality,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Address",primary:n==null?void 0:n.address,primaryTypographyProps:x,secondaryTypographyProps:h})]})]}),e.jsxs("div",{style:{paddingBottom:"8px"},children:[e.jsx("legend",{style:L,children:"Parent/Guardian Information"}),e.jsxs(P,{children:[e.jsx(I,{color:"primary.main",sx:{fontWeight:"bold",fontSize:11},children:"Parent 1 / Guardian 1"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(b,{secondary:"Surname",primary:(F=a==null?void 0:a.parent1)==null?void 0:F.surname,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"First Name",primary:(q=a==null?void 0:a.parent1)==null?void 0:q.firstname,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Relationship",primary:(W=a==null?void 0:a.parent1)==null?void 0:W.relationship,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Gender",primary:(v=a==null?void 0:a.parent1)==null?void 0:v.gender,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Email Address",primary:(k=a==null?void 0:a.parent1)==null?void 0:k.email,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Phone Number",primary:(O=a==null?void 0:a.parent1)==null?void 0:O.phonenumber,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Residence",primary:(E=a==null?void 0:a.parent1)==null?void 0:E.residence,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Nationality",primary:(J=a==null?void 0:a.parent1)==null?void 0:J.nationality,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Address",primary:(Z=a==null?void 0:a.parent1)==null?void 0:Z.address,primaryTypographyProps:x,secondaryTypographyProps:h})]})]}),e.jsxs(P,{children:[e.jsx(I,{color:"primary.main",sx:{fontWeight:"bold",fontSize:11},children:"Parent 2 / Guardian 2"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(b,{secondary:"Surname",primary:(ee=a==null?void 0:a.parent2)==null?void 0:ee.surname,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"First Name",primary:(te=a==null?void 0:a.parent2)==null?void 0:te.firstname,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Relationship",primary:(ne=a==null?void 0:a.parent2)==null?void 0:ne.relationship,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Gender",primary:(ae=a==null?void 0:a.parent2)==null?void 0:ae.gender,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Email Address",primary:(ie=a==null?void 0:a.parent2)==null?void 0:ie.email,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Phone Number",primary:(re=a==null?void 0:a.parent2)==null?void 0:re.phonenumber,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Residence",primary:(se=a==null?void 0:a.parent2)==null?void 0:se.residence,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Nationality",primary:(oe=a==null?void 0:a.parent2)==null?void 0:oe.nationality,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Address",primary:(le=a==null?void 0:a.parent2)==null?void 0:le.address,primaryTypographyProps:x,secondaryTypographyProps:h})]})]})]}),e.jsxs("div",{style:{paddingBottom:"8px"},children:[e.jsx("legend",{style:L,children:"Medical Records"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(K,{title:"1. Heart Disease",value:o.heartDisease}),e.jsx(K,{title:"2. Asthma",value:o.asthma}),e.jsx(K,{title:"3. Siezures",value:o.siezures}),e.jsx(K,{title:"4. Visual Impairment",value:o.visualImpairment}),e.jsx(K,{title:"5. Hearing Impairment",value:o.hearingImpairment}),e.jsx(K,{title:"6. Physical Disability",value:o.physicalDisability})]}),e.jsx(I,{color:"primary.main",sx:{fontWeight:"bold",fontSize:11},children:"Emergency Contact"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(b,{secondary:"Fullname",primary:(pe=o==null?void 0:o.emergencyContact)==null?void 0:pe.fullname,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Phone Number",primary:(de=o==null?void 0:o.emergencyContact)==null?void 0:de.phonenumber,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Address",primary:(me=o==null?void 0:o.emergencyContact)==null?void 0:me.address,primaryTypographyProps:x,secondaryTypographyProps:h})]})]}),e.jsxs("div",{style:{paddingBottom:"8px"},children:[e.jsx("legend",{style:L,children:"Academic Records"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(b,{secondary:"Current Level",primary:(ce=p==null?void 0:p.level)==null?void 0:ce.type,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Previous School Name",primary:(ye=p==null?void 0:p.previousSchool)==null?void 0:ye.name,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Location",primary:(xe=p==null?void 0:p.previousSchool)==null?void 0:xe.location,primaryTypographyProps:x,secondaryTypographyProps:h})]})]})]})]})}),M&&e.jsx(At,{})]})}const ut=({setMode:d})=>{var u;const{studentState:{newStudent:{academic:l}},studentDispatch:j}=T.useContext($),[w,t]=T.useState(!1),[n,i]=T.useState((u=l==null?void 0:l.previousSchool)==null?void 0:u.report),{levelsOption:o}=ct(),{getRootProps:a,getInputProps:p,open:s}=yt({noClick:!0,noKeyboard:!0,maxFiles:1,accept:{"image/*":[".jpeg",".png",".webp"],"application/pdf":[".pdf"]},multiple:!1,onDrop:c=>{if(!je.isEmpty(c)){const m=new FileReader;m.onload=function(y){const f=y.target.result;i(f)},m.readAsDataURL(c[0])}}}),r=(c,m)=>{c.previousSchool.report=n,j({type:"addNewStudent",payload:{academic:{...c,isCompleted:!0}}}),m.setSubmitting(!1),t(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(be,{initialValues:l,onSubmit:r,enableReinitialize:!0,validationSchema:Nt,children:({values:c,errors:m,touched:y,setFieldValue:f,handleChange:z,handleSubmit:M,isSubmitting:V})=>{var _,x,h,L,F,q;return e.jsxs(P,{py:2,spacing:1,children:[e.jsx(P,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(Y,{loading:V,variant:"contained",color:"primary",onClick:M,endIcon:e.jsx(ve,{}),children:"Continue"})}),e.jsx(I,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Academic Records"}),e.jsx(B,{children:e.jsx(R,{fullWidth:!0,size:"small",options:o,noOptionsText:"No Level available",getOptionLabel:W=>W.type||"",isOptionEqualToValue:(W,v)=>v._id===void 0||v._id===""||v._id===W._id,value:c.level,onChange:(W,v)=>f("level",v),renderInput:W=>{var v,k,O,E;return e.jsx(g,{...W,label:"Current Level",fullWidth:!0,size:"small",error:!!((v=y==null?void 0:y.level)!=null&&v.type&&((k=m==null?void 0:m.level)!=null&&k.type)),helperText:((O=y==null?void 0:y.level)==null?void 0:O.type)&&((E=m==null?void 0:m.level)==null?void 0:E.type)})}})}),e.jsx(I,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Previous School Records"}),e.jsxs(B,{children:[e.jsx(g,{label:"School Name",type:"text",fullWidth:!0,size:"small",value:(_=c==null?void 0:c.previousSchool)==null?void 0:_.name,onChange:z("previousSchool.name"),error:!!((x=y==null?void 0:y.previousSchool)!=null&&x.name&&((h=m==null?void 0:m.previousSchool)!=null&&h.name)),helperText:((L=y==null?void 0:y.previousSchool)==null?void 0:L.name)&&((F=m==null?void 0:m.previousSchool)==null?void 0:F.name)}),e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",options:ge,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:W=>W||"",value:(q=c==null?void 0:c.previousSchool)==null?void 0:q.location,onInputChange:(W,v)=>f("previousSchool.location",v),renderInput:W=>{var v,k,O,E;return e.jsx(g,{...W,label:"Location",fullWidth:!0,size:"small",error:!!((v=y==null?void 0:y.previousSchool)!=null&&v.location&&((k=m==null?void 0:m.previousSchool)!=null&&k.location)),helperText:((O=y==null?void 0:y.previousSchool)==null?void 0:O.location)&&((E=m==null?void 0:m.previousSchool)==null?void 0:E.location)})}})]}),e.jsx(I,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"A copy of the most recent school report"}),e.jsx(P,{padding:2,spacing:1,...a({className:"dropzone"}),style:{border:"1px dashed black"},children:e.jsxs(P,{spacing:2,justifyContent:"center",alignItems:"center",paddingY:1,children:[e.jsx(U,{variant:"square",src:n,sx:{width:120,height:120},children:e.jsx(Dt,{})}),e.jsxs(P,{children:[e.jsx("input",{...p()}),e.jsx(I,{textAlign:"center",paragraph:!0,children:"Drag & drop your report here"}),e.jsx(G,{variant:"outlined",onClick:s,startIcon:e.jsx(pn,{}),children:"Upload Report"})]}),!je.isEmpty(n)&&e.jsx("iframe",{style:{width:"100%",height:"5in"},src:n})]})})]})}}),e.jsx(yn,{open:w,setOpen:t,setMode:d})]})};ut.propTypes={};const gt=({setMode:d})=>{const{studentState:{newStudent:{photo:l}},studentDispatch:j}=T.useContext($),[w,t]=T.useState(l==null?void 0:l.profile),{getRootProps:n,getInputProps:i,open:o}=yt({noClick:!0,noKeyboard:!0,maxFiles:1,accept:{"image/*":[".jpeg",".png"]},maxSize:2e5,multiple:!1,onDrop:p=>{if(!je.isEmpty(p)){const s=new FileReader;s.onload=function(r){const u=r.target.result;t(u)},s.readAsDataURL(p[0])}}});T.useEffect(()=>{var s;const p=JSON.parse(localStorage.getItem("@student"));if(p){t((s=p==null?void 0:p.photo)==null?void 0:s.profile);return}},[]);const a=()=>{j({type:"addNewStudent",payload:{photo:{profile:w,isCompleted:!0}}}),d("parent-info")};return e.jsxs(P,{padding:2,spacing:1,...n({className:"dropzone"}),style:{border:"1px dashed black"},children:[e.jsx(P,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(Y,{variant:"contained",onClick:a,endIcon:e.jsx(Bt,{}),children:"Continue"})}),e.jsx(I,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Upload Photo"}),e.jsxs(P,{spacing:2,justifyContent:"center",alignItems:"center",paddingY:1,children:[e.jsx(U,{variant:"square",src:w,sx:{width:120,height:120}}),e.jsxs(P,{children:[e.jsx("input",{...i()}),e.jsx(I,{textAlign:"center",paragraph:!0,children:"Drag & drop your photo here"}),e.jsx(G,{variant:"outlined",onClick:o,startIcon:e.jsx(Lt,{}),children:"Upload Image"})]})]})]})};gt.propTypes={};function he({initValue:d,title:l,isCompleted:j,showProgress:w}){return e.jsxs(e.Fragment,{children:[e.jsxs(P,{justifyContent:"center",alignItems:"çenter",children:[e.jsx(U,{sx:{alignSelf:"center",mb:1,bgcolor:j?"success.main":null},children:j?e.jsx(dn,{}):d}),e.jsx(I,{variant:"caption",textAlign:"center",children:l})]}),w&&e.jsx(Rt,{variant:"determinate",sx:{width:80,borderRadius:1,bgcolor:j?"success.main":null},color:j?"success":"primary",value:j?100:0})]})}const xn=()=>{var l,j,w,t,n;const{studentState:{newStudent:d}}=T.useContext($);return e.jsxs(Ft,{sx:{width:"100%",display:"flex",justifyContent:"center",py:2},children:[e.jsx(he,{initValue:1,title:"Personal Details",showProgress:!0,isCompleted:(l=d==null?void 0:d.personal)==null?void 0:l.isCompleted}),e.jsx(he,{initValue:2,title:"Upload Photo",showProgress:!0,isCompleted:(j=d==null?void 0:d.photo)==null?void 0:j.isCompleted}),e.jsx(he,{initValue:3,title:"Guardian Information",showProgress:!0,isCompleted:(w=d==null?void 0:d.parent)==null?void 0:w.isCompleted}),e.jsx(he,{initValue:4,title:"Medical Records",showProgress:!0,isCompleted:(t=d==null?void 0:d.medical)==null?void 0:t.isCompleted}),e.jsx(he,{initValue:5,title:"Academic Records",showProgress:!1,isCompleted:(n=d==null?void 0:d.academic)==null?void 0:n.isCompleted})]})},at="text/csv",hn="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",un="application/vnd.ms-excel",jt=()=>{const{schoolSessionDispatch:d}=T.useContext(fe),[l,j]=T.useState("personal-info"),[w,t]=T.useState(!1),n=kt(),i=Ot(n.breakpoints.up("md")),o="Are you sure you want to leave this page? Your changes may not be saved.";T.useEffect(()=>{const s=r=>{r.preventDefault(),r.returnValue=o};return window.addEventListener("beforeunload",s),()=>{window.removeEventListener("beforeunload",s)}},[]);function a(s){const r=s.target.files[0];try{const u=new FileReader;r.type===at?u.readAsBinaryString(r):u.readAsArrayBuffer(r),u.onload=function(c){let m=[];(r.type===hn||r.type===un)&&(m=Yt(c.target.result)),r.type===at&&(m=Xt(c.target.result)),m.length!==0&&d({type:"openAddStudentFileDialog",payload:{data:m,type:"file"}})}}catch{}}const p=()=>{let s=l;switch(l){case"photo-info":s="personal-info";break;case"parent-info":s="photo-info";break;case"medical-info":s="parent-info";break;case"academic-info":s="medical-info";break;default:s="photo-info"}return s};return e.jsxs(e.Fragment,{children:[e.jsxs(e.Fragment,{children:[e.jsx(Et,{title:"New Student",subtitle:"  Track,manage and control academic and class activities",icon:e.jsx(Mt,{sx:{width:30,height:30}}),color:"primary.main"}),i&&e.jsx(xn,{}),e.jsxs(pt,{children:[l!=="personal-info"&&e.jsx(_t,{onClick:()=>j(p()),children:e.jsx(Vt,{})}),e.jsxs(qt,{variant:"contained",size:"small",sx:{display:"flex",justifyContent:"flex-end",py:2},children:[e.jsx(G,{sx:{bgcolor:"var(--secondary)"},children:e.jsxs(Gt,{htmlFor:"studentFile",title:"Import students",sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:1,color:"primary.main",fontSize:11,cursor:"pointer"},children:[e.jsx(on,{htmlColor:"#fff"}),e.jsx(I,{variant:"caption",color:"#fff",children:"From file"}),e.jsx(Ht,{type:"file",id:"studentFile",name:"studentFile",hidden:!0,inputProps:{accept:".xlsx,.xls,.csv"},onChange:a,onClick:s=>{s.target.value=null,s.currentTarget.value=null}})]})}),e.jsx(G,{startIcon:e.jsx(Ut,{}),onClick:()=>t(!0),children:"From Previous Sessions"})]})]}),e.jsxs($t,{sx:{py:4,mb:4,border:"1px solid lightgray",bgcolor:"#fff"},children:[l==="personal-info"&&e.jsx(xt,{mode:l,setMode:j}),l==="photo-info"&&e.jsx(gt,{mode:l,setMode:j}),l==="parent-info"&&e.jsx(cn,{mode:l,setMode:j}),l==="medical-info"&&e.jsx(ht,{mode:l,setMode:j}),l==="academic-info"&&e.jsx(ut,{setMode:j})]})]}),e.jsx(mn,{open:w,setOpen:t})]})};jt.propTypes={};const ft=({children:d})=>e.jsx(Qt,{mode:"wait",children:e.jsx(Jt.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.2},children:d})});ft.propTypes={children:Kt.node};function gn(){var m;const{userState:{session:d}}=T.useContext(it),l=st(),[j,w]=T.useState(""),[t,n]=T.useState({_id:"",type:""}),{schoolSessionState:i,schoolSessionDispatch:o}=T.useContext(fe),a=i.addStudentFileData,{levelsOption:p}=ct(),s=()=>{nt.fire({title:"Exiting",text:"Do you want to exit?",showCancelButton:!0}).then(({isConfirmed:y})=>{y&&o({type:"closeAddStudentFileDialog"})})},{mutateAsync:r,isLoading:u}=ot({mutationFn:sn}),c=()=>{if(w(""),t._id===""){w("Please select a level!");return}const y={students:a==null?void 0:a.data,session:{sessionId:d.sessionId,termId:d.termId,levelId:t._id},type:a.type};nt.fire({title:"Importing students",text:`Do you want to import students in ${t.type}?`,showCancelButton:!0}).then(({isConfirmed:f})=>{f&&r(y,{onSettled:()=>{l.invalidateQueries(["all-students"])},onSuccess:z=>{o(dt(z)),o({type:"closeAddStudentFileDialog"})},onError:z=>{o(mt(z))}})})};return e.jsxs(we,{open:a.open,fullScreen:!0,fullWidth:!0,children:[e.jsx(lt,{title:"Students",subtitle:"import students from file or previous academic year",onClose:s}),e.jsxs(rt,{sx:{paddingX:3},children:[e.jsx(G,{onClick:s,children:"Cancel"}),e.jsx(Y,{variant:"contained",loading:u,onClick:c,children:"Import Students"})]}),e.jsx(R,{size:"small",options:p,noOptionsText:"No Level available",getOptionLabel:y=>y.type||"",isOptionEqualToValue:(y,f)=>f._id===void 0||f._id===""||f._id===y._id,value:t,onChange:(y,f)=>n(f),renderInput:y=>e.jsx(g,{...y,label:"Select Level",size:"small",error:!!j,helperText:j,required:!0,FormHelperTextProps:{sx:{color:"error.main"}}}),sx:{width:250,marginLeft:3}}),e.jsx(Ie,{children:((m=a.data)==null?void 0:m.length)===0?e.jsx(I,{children:"No data available"}):e.jsx(Zt,{title:(t==null?void 0:t.type)||"Students",icon:en.student,columns:ln,data:a==null?void 0:a.data,options:{pageSize:10,pageSizeOptions:[10,20,30,50]},actions:[]})})]})}const jn=()=>{const[d,l]=T.useState({severity:"",text:""});return e.jsxs(e.Fragment,{children:[d.text&&e.jsx(tn,{severity:d.severity,onClose:()=>l({text:""}),children:d.text}),e.jsx(e.Fragment,{children:e.jsx(ft,{children:e.jsx(jt,{msg:d,setMsg:l})})}),e.jsx(gn,{})]})};jn.propTypes={};export{jn as default};
