import{c as k,j as e,D as je,e as fe,P as W,g as ee,r as C,aB as te,f as L,i as ae,k as H,l as q,m as G,n as ye,fj as Nn,S as h,Z as R,b as p,q as ge,s as re,t as le,G as ne,f2 as Bn,T as z,A as pe,U as be,v as Z,J as X,B as A,a1 as Cn,f3 as Dn,C as oe,h as Mn,x as En,L as Ln,af as On,ag as kn,p as Fn,a0 as Vn}from"./index-bb65b4bf.js";import Hn from"./StudentEdit-d6679c2d.js";import{P as b,M as Sn}from"./ProfileItem-6597fa1d.js";import{u as qn,d as Gn,e as Yn}from"./studentAPI-ce3a75c6.js";import{C as me}from"./Chip-fa36c3a1.js";import{T as xe,N as de}from"./nationality-728e96f8.js";import{h as he}from"./sessionColumns-3b88387c.js";import{A as B,L as $n}from"./Autocomplete-95da27f3.js";import{M as V}from"./MenuItem-1edcf8db.js";import{E as vn}from"./Edit-11e1ba9f.js";import{M as F}from"./MedicalAllergy-d5168043.js";import{P as Qn}from"./Person-07ef2507.js";import{P as Tn}from"./PersonRounded-3189a4ee.js";import{S as Kn}from"./StudentFeeReportListItem-bd7df2b4.js";import{v as Un}from"./v4-4a60fe23.js";import{L as _n}from"./ListItemButton-bf3e0355.js";import{L as Jn}from"./ListItemText-33ae0292.js";import{R as Zn}from"./index-19e2cbed.js";import{g as Xn,h as ei}from"./ExaminationAPI-b9866df6.js";import{E as ni}from"./ReportItemUnderline-31b969e7.js";import{R as ii}from"./Report-659f17c8.js";import{B as ti}from"./Back-0ebcc4f3.js";import{f as ai}from"./currentFeeAPI-3305f0eb.js";import{T as ri,a as li,b as se,c as ce}from"./TabPanel-175e39ff.js";import{R as oi}from"./ReportRounded-4bcc46cf.js";import{N as si}from"./NoteRounded-84c59859.js";import"./CustomDatePicker-05a8aa06.js";import"./useMediaQuery-5f0ec7e9.js";import"./InputAdornment-321f8206.js";import"./ListItem-befde9c4.js";import"./listItemButtonClasses-9702db06.js";import"./ListItemSecondaryAction-c66bb893.js";import"./listItemTextClasses-35ff90f6.js";import"./currencyFormatter-1910a788.js";import"./CircleRounded-3db5a545.js";import"./Delete-97505065.js";import"./ArrowBackRounded-54858719.js";const ci=k(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 3c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6m7 13H5v-.23c0-.62.28-1.2.76-1.58C7.47 15.82 9.64 15 12 15s4.53.82 6.24 2.19c.48.38.76.97.76 1.58z"}),"AccountBoxRounded"),pi=k(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zm3.17-6.41a.9959.9959 0 0 1 0-1.41c.39-.39 1.02-.39 1.41 0L12 12.59l1.41-1.41c.39-.39 1.02-.39 1.41 0s.39 1.02 0 1.41L13.41 14l1.41 1.41c.39.39.39 1.02 0 1.41s-1.02.39-1.41 0L12 15.41l-1.41 1.41c-.39.39-1.02.39-1.41 0a.9959.9959 0 0 1 0-1.41L10.59 14zM18 4h-2.5l-.71-.71c-.18-.18-.44-.29-.7-.29H9.91c-.26 0-.52.11-.7.29L8.5 4H6c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1"}),"DeleteForeverRounded"),un=k(e.jsx("path",{d:"M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1c-.1.1-.15.22-.15.36M20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"EditRounded"),mi=k(e.jsx("path",{d:"M20 7h-5V4c0-1.1-.9-2-2-2h-2c-1.1 0-2 .9-2 2v3H4c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2m-9-3h2v5h-2zM7 16H6c-.55 0-1-.45-1-1s.45-1 1-1h1v-1c0-.55.45-1 1-1s1 .45 1 1v1h1c.55 0 1 .45 1 1s-.45 1-1 1H9v1c0 .55-.45 1-1 1s-1-.45-1-1zm6.75-1.5c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h4.5c.41 0 .75.34.75.75s-.34.75-.75.75zm0 3c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h2.5c.41 0 .75.34.75.75s-.34.75-.75.75z"}),"MedicalInformationRounded"),xi=k(e.jsx("path",{d:"m19.23 15.26-2.54-.29c-.61-.07-1.21.14-1.64.57l-1.84 1.84c-2.83-1.44-5.15-3.75-6.59-6.59l1.85-1.85c.43-.43.64-1.03.57-1.64l-.29-2.52c-.12-1.01-.97-1.77-1.99-1.77H5.03c-1.13 0-2.07.94-2 2.07.53 8.54 7.36 15.36 15.89 15.89 1.13.07 2.07-.87 2.07-2v-1.73c.01-1.01-.75-1.86-1.76-1.98"}),"PhoneRounded"),di=k(e.jsx("path",{d:"M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27zM12 17.3c-.72 0-1.3-.58-1.3-1.3 0-.72.58-1.3 1.3-1.3.72 0 1.3.58 1.3 1.3 0 .72-.58 1.3-1.3 1.3m1-4.3h-2V7h2z"}),"Report"),hi=k(e.jsx("path",{d:"M21 12.4V7l-4-4H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h7.4zM15 15c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3M6 6h9v4H6zm13.99 10.25 1.77 1.77L16.77 23H15v-1.77zm3.26.26-.85.85-1.77-1.77.85-.85c.2-.2.51-.2.71 0l1.06 1.06c.2.2.2.52 0 .71"}),"SaveAs"),ie=({divider:t,label:o,icon:s})=>t?e.jsx(je,{textAlign:"left",children:e.jsx(me,{label:o,size:"small",color:"primary",icon:s||null,sx:{bgcolor:"info.lighter",color:"info.darker"}})}):e.jsx(me,{label:o,size:"small",color:"primary",icon:s||null}),ji=async t=>{try{return(await fe({method:"GET",url:"/parents/student",params:{id:t}})).data}catch(o){return o.response.data}},fi=async t=>{try{return(await fe({method:"POST",url:"/parents",data:t})).data}catch(o){return o.response.data}},yi=async t=>{try{return(await fe({method:"PUT",url:"/parents",data:t})).data}catch(o){return o.response.data}},ue=()=>{var I;const t=ee(),{studentState:o,studentDispatch:s}=C.useContext(te),{schoolSessionDispatch:d}=C.useContext(L),{mutateAsync:c}=ae({mutationFn:yi}),u=(l,r)=>{c(l,{onSettled:()=>{t.invalidateQueries(["parent"]),r.setSubmitting(!1)},onSuccess:n=>{d(re(n)),y()},onError:n=>{d(le(n))}})},y=()=>{s({type:"editParent",payload:{open:!1,data:{}}})};return e.jsx(e.Fragment,{children:e.jsxs(H,{maxWidth:"md",fullWidth:!0,open:o==null?void 0:o.editParentData.open,onClose:y,children:[e.jsx(q,{title:"Edit Parent/Guardian Information",onClose:y}),e.jsx(G,{children:e.jsx(ye,{initialValues:(I=o==null?void 0:o.editParentData)==null?void 0:I.data,onSubmit:u,enableReinitialize:!0,validationSchema:Nn,children:({values:l,errors:r,touched:n,setFieldValue:a,handleChange:i,handleSubmit:j,isSubmitting:g})=>e.jsxs(h,{padding:2,spacing:1,children:[e.jsxs(R,{children:[e.jsx(p,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:l.firstname||"",onChange:i("firstname"),error:!!(n.firstname&&r.firstname),helperText:n.firstname&&r.firstname}),e.jsx(p,{label:"Surname",fullWidth:!0,size:"small",value:l.surname||"",onChange:i("surname"),error:!!(n.surname&&r.surname),helperText:n.surname&&r.surname})]}),e.jsxs(R,{children:[e.jsx(B,{freeSolo:!0,fullWidth:!0,size:"small",options:he,loadingText:"Please wait....",noOptionsText:"No Relationship available",getOptionLabel:f=>f||"",value:l==null?void 0:l.relationship,onInputChange:(f,P)=>a("relationship",P),renderInput:f=>e.jsx(p,{...f,label:"Relationship",fullWidth:!0,size:"small",error:!!(n!=null&&n.relationship&&(r!=null&&r.relationship)),helperText:(n==null?void 0:n.relationship)&&(r==null?void 0:r.relationship)})}),e.jsxs(p,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:l.gender||"",onChange:i("gender"),error:!!(n.gender&&r.gender),helperText:n.gender&&r.gender,children:[e.jsx(V,{value:"male",children:"Male"}),e.jsx(V,{value:"female",children:"Female"})]})]}),e.jsxs(R,{children:[e.jsx(p,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:l.email||"",onChange:i("email"),error:!!(n.email&&r.email),helperText:n.email&&r.email}),e.jsx(p,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:l.phonenumber||"",onChange:i("phonenumber"),error:!!(n.phonenumber&&r.phonenumber),helperText:n.phonenumber&&r.phonenumber})]}),e.jsx(p,{label:"Residence Address",fullWidth:!0,size:"small",row:3,maxRows:3,value:l.address||"",onChange:i("address"),error:!!(n.address&&r.address),helperText:n.address&&r.address}),e.jsxs(R,{children:[e.jsx(B,{freeSolo:!0,fullWidth:!0,size:"small",options:xe,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:f=>f,value:l.residence||"",onChange:(f,P)=>a("residence",P),renderInput:f=>e.jsx(p,{...f,label:"Residence",fullWidth:!0,size:"small",error:!!(n.residence&&r.residence),helperText:n.residence&&r.residence})}),e.jsx(B,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:de,noOptionsText:"No Nationality available",getOptionLabel:f=>f||"",value:l.nationality||"",onChange:(f,P)=>a("nationality",P),renderInput:f=>e.jsx(p,{...f,label:"Nationality",fullWidth:!0,size:"small",error:!!(n.nationality&&r.nationality),helperText:n.nationality&&r.nationality})})]}),e.jsx(h,{direction:"row",justifyContent:"flex-end",spacing:2,paddingY:4,children:e.jsx(ge,{loading:g,variant:"contained",color:"primary",sx:{minWidth:{xs:100,sm:150}},onClick:j,children:"Save Changes"})})]})})})]})})};ue.propTypes={open:W.string,setOpen:W.func};const gi=({open:t,setOpen:o})=>{const{studentState:{newStudent:{parent:s}}}=C.useContext(te),{schoolSessionDispatch:d}=C.useContext(L),c=ee(),{studentId:u}=ne(),{isLoading:y,mutateAsync:I}=ae({mutationFn:fi}),l=(n,a)=>{n.parent1.student=u,n.parent2.student=u,I(n,{onSettled:()=>{c.invalidateQueries(["parent"]),a.setSubmitting(!1)},onSuccess:i=>{d(re(i)),r()},onError:i=>{d(le(i))}})},r=()=>o(!1);return e.jsxs(H,{maxWidth:"md",fullWidth:!0,open:t,onClose:r,children:[e.jsx(q,{title:"New Parent/Guardian Information",onClose:r}),e.jsx(G,{children:e.jsx(ye,{initialValues:s,onSubmit:l,enableReinitialize:!0,validationSchema:Bn,children:({values:n,errors:a,touched:i,setFieldValue:j,handleChange:g,handleSubmit:f})=>{var P,D,M,E,O,N,Y,$,v,Q,K,U,_,J,Ce,Se,Te,we,Pe,Re,Ie,ze,We,Ae,Ne,Be,De,Me,Ee,Le,Oe,ke,Fe,Ve,He,qe,Ge,Ye,$e,ve,Qe,Ke,Ue,_e,Je,Ze,Xe,en,nn,tn,an,rn,ln,on,sn,cn,pn,mn,xn,dn,hn,jn,fn,yn,gn,bn;return e.jsxs(h,{py:2,spacing:1,children:[e.jsxs("div",{style:{maxHeight:350,overflowY:"auto"},children:[e.jsxs(h,{py:2,spacing:1,children:[e.jsxs(h,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:[e.jsx(z,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Parent/Guardian Information"}),e.jsx(pe,{sx:{width:30,height:30,bgcolor:"primary.main"},children:"1"})]}),e.jsxs(R,{children:[e.jsx(p,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:(P=n==null?void 0:n.parent1)==null?void 0:P.firstname,onChange:g("parent1.firstname"),error:!!((D=i.parent1)!=null&&D.firstname&&((M=a.parent1)!=null&&M.firstname)),helperText:((E=i.parent1)==null?void 0:E.firstname)&&((O=a.parent1)==null?void 0:O.firstname)}),e.jsx(p,{label:"Surname",fullWidth:!0,size:"small",value:(N=n==null?void 0:n.parent1)==null?void 0:N.surname,onChange:g("parent1.surname"),error:!!((Y=i.parent1)!=null&&Y.surname&&(($=a.parent1)!=null&&$.surname)),helperText:((v=i.parent1)==null?void 0:v.surname)&&((Q=a.parent1)==null?void 0:Q.surname)})]}),e.jsxs(R,{children:[e.jsxs(p,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:(K=n==null?void 0:n.parent1)==null?void 0:K.gender,onChange:g("parent1.gender"),error:!!((U=i.parent1)!=null&&U.gender&&((_=a.parent1)!=null&&_.gender)),helperText:((J=i.parent1)==null?void 0:J.gender)&&((Ce=a.parent1)==null?void 0:Ce.gender),children:[e.jsx(V,{value:"male",children:"Male"}),e.jsx(V,{value:"female",children:"Female"})]}),e.jsx(B,{freeSolo:!0,fullWidth:!0,size:"small",options:he,loadingText:"Please wait....",noOptionsText:"No Relationship available",getOptionLabel:m=>m||"",value:(Se=n==null?void 0:n.parent1)==null?void 0:Se.relationship,onInputChange:(m,x)=>j("parent1.relationship",x),renderInput:m=>{var x,S,T,w;return e.jsx(p,{...m,label:"Relationship",fullWidth:!0,size:"small",error:!!((x=i.parent1)!=null&&x.relationship&&((S=a.parent1)!=null&&S.relationship)),helperText:((T=i.parent1)==null?void 0:T.relationship)&&((w=a.parent1)==null?void 0:w.relationship)})}})]}),e.jsxs(R,{children:[e.jsx(p,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:(Te=n==null?void 0:n.parent1)==null?void 0:Te.email,onChange:g("parent1.email"),error:!!((we=i.parent1)!=null&&we.email&&((Pe=a.parent1)!=null&&Pe.email)),helperText:((Re=i.parent1)==null?void 0:Re.email)&&((Ie=a.parent1)==null?void 0:Ie.email)}),e.jsx(p,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(ze=n==null?void 0:n.parent1)==null?void 0:ze.phonenumber,onChange:g("parent1.phonenumber"),error:!!((We=i.parent1)!=null&&We.phonenumber&&((Ae=a.parent1)!=null&&Ae.phonenumber)),helperText:((Ne=i.parent1)==null?void 0:Ne.phonenumber)&&((Be=a.parent1)==null?void 0:Be.phonenumber)})]}),e.jsx(p,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,multiline:!0,value:(De=n==null?void 0:n.parent1)==null?void 0:De.address,onChange:g("parent1.address"),error:!!((Me=i.parent1)!=null&&Me.address&&((Ee=a.parent1)!=null&&Ee.address)),helperText:((Le=i.parent1)==null?void 0:Le.address)&&((Oe=a.parent1)==null?void 0:Oe.address)}),e.jsxs(R,{children:[e.jsx(B,{freeSolo:!0,fullWidth:!0,size:"small",options:xe,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:m=>m||"",value:(ke=n==null?void 0:n.parent1)==null?void 0:ke.residence,onChange:(m,x)=>j("parent1.residence",x),renderInput:m=>{var x,S,T,w;return e.jsx(p,{...m,label:"Residence",fullWidth:!0,size:"small",error:!!((x=i.parent1)!=null&&x.residence&&((S=a.parent1)!=null&&S.residence)),helperText:((T=i.parent1)==null?void 0:T.residence)&&((w=a.parent1)==null?void 0:w.residence)})}}),e.jsx(B,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:de,noOptionsText:"No Nationality available",getOptionLabel:m=>m||"",value:(Fe=n==null?void 0:n.parent1)==null?void 0:Fe.nationality,onChange:(m,x)=>j("parent1.nationality",x),renderInput:m=>{var x,S,T,w;return e.jsx(p,{...m,label:"Nationality",fullWidth:!0,size:"small",error:!!((x=i.parent1)!=null&&x.nationality&&((S=a.parent1)!=null&&S.nationality)),helperText:((T=i.parent1)==null?void 0:T.nationality)&&((w=a.parent1)==null?void 0:w.nationality)})}})]})]}),e.jsxs(h,{py:2,spacing:1,children:[e.jsxs(h,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:[e.jsx(z,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Parent/Guardian Information"}),e.jsx(pe,{sx:{width:30,height:30,bgcolor:"primary.main"},children:"2"})]}),e.jsxs(R,{children:[e.jsx(p,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:(Ve=n==null?void 0:n.parent2)==null?void 0:Ve.firstname,onChange:g("parent2.firstname"),error:!!((He=i.parent2)!=null&&He.firstname&&((qe=a.parent2)!=null&&qe.firstname)),helperText:((Ge=i.parent2)==null?void 0:Ge.firstname)&&((Ye=a.parent2)==null?void 0:Ye.firstname)}),e.jsx(p,{label:"Surname",fullWidth:!0,size:"small",value:($e=n==null?void 0:n.parent2)==null?void 0:$e.surname,onChange:g("parent2.surname"),error:!!((ve=i.parent2)!=null&&ve.surname&&((Qe=a.parent2)!=null&&Qe.surname)),helperText:((Ke=i.parent2)==null?void 0:Ke.surname)&&((Ue=a.parent2)==null?void 0:Ue.surname)})]}),e.jsxs(R,{children:[e.jsxs(p,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:(_e=n==null?void 0:n.parent2)==null?void 0:_e.gender,onChange:g("parent2.gender"),error:!!((Je=i.parent2)!=null&&Je.gender&&((Ze=a.parent2)!=null&&Ze.gender)),helperText:((Xe=i.parent2)==null?void 0:Xe.gender)&&((en=a.parent2)==null?void 0:en.gender),children:[e.jsx(V,{value:"male",children:"Male"}),e.jsx(V,{value:"female",children:"Female"})]}),e.jsx(B,{freeSolo:!0,fullWidth:!0,size:"small",options:he,loadingText:"Please wait....",noOptionsText:"No Relationship available",getOptionLabel:m=>m||"",value:(nn=n==null?void 0:n.parent2)==null?void 0:nn.relationship,onInputChange:(m,x)=>j("parent2.relationship",x),renderInput:m=>{var x,S,T,w;return e.jsx(p,{...m,label:"Relationship",fullWidth:!0,size:"small",error:!!((x=i.parent2)!=null&&x.relationship&&((S=a.parent2)!=null&&S.relationship)),helperText:((T=i.parent2)==null?void 0:T.relationship)&&((w=a.parent2)==null?void 0:w.relationship)})}})]}),e.jsxs(R,{children:[e.jsx(p,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:(tn=n==null?void 0:n.parent2)==null?void 0:tn.email,onChange:g("parent2.email"),error:!!((an=i.parent2)!=null&&an.email&&((rn=a.parent2)!=null&&rn.email)),helperText:((ln=i.parent2)==null?void 0:ln.email)&&((on=a.parent2)==null?void 0:on.email)}),e.jsx(p,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(sn=n==null?void 0:n.parent2)==null?void 0:sn.phonenumber,onChange:g("parent2.phonenumber"),error:!!((cn=i.parent2)!=null&&cn.phonenumber&&((pn=a.parent2)!=null&&pn.phonenumber)),helperText:((mn=i.parent2)==null?void 0:mn.phonenumber)&&((xn=a.parent2)==null?void 0:xn.phonenumber)})]}),e.jsx(p,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,multiline:!0,value:(dn=n==null?void 0:n.parent2)==null?void 0:dn.address,onChange:g("parent2.address"),error:!!((hn=i.parent2)!=null&&hn.address&&((jn=a.parent2)!=null&&jn.address)),helperText:((fn=i.parent2)==null?void 0:fn.address)&&((yn=a.parent2)==null?void 0:yn.address)}),e.jsxs(R,{children:[e.jsx(B,{freeSolo:!0,fullWidth:!0,size:"small",options:xe,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:m=>m||"",value:(gn=n==null?void 0:n.parent2)==null?void 0:gn.residence,onChange:(m,x)=>j("parent2.residence",x),renderInput:m=>{var x,S,T,w;return e.jsx(p,{...m,label:"Residence",fullWidth:!0,size:"small",error:!!((x=i.parent2)!=null&&x.residence&&((S=a.parent2)!=null&&S.residence)),helperText:((T=i.parent2)==null?void 0:T.residence)&&((w=a.parent2)==null?void 0:w.residence)})}}),e.jsx(B,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:de,noOptionsText:"No Nationality available",getOptionLabel:m=>m||"",value:(bn=n==null?void 0:n.parent2)==null?void 0:bn.nationality,onChange:(m,x)=>j("parent2.nationality",x),renderInput:m=>{var x,S,T,w;return e.jsx(p,{...m,label:"Nationality",fullWidth:!0,size:"small",error:!!((x=i.parent2)!=null&&x.nationality&&((S=a.parent2)!=null&&S.nationality)),helperText:((T=i.parent2)==null?void 0:T.nationality)&&((w=a.parent2)==null?void 0:w.nationality)})}})]})]})]}),e.jsx(h,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(ge,{loading:y,variant:"contained",color:"primary",onClick:f,children:"Save"})})]})}})})]})},wn=({open:t,setOpen:o})=>{const{schoolSessionDispatch:s}=C.useContext(L),{studentDispatch:d}=C.useContext(te),[c,u]=C.useState(!1),{studentId:y}=ne(),I=()=>o(!1),{isFetching:l,data:r}=Z({queryKey:["parent"],queryFn:()=>ji(y),enabled:!!y}),n=(i,j)=>{s({type:"sendQuickMessage",payload:{open:!0,data:{email:j,phonenumber:i}}})},a=i=>{d({type:"editParent",payload:{open:!0,data:i}})};return e.jsxs(e.Fragment,{children:[e.jsxs(H,{open:t,maxWidth:"sm",fullWidth:!0,onClose:I,children:[e.jsx(q,{title:"Parent Information",onClose:I}),e.jsxs(G,{children:[l&&e.jsx(z,{children:"Loading...."}),(r==null?void 0:r.length)>0?r==null?void 0:r.map((i,j)=>e.jsxs(X,{children:[e.jsx(je,{flexItem:!0,children:e.jsx(me,{label:`Parent /Guardian ${j+1}`,color:"primary"})}),e.jsx(b,{label:"Name",text:`${i==null?void 0:i.firstname} ${i==null?void 0:i.surname}`}),e.jsx(b,{label:"Relationship",text:i==null?void 0:i.relationship}),e.jsx(b,{label:"Gender",text:i==null?void 0:i.gender}),e.jsx(b,{label:"Email Address",text:i==null?void 0:i.email}),e.jsx(b,{label:"Telephone No.",text:i==null?void 0:i.phonenumber}),e.jsx(b,{label:"Address",text:i==null?void 0:i.address}),e.jsx(b,{label:"Residence",text:i==null?void 0:i.residence}),e.jsx(b,{label:"Nationality",text:i==null?void 0:i.nationality}),e.jsx(X,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",paddingY:2,gap:1,children:e.jsxs(h,{direction:"row",spacing:2,flexWrap:"wrap",children:[e.jsx(A,{size:"small",startIcon:e.jsx(Sn,{}),onClick:()=>n(i==null?void 0:i.phonenumber,i==null?void 0:i.email),children:"Send Message"}),e.jsx(A,{size:"small",endIcon:e.jsx(vn,{}),onClick:()=>a(i),children:"Edit"})]})})]},i==null?void 0:i._id)):e.jsxs(X,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[e.jsx(z,{children:"No Parent info available"}),e.jsx(A,{onClick:()=>u(!0),children:"Add New"})]})]})]}),e.jsx(ue,{}),e.jsx(gi,{open:c,setOpen:u})]})};wn.propTypes={open:W.bool,setOpen:W.func};const bi=be.memo(wn),Pn=({medical:t})=>{const o=ee(),{schoolSessionDispatch:s}=C.useContext(L),[d,c]=Cn(),{mutateAsync:u,isLoading:y}=ae({mutationFn:qn}),I=(r,n)=>{u(r,{onSettled:()=>{o.invalidateQueries(["student-by-id"]),n.setSubmitting(!1)},onSuccess:a=>{s(re(a)),l()},onError:a=>{s(le(a))}})},l=()=>c({open:"false"});return e.jsxs(H,{open:d.get("open")==="true",maxWidth:"sm",fullWidth:!0,onClose:l,children:[e.jsx(q,{title:"Medical History",onClose:l}),e.jsx(G,{children:e.jsx(ye,{initialValues:t,onSubmit:I,enableReinitialize:!0,validationSchema:Dn,children:({values:r,errors:n,touched:a,handleChange:i,handleSubmit:j,isSubmitting:g})=>{var f,P,D,M,E,O,N,Y,$,v,Q,K,U,_,J;return e.jsxs(h,{padding:2,spacing:1,children:[e.jsx(h,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(ge,{loading:g||y,variant:"contained",color:"primary",onClick:j,endIcon:e.jsx(hi,{}),children:"Save Changes"})}),e.jsxs(h,{width:{xs:"100%",md:"80%"},py:5,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(F,{title:"1. Heart Disease",value:r==null?void 0:r.heartDisease,setValue:i("heartDisease")}),e.jsx(F,{title:"2. Visual Impairment",value:r==null?void 0:r.visualImpairment,setValue:i("visualImpairment")})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(F,{title:"3. Asthma",value:r==null?void 0:r.asthma,setValue:i("asthma")}),e.jsx(F,{title:"4. Hearing Impairment",value:r==null?void 0:r.hearingImpairment,setValue:i("hearingImpairment")})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(F,{title:"5. Siezures",value:r==null?void 0:r.siezures,setValue:i("siezures")}),e.jsx(F,{title:"6. Physical Disability",value:r==null?void 0:r.physicalDisability,setValue:i("physicalDisability")})]})]}),e.jsxs(h,{py:2,spacing:1,children:[e.jsx(z,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Emergency Contact"}),e.jsxs(R,{children:[e.jsx(p,{label:"Fullname",type:"text",fullWidth:!0,size:"small",value:(f=r==null?void 0:r.emergencyContact)==null?void 0:f.fullname,onChange:i("emergencyContact.fullname"),error:!!((P=a==null?void 0:a.emergencyContact)!=null&&P.fullname&&((D=n==null?void 0:n.emergencyContact)!=null&&D.fullname)),helperText:((M=a==null?void 0:a.emergencyContact)==null?void 0:M.fullname)&&((E=n==null?void 0:n.emergencyContact)==null?void 0:E.fullname)}),e.jsx(p,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(O=r==null?void 0:r.emergencyContact)==null?void 0:O.phonenumber,onChange:i("emergencyContact.phonenumber"),error:!!((N=a==null?void 0:a.emergencyContact)!=null&&N.phonenumber&&((Y=n==null?void 0:n.emergencyContact)!=null&&Y.phonenumber)),helperText:(($=a==null?void 0:a.emergencyContact)==null?void 0:$.phonenumber)&&((v=n==null?void 0:n.emergencyContact)==null?void 0:v.phonenumber)})]}),e.jsx(R,{children:e.jsx(p,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,value:(Q=r==null?void 0:r.emergencyContact)==null?void 0:Q.address,onChange:i("emergencyContact.address"),error:!!((K=a==null?void 0:a.emergencyContact)!=null&&K.address&&((U=n==null?void 0:n.emergencyContact)!=null&&U.address)),helperText:((_=a==null?void 0:a.emergencyContact)==null?void 0:_.address)&&((J=n==null?void 0:n.emergencyContact)==null?void 0:J.address)})})]})]})}})})]})};Pn.propTypes={};const Rn=({report:t,open:o,setOpen:s})=>{const d=()=>s(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(H,{open:o,maxWidth:"md",fullWidth:!0,onClose:d,children:[e.jsx(q,{title:"Previous School Report",onClose:d}),e.jsx(G,{sx:{display:"flex",flexDirection:"column",justifyContent:"center"},children:e.jsx("iframe",{style:{width:"100%",height:"5in"},src:t})})]}),e.jsx(ue,{})]})};Rn.propTypes={open:W.bool,setOpen:W.func};const ui=be.memo(Rn),In=({student:t})=>{var P,D,M,E;const{type:o}=ne(),{schoolSessionDispatch:s}=C.useContext(L),{studentDispatch:d}=C.useContext(te),c=ee(),[u,y]=C.useState(!1),[I,l]=C.useState(!1),[r,n]=Cn(),a=()=>{n({open:!0})},i=()=>{d({type:"editStudent",payload:{open:!0,data:t}})},{mutateAsync:j}=ae(Gn),g=()=>{En.fire({title:`${t!=null&&t.active?"Disable":"Enable"} Student Acoount`,text:`Do you want to ${t!=null&&t.active?"disable":"enable"} account?`,showCancelButton:!0,backdrop:!1}).then(({isConfirmed:O})=>{O&&j({id:t==null?void 0:t._id,active:t!=null&&t.active?"Yes":"No"},{onSettled:()=>{c.invalidateQueries(["student-by-id"])},onSuccess:N=>{s(re(N))},onError:N=>{s(le(N))}})})},f=()=>{l(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs(oe,{children:[e.jsx(z,{variant:"h6",children:"Student Profile"}),e.jsxs(h,{direction:"row",justifyContent:"flex-end",alignItems:"center",columnGap:2,children:[e.jsx(A,{startIcon:e.jsx(un,{}),onClick:i,children:"Edit"}),e.jsx(A,{startIcon:e.jsx(Qn,{}),onClick:()=>y(!0),children:"Parent Info"}),e.jsx(A,{startIcon:e.jsx(mi,{}),onClick:a,children:"Medical Info"})]}),e.jsx(ie,{divider:!0,label:"Basic Info",icon:e.jsx(Tn,{})}),e.jsxs(h,{paddingY:2,children:[e.jsx(b,{label:"ID",text:t==null?void 0:t.indexnumber}),e.jsx(b,{label:"Name",text:t==null?void 0:t.fullName}),e.jsx(b,{label:"Date of Birth",text:Mn(new Date(t==null?void 0:t.dateofbirth)).format("Do MMMM, YYYY.")}),e.jsx(b,{label:"Gender",text:t==null?void 0:t.gender})]}),e.jsx(ie,{divider:!0,label:"Contact Info.",icon:e.jsx(xi,{})}),e.jsxs(h,{paddingY:2,children:[e.jsx(b,{label:"Email Address",text:t==null?void 0:t.email}),e.jsx(b,{label:"Telephone Number",text:t==null?void 0:t.phonenumber}),e.jsx(b,{label:"Address",text:t==null?void 0:t.address}),e.jsx(b,{label:"Residence",text:t==null?void 0:t.residence}),e.jsx(b,{label:"Nationality",text:t==null?void 0:t.nationality})]}),e.jsx(ie,{divider:!0,label:"Academic Info.",icon:e.jsx(un,{})}),e.jsxs(h,{paddingY:2,children:[e.jsx(b,{label:"Current Level",text:o||`${t==null?void 0:t.levelName} `}),e.jsx(b,{label:"Previous School",text:`${((D=(P=t==null?void 0:t.academic)==null?void 0:P.previousSchool)==null?void 0:D.name)||"Not Available"} `}),e.jsx(A,{startIcon:e.jsx(di,{}),onClick:f,variant:"contained",sx:{alignSelf:"flex-end"},children:"Previous Report"})]}),e.jsx(ie,{divider:!0,label:"Account Info.",icon:e.jsx(ci,{})}),e.jsx(b,{label:"Account Status",text:t!=null&&t.active?"Active":"Disabled"}),e.jsx(X,{sx:{display:"flex",justifyContent:"flex-end",paddingY:1},children:e.jsx(A,{variant:"contained",color:"error",endIcon:e.jsx(pi,{}),onClick:g,children:t!=null&&t.active?"Disable Account":"Enable Account"})})]}),e.jsx(Hn,{}),e.jsx(bi,{open:u,setOpen:y}),e.jsx(Pn,{medical:{...t==null?void 0:t.medical,id:t==null?void 0:t._id}}),e.jsx(ui,{report:(E=(M=t==null?void 0:t.academic)==null?void 0:M.previousSchool)==null?void 0:E.report,open:I,setOpen:l})]})};In.propTypes={student:W.object};const zn=({data:t})=>{const{studentId:o}=ne();return e.jsxs(oe,{children:[e.jsx(z,{variant:"h6",children:"Student Fees History"}),e.jsx(h,{sx:{width:"100%",maxHeight:"100vh",overflowY:"scroll"},children:(t==null?void 0:t.fees)!==void 0?e.jsx(e.Fragment,{children:t==null?void 0:t.fees.map(s=>{const d=Un();return e.jsx(Kn,{item:s,studentId:o},d)})}):e.jsx("div",{children:"No Fees History Available"})})]})};zn.propTypes={studentId:W.string};const Wn=({item:t})=>{var d;const{schoolSessionDispatch:o}=C.useContext(L),s=c=>{o({type:"openViewExamsRecord",payload:{open:!0,id:c}})};return e.jsx(Ln,{subheader:e.jsx($n,{sx:{bgcolor:"primary.main",color:"secondary.main"},children:t[0]}),sx:{paddingY:1},children:(d=t[1])==null?void 0:d.map(({term:c,_id:u,levelName:y})=>e.jsx(_n,{onClick:()=>s(u),children:e.jsx(Jn,{primary:y,secondary:c,primaryTypographyProps:{fontSize:14},secondaryTypographyProps:{fontSize:13,color:"primary.main",fontWeight:"bold"}})},u))})};Wn.propTypes={item:W.array};const An=()=>{const{palette:t}=On(),o=C.useRef(),{schoolSessionDispatch:s,schoolSessionState:{examsRecord:d}}=C.useContext(L),{data:c}=Z({queryKey:["student-exams-records",d.id],queryFn:()=>Xn(d.id),enabled:!!d.id}),u=()=>{s({type:"openViewExamsRecord",payload:{open:!1,id:""}})};return e.jsxs(e.Fragment,{children:[e.jsxs(H,{open:d.open,onClose:u,maxWidth:"md",fullWidth:!0,TransitionComponent:kn,children:[e.jsx(q,{title:"Exams Details",onClose:u}),e.jsx(Fn,{children:e.jsx(Zn,{trigger:()=>e.jsx(A,{variant:"contained",children:"Print Report"}),content:()=>o.current,documentTitle:"Report"})}),e.jsxs(G,{children:[e.jsx(h,{direction:"row",spacing:2,children:e.jsxs(z,{variant:"h5",children:[c==null?void 0:c.level,"-",c==null?void 0:c.term]})}),e.jsx(h,{children:e.jsxs("table",{style:{textAlign:"center",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Subject"}),e.jsx("th",{children:" Class Score (50%)"}),e.jsx("th",{children:" Exams Score (50%)"}),e.jsx("th",{children:"Total Score (100%)"}),e.jsx("th",{children:"Grade"}),e.jsx("th",{children:"Remarks"})]})}),e.jsx("tbody",{children:(c==null?void 0:c.scores)!==void 0?(c==null?void 0:c.scores.length)!==0&&(c==null?void 0:c.scores.map(y=>e.jsx(ni,{item:y},y.subject))):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",style:{padding:"3px 1px",fontSize:"20px"},children:"No Student Record Available"})})}),e.jsx("tfoot",{style:{textAlign:"center",textDecoration:"underline",borderTop:`solid 5px ${t.secondary.main}`,bgcolor:"primary.main",color:"primary.contrastText",width:"100%",padding:1},children:e.jsxs("tr",{children:[e.jsx("th",{children:"Overall Score"}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{children:c==null?void 0:c.overallScore}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{})]})})]})})]})]}),e.jsx("div",{className:"print-container",ref:o,children:e.jsx(ii,{student:c})})]})};An.propTypes={open:W.bool,setOpen:W.func};const Ci=be.memo(An),Si=({data:t})=>e.jsxs(oe,{children:[e.jsx(z,{variant:"h6",children:"Student Academics"}),e.jsx(h,{children:t!==void 0?e.jsx(e.Fragment,{children:t==null?void 0:t.map((o,s)=>e.jsx(Wn,{item:o},s))}):e.jsx("div",{children:"No Academic Records Available"})}),e.jsx(Ci,{})]}),lt=()=>{var i;const{userState:{session:t}}=C.useContext(Vn),o=ee(),{studentId:s,type:d,id:c}=ne(),{schoolSessionDispatch:u}=C.useContext(L),[y,I]=C.useState("1"),{data:l}=Z({queryKey:["student-profile",s],queryFn:()=>Yn(s),enabled:!!s,initialData:(i=o.getQueryData(["all-students"]))==null?void 0:i.find(j=>(j==null?void 0:j._id)===s)}),r=Z({queryKey:["student-academics",s],queryFn:()=>ei(t,s,c),enabled:!!s&&!!c}),n=Z({queryKey:["student-fees",s],queryFn:()=>ai(s),enabled:!!s}),a=()=>{u({type:"sendQuickMessage",payload:{open:!0,data:{email:l==null?void 0:l.email,phonenumber:l==null?void 0:l.phonenumber}}})};return e.jsxs(e.Fragment,{children:[e.jsx(ti,{to:"/student/view",color:"primary.main"}),e.jsxs(oe,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},justifyContent:{xs:"center",md:"space-between"},alignItems:{xs:"center",md:"start"},gap:5,pt:5},children:[e.jsxs(h,{spacing:1,justifyContent:"center",alignItems:"center",py:2,sx:{position:{xs:"relative",md:"-webkit-sticky"},top:0,minWidth:300},children:[e.jsx(pe,{srcSet:(l==null?void 0:l.profile)===""||(l==null?void 0:l.profile)===void 0?null:l==null?void 0:l.profile,sx:{width:100,height:100}}),e.jsx(z,{children:l==null?void 0:l.indexnumber}),e.jsx(z,{variant:"h6",children:l==null?void 0:l.fullName}),e.jsx(z,{variant:"body2",children:d||`${l==null?void 0:l.levelName}`}),e.jsx(A,{variant:"contained",startIcon:e.jsx(Sn,{}),onClick:a,children:"Send Message"})]}),e.jsx(X,{sx:{flexGrow:1},children:e.jsxs(ri,{value:y,children:[e.jsxs(li,{onChange:(j,g)=>I(g),variant:"scrollable",scrollButtons:"auto",children:[e.jsx(se,{value:"1",label:"Profile",icon:e.jsx(Tn,{}),iconPosition:"start"}),e.jsx(se,{value:"2",label:"Academic Records",icon:e.jsx(oi,{}),iconPosition:"start"}),e.jsx(se,{value:"3",label:"Fees History",icon:e.jsx(si,{}),iconPosition:"start"})]}),e.jsx(je,{}),e.jsx(ce,{value:"1",children:e.jsx(In,{student:l})}),e.jsx(ce,{value:"2",children:e.jsx(Si,{data:r==null?void 0:r.data})}),e.jsx(ce,{value:"3",children:e.jsx(zn,{data:n==null?void 0:n.data})})]})})]})]})};export{lt as default};
