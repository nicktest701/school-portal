import{g as C,r as o,f as y,a1 as L,v as A,i as B,j as e,J as I,S as _,T as i,b as q,B as w,L as E,q as T,_ as p,s as k,t as P,ac as Q}from"./index-bb65b4bf.js";import{d as F}from"./SaveAltRounded-d3ecde02.js";import{L as O,g as z}from"./subjectAPI-221b4718.js";import{u as R}from"./useLevelById-2106d452.js";import{B as D}from"./Back-0ebcc4f3.js";import{C as J}from"./CustomTitle-ed47c53b.js";import{A as K,L as M}from"./Autocomplete-95da27f3.js";import"./DeleteOutline-80e9f63f.js";import"./ListItem-befde9c4.js";import"./listItemButtonClasses-9702db06.js";import"./ListItemSecondaryAction-c66bb893.js";import"./ListItemText-33ae0292.js";import"./listItemTextClasses-35ff90f6.js";import"./ArrowBackRounded-54858719.js";import"./Chip-fa36c3a1.js";const ie=()=>{const l=C(),{schoolSessionDispatch:c}=o.useContext(y),[a,W]=L(),[u,d]=o.useState([]),[s,n]=o.useState([]),{subjects:m,levelLoading:j}=R(a.get("_id")),h=A({queryKey:["subjects"],queryFn:()=>z(),select:t=>p.map(t,"name")});o.useEffect(()=>{n(m)},[a.get("_id"),m]);const S=()=>{const t=p.uniq([...s,...u]);n(t),d([])},x=t=>{n(r=>r.filter(v=>v!==t))},{mutateAsync:f,isLoading:b}=B(Q),g=()=>{const t={levelId:a.get("_id"),subjects:s};f(t,{onSettled:()=>{l.invalidateQueries(["subjects"]),l.invalidateQueries(["level",a.get("_id")])},onSuccess:r=>{c(k(r))},onError:r=>{c(P(r))}})};return e.jsxs(e.Fragment,{children:[e.jsx(D,{to:"/level",color:"primary.main"}),e.jsx(J,{title:`Current Courses for ${a.get("type")}`,subtitle:"Add new subjects to the current level",color:"primary.main"}),e.jsxs(I,{children:[e.jsxs(_,{spacing:2,py:6,width:"100%",justifyContent:"center",alignItems:"flex-start",children:[e.jsx(i,{variant:"h6",children:"Please select one or multiple courses"}),e.jsx(K,{multiple:!0,freeSolo:!0,fullWidth:!0,options:h.data??[],disableCloseOnSelect:!0,getOptionLabel:t=>t||"",value:u,onChange:(t,r)=>d(r),renderInput:t=>e.jsx(q,{...t,label:"Select Course",size:"small",focused:!0})}),e.jsx(w,{variant:"contained",size:"small",onClick:S,sx:{px:4,py:2,alignSelf:"flex-end"},children:"Add Course"})]}),e.jsxs(E,{sx:{height:400,p:2,mt:4,overflow:"auto",bgcolor:"#fff"},subheader:e.jsxs(M,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:4},children:[e.jsxs(i,{variant:"h4",children:[s.length," Course(s) Available"]}),e.jsx(T,{startIcon:e.jsx(F,{}),loading:b,variant:"contained",onClick:g,disabled:(s==null?void 0:s.length)===0,children:"Save Courses"})]}),children:[j&&e.jsx(i,{variant:"h6",children:"Loading.... "}),s==null?void 0:s.map(t=>e.jsx(O,{name:t,removeSubject:x},t))]})]})]})};export{ie as default};
