import{r as n,a0 as w,u as b,af as D,g as I,f as L,_ as T,i as A,j as t,k as E,aw as k,p as B,B as g,q as N,m as M,T as C,x as h,s as F,t as O,G as S,H as _,O as H,J as P}from"./index-a08c4904.js";import{d as z}from"./School-ed618523.js";import{a as G}from"./studentColumns-89e76406.js";import{M as U,t as $,E as q,C as Q}from"./CustomizedMaterialTable-b0814305.js";import{E as J}from"./images-ee905b8b.js";import{b as R}from"./studentAPI-65ddac9a.js";import{u as W}from"./useLevelById-ba5e9072.js";import{s as X}from"./student_ico-5882123b.js";import Y from"./AttendanceHistory-3c7bed75.js";import{A as K}from"./Add-3c6bb686.js";import{B as V}from"./Back-26c0fe57.js";import{C as Z}from"./CustomTitle-d0e5d50c.js";import"./gradeColor-6983157e.js";import"./ListItemText-de69415f.js";import"./listItemTextClasses-cdd81f8c.js";import"./CircleRounded-fed72031.js";import"./TabPanel-3210be1c.js";import"./Toolbar-172ad7c3.js";import"./MenuItem-ddd79fe9.js";import"./Chip-a33d5899.js";import"./Autocomplete-62a3dcdf.js";import"./Skeleton-f52aff28.js";import"./ButtonGroup-ed336fd9.js";import"./InputAdornment-16e34158.js";import"./CardContent-8cf1caa6.js";import"./ListItemSecondaryAction-33dcc31c.js";import"./Grid-d7986873.js";import"./useMediaQuery-dbbfc5b2.js";import"./ListItem-559aef15.js";import"./listItemButtonClasses-628cfd1a.js";import"./ListItemButton-b9f74f93.js";import"./Check-6932050c.js";import"./DeleteOutline-f3e83ed5.js";import"./Delete-ee750b69.js";import"./attendanceAPI-50e101c6.js";import"./ArrowBackRounded-b2e199d9.js";function tt(){var f;const{userState:{session:s}}=n.useContext(w),{state:i}=b();D();const c=I(),[u,p]=n.useState([]),[o,a]=n.useState(!0),{schoolSessionState:d,schoolSessionDispatch:r}=n.useContext(L),e=d.fileData;n.useEffect(()=>{if(e.data.length>0){const l=e.columns.map(m=>({title:T.upperCase(m),field:m}));p(l)}a(!1)},[e]);const j=()=>{h.fire({title:"Exiting",text:"Do you want to exit?",showCancelButton:!0,backdrop:!1}).then(({isConfirmed:l})=>{l&&r({type:"closeFileDialog"})})},{mutateAsync:y}=A({mutationFn:R}),v=()=>{a(!0);const l={students:e.data,session:{sessionId:s.sessionId,termId:s.termId,levelId:i.levelId},type:e.type};h.fire({title:"Importing students",text:"Do you want to import ?",showCancelButton:!0,backdrop:!1}).then(({isConfirmed:m})=>{m&&y(l,{onSettled:()=>{c.invalidateQueries(["current-students"]),a(!1)},onSuccess:x=>{r(F(x))},onError:x=>{r(O(x))}}),a(!1)})};return t.jsxs(E,{open:e.open,fullScreen:!0,fullWidth:!0,children:[t.jsx(k,{children:"Preview"}),t.jsxs(B,{sx:{paddingX:3},children:[t.jsx(g,{onClick:j,children:"Cancel"}),t.jsx(N,{variant:"contained",loading:o,onClick:v,children:"Save"})]}),t.jsx(M,{children:((f=e.data)==null?void 0:f.length)===0?t.jsx(C,{children:"No data available"}):t.jsx(U,{title:"Students",isLoading:o,icons:$,columns:u,data:e.data,options:{pageSize:10,pageSizeOptions:[10,20,30,50]}})})]})}const et=()=>{const{id:s,type:i}=S(),c=_(),[u,p]=n.useState(!1),{students:o,rollNumber:a,levelLoading:d}=W(s),r=()=>{c("/student/new")},e=()=>{c(`/level/attendance/${s}/${i}`)};return d?t.jsx(H,{value:"Loading Student Information"}):t.jsxs(t.Fragment,{children:[(o==null?void 0:o.length)===0?t.jsx(q,{img:J.student,message:"ðŸ˜‘ No Student available.Add your first student to this level",buttonText:"New Student",onClick:r,showAddButton:!0}):t.jsx(Q,{search:!0,isLoading:d,title:i,subtitle:`${a} Students`,exportFileName:i||"",columns:G,data:o,actions:[],autoCompleteComponent:t.jsx(g,{variant:"contained",startIcon:t.jsx(K,{}),onClick:e,children:"Make New Attendance"}),icon:X}),t.jsx(Y,{open:u,setOpen:p}),t.jsx(tt,{})]})},Ht=()=>{const{type:s}=S();return t.jsxs(t.Fragment,{children:[t.jsx(V,{to:"/level",color:"primary.main"}),t.jsxs(P,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:{xs:"space-around",md:"space-between"},alignItems:"center",bgcolor:"#fff",mb:4,p:1},children:[t.jsx(Z,{title:"Current Level",subtitle:"Track,manage and control academic and class activities",icon:t.jsx(z,{color:"inherit",sx:{width:50,height:50}}),color:"primary.main"}),t.jsx(C,{variant:"h5",paragraph:!0,whiteSpace:"nowrap",children:s})]}),t.jsx(et,{})]})};export{Ht as default};
