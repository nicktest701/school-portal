import{b as z,r as i,S as F,u as P,d as D,j as e,C as N,e as I,x as L,a8 as V,k as p,T as c,F as W,A as U,l as q,B as u,a9 as M,aa as O,g as Q,h as _,_ as H}from"./index-B8PQHtjc.js";import{u as K,A as Y}from"./index-CeIRQj8o.js";import{E as G}from"./data-DylLMP3_.js";import{B as J}from"./Back-D8wcFeGb.js";import{T as X}from"./TextEditor-FJc8fVKg.js";import{A as Z}from"./Autocomplete-Dw57Ihk7.js";import"./isEqual-zuk4gZmy.js";import"./Chip-DmEpgF7y.js";function le(){const b=z(),{schoolSessionDispatch:m}=i.useContext(F),x=P(),[v,j]=i.useState(""),[d,f]=i.useState(""),[g,h]=i.useState(""),[l,y]=i.useState(""),[o,S]=i.useState(null),{getRootProps:C,getInputProps:E,open:T}=K({noClick:!0,noKeyboard:!0,maxFiles:1,accept:{"image/*":[".jpeg",".png",".webp"]},maxSize:2e5,multiple:!1,onDrop:n=>{if(!H.isEmpty(n)){const t=new FileReader;t.onload=function(a){const r=a.target.result;S(r)},t.readAsDataURL(n[0])}}});i.useEffect(()=>{},[l]);const w={type:v,title:d,description:l,album:o,caption:g},{mutateAsync:A,isPending:k}=D({mutationFn:O}),B=n=>{A(n,{onSettled:()=>{b.invalidateQueries(["events"])},onSuccess:()=>{m(Q("Event Created")),x("/events")},onError:t=>{m(_(t))}})};return e.jsxs(N,{children:[e.jsx(J,{to:"/events",color:"primary.main"}),e.jsx(I,{title:"New Events",subtitle:" Send single and bulk SMS to students and parents",color:"text.main",backColor:"#012e54"}),e.jsx(L,{initialValues:w,onSubmit:B,enableReinitialize:!0,validationSchema:V,children:({values:n,errors:t,touched:a,handleSubmit:r})=>e.jsxs(p,{px:2,py:4,spacing:4,bgcolor:"#fff",children:[e.jsx(Z,{freeSolo:!0,fullWidth:!0,size:"small",options:G,loadingText:"Please wait....",noOptionsText:"No Event available",getOptionLabel:s=>s||"",value:n==null?void 0:n.type,onChange:(s,R)=>j(R),renderInput:s=>e.jsx(c,{...s,label:"Select Event Type",fullWidth:!0,size:"small",error:!!(a.type&&t.type),helperText:a.type&&t.type})}),e.jsx(c,{label:"Event Title",fullWidth:!0,size:"small",row:3,maxRows:3,value:d,onChange:s=>f(s.target.value),error:!!(a.title&&t.title),helperText:a.title&&t.title}),e.jsx(c,{label:"Event Caption",fullWidth:!0,size:"small",row:3,maxRows:3,value:g,onChange:s=>h(s.target.value),error:!!(a.caption&&t.caption),helperText:a.caption&&t.caption}),e.jsx(X,{label:"Description",value:l,setValue:y,touched:a==null?void 0:a.description,errors:t==null?void 0:t.description}),e.jsxs("div",{children:[e.jsx(W,{style:{color:a.album&&t.album?"#B72136":"var(--primary)"},children:"Event Photo/Album"}),e.jsxs(p,{...C({className:"dropzone"}),sx:{borderRadius:1,border:a.album&&t.album?"1px solid #B72136":"1px dotted lightgray",py:8,px:4},children:[e.jsx(U,{variant:"square",src:o,sx:{width:{xs:o===null?120:"100%"},height:{xs:o===null?120:"100%"},objectFit:"contain",alignSelf:"center"}}),e.jsx("input",{...E()}),e.jsx(q,{textAlign:"center",paragraph:!0,children:"Drag & drop your photo here"}),e.jsx(u,{variant:"outlined",onClick:T,startIcon:e.jsx(Y,{}),children:"Upload Image"})]}),a.album&&t.album&&e.jsx(M,{sx:{color:"#B72136"},children:t.album})]}),e.jsxs(p,{direction:"row",justifyContent:"flex-end",spacing:2,children:[e.jsx(u,{onClick:()=>x("/events"),children:"Cancel"}),e.jsx(u,{loading:k,variant:"contained",color:"primary",onClick:r,children:"Create Event"})]})]})})]})}export{le as default};
