import{r as l,a0 as b,n as w,b as D,S as I,_ as L,d as E,j as t,s as T,aC as B,B as g,y as M,v as N,l as S,f,g as k,h as A,i as C,u as F,Q as P,aw as _,M as z,e as O}from"./index-DrgqF6h7.js";import{S as Q}from"./School-_-8G5cEF.js";import{a as U}from"./studentColumns-Dev_8qkQ.js";import{M as $,t as G,E as q,C as R}from"./CustomizedMaterialTable-sErZg5Gy.js";import{E as W}from"./images-B5fNBSni.js";import{b as X}from"./studentAPI-RzOrRYDb.js";import{D as Y}from"./DialogActions-Cx2GHHEW.js";import{u as H}from"./useLevelById-C5Sw-_pl.js";import{s as J}from"./student_ico-BGUw5C9J.js";import{B as K}from"./Back-CADpxW16.js";import"./gradeColor-B1MTvGsq.js";import"./ListItemText-Bwh_rzOL.js";import"./CircleRounded-Bh8WmZqU.js";import"./TabPanel-Bl8roboH.js";import"./useThemeProps-DLRF2U3R.js";import"./Toolbar-Bzx_LBRC.js";import"./Chip-BcLQNplL.js";import"./Autocomplete-D4vPEd6T.js";import"./Skeleton-BUD-o5ar.js";import"./ButtonGroup-DQMwsk7A.js";import"./InputAdornment-EcTjtcuD.js";import"./index-_n9xtSlI.js";import"./ListItem-yCsexoBs.js";import"./ListItemSecondaryAction-mmiMbVqP.js";import"./listItemButtonClasses-CLhmtlXH.js";import"./ListItemButton-BUsfko6u.js";import"./Check-CEGAxChF.js";import"./DeleteOutline-DM92K-00.js";function V(){var h;const{userState:{session:s}}=l.useContext(b),{state:n}=w(),c=D(),[o,u]=l.useState([]),[i,a]=l.useState(!0),{schoolSessionState:m,schoolSessionDispatch:p}=l.useContext(I),e=m.fileData;l.useEffect(()=>{if(e.data.length>0){const r=e.columns.map(d=>({title:L.upperCase(d),field:d}));u(r)}a(!1)},[e]);const j=()=>{f.fire({title:"Exiting",text:"Do you want to exit?",showCancelButton:!0,backdrop:!1}).then(({isConfirmed:r})=>{r&&p({type:"closeFileDialog"})})},{mutateAsync:v}=E({mutationFn:X}),y=()=>{a(!0);const r={students:e.data,session:{sessionId:s.sessionId,termId:s.termId,levelId:n.levelId},type:e.type};f.fire({title:"Importing students",text:"Do you want to import ?",showCancelButton:!0,backdrop:!1}).then(({isConfirmed:d})=>{d&&v(r,{onSettled:()=>{c.invalidateQueries(["current-students"]),a(!1)},onSuccess:x=>{p(k(x))},onError:x=>{p(A(x))}}),a(!1)})};return t.jsxs(T,{open:e.open,fullScreen:!0,fullWidth:!0,children:[t.jsx(B,{children:"Preview"}),t.jsxs(Y,{sx:{paddingX:3},children:[t.jsx(g,{onClick:j,children:"Cancel"}),t.jsx(M,{variant:"contained",loading:i,onClick:y,children:"Save"})]}),t.jsx(N,{children:((h=e.data)==null?void 0:h.length)===0?t.jsx(S,{children:"No data available"}):t.jsx($,{title:"Students",isLoading:i,icons:G,columns:o,data:e.data,options:{pageSize:10,pageSizeOptions:[10,20,30,50]}})})]})}const Z=()=>{const{id:s,type:n}=C(),c=F(),{students:o,rollNumber:u,levelLoading:i}=H(s),a=()=>{c("/student/new")},m=()=>{c(`/level/attendance/${s}/${n}`)};return i?t.jsx(P,{value:"Loading Student Information"}):t.jsxs(t.Fragment,{children:[(o==null?void 0:o.length)===0?t.jsx(q,{img:W.student,message:"ðŸ˜‘ No Student available.Add your first student to this level",buttonText:"New Student",onClick:a,showAddButton:!0}):t.jsx(R,{search:!0,isLoading:i,title:n,subtitle:`${u} Students`,exportFileName:n||"",columns:U,data:o,actions:[],autoCompleteComponent:t.jsx(g,{variant:"contained",startIcon:t.jsx(_,{}),onClick:m,children:"Make New Attendance"}),icon:J}),t.jsx(V,{})]})},Et=()=>{const{type:s}=C();return t.jsxs(t.Fragment,{children:[t.jsx(K,{to:"/level",color:"primary.main"}),t.jsxs(z,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:{xs:"space-around",md:"space-between"},alignItems:"center",bgcolor:"#fff",mb:4,p:1},children:[t.jsx(O,{title:"Current Level",subtitle:"Track,manage and control academic and class activities",icon:t.jsx(Q,{color:"inherit",sx:{width:50,height:50}}),color:"primary.main"}),t.jsx(S,{variant:"h5",paragraph:!0,whiteSpace:"nowrap",children:s})]}),t.jsx(Z,{})]})};export{Et as default};
