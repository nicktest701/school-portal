import{r,U as y,S as C,u as T,h as B,j as o,a2 as d,F as I,$ as E,V as z,b4 as W,m as A,T as i,v as N,bI as F,w as c,x as p,bJ as M,E as U,D as $}from"./index-5b8f5a53.js";const k="/assets/settings_ico-71e8260e.svg";function w(){const s=JSON.parse(localStorage.getItem("@school_info")),{userDispatch:x}=r.useContext(y),[h,g]=r.useState(`/images/users/${s==null?void 0:s.badge}`),{schoolSessionDispatch:l}=r.useContext(C),m=T(),{mutateAsync:S}=B({mutationFn:F}),b=(e,n)=>{S(e,{onSettled:()=>{n.setSubmitting(!1),m.invalidateQueries(["school"])},onSuccess:t=>{localStorage.setItem("@school_info",JSON.stringify(e)),x({type:"setUserInfo",payload:t}),l(c(t))},onError:t=>{l(p(t))}})},u=async e=>{var t;const n=(t=e.target)==null?void 0:t.files[0];try{const a=await M(n);l(c("School Image Uploaded")),m.invalidateQueries(["school"]),g(`/images/users/${a}`),s.badge=a,localStorage.setItem("@school_info",JSON.stringify(s))}catch{l(p("Error updating school logo"))}};return o.jsx(d,{maxWidth:"sm",children:o.jsx(I,{initialValues:s,onSubmit:b,enableReinitialize:!0,children:({values:e,errors:n,touched:t,handleChange:a,handleSubmit:f,isSubmitting:j})=>o.jsxs(o.Fragment,{children:[o.jsxs(E,{sx:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",marginY:2},children:[o.jsx(z,{src:h,sx:{width:120,height:120,justifySelf:"center",alignSelf:"center"}}),o.jsx(W,{handleImageUpload:u})]}),o.jsxs(A,{spacing:2,children:[o.jsx(i,{label:"School Name",placeholder:"School Name",type:"text",fullWidth:!0,size:"small",value:e==null?void 0:e.name,onChange:a("name"),error:!!(t.name&&n.name),helperText:t.name&&n.name}),o.jsx(i,{label:"Address",placeholder:"Address",type:"text",fullWidth:!0,size:"small",value:e==null?void 0:e.address,onChange:a("address"),error:!!(t.address&&n.address),helperText:t.address&&n.address}),o.jsx(i,{label:"Location",placeholder:"Location",type:"text",fullWidth:!0,size:"small",value:e==null?void 0:e.location,onChange:a("location"),error:!!(t.location&&n.location),helperText:t.location&&n.location}),o.jsx(i,{label:"Email Address",placeholder:"Email Address",type:"email",inputMode:"email",fullWidth:!0,size:"small",value:e==null?void 0:e.email,onChange:a("email"),error:!!(t.email&&n.email),helperText:t.email&&n.email}),o.jsx(i,{label:"Phone Number",placeholder:"e.g. 0244192831-0233847287",type:"text",fullWidth:!0,size:"small",value:e==null?void 0:e.phonenumber,onChange:a("phonenumber"),error:!!(t.phonenumber&&n.phonenumber),helperText:t.phonenumber&&n.phonenumber?n.phonenumber:'Separate multiple phone numbers with " - "'}),o.jsx(i,{label:"Motto",placeholder:"Motto",type:"text",fullWidth:!0,size:"small",value:e==null?void 0:e.motto,onChange:a("motto"),error:!!(t.motto&&n.motto),helperText:t.motto&&n.motto}),o.jsx(N,{loading:j,variant:"contained",color:"primary",onClick:f,children:"Save Settings"})]})]})})})}const D=()=>o.jsxs(d,{children:[o.jsx(U,{title:"Settings",subtitle:"Manage system preferences and settings to your convenience",img:k,backColor:"#012e54"}),o.jsx($,{}),o.jsx(w,{})]});D.propTypes={};export{D as default};
