import{O as $,j as e,P as D,Q as V,R as F,m as d,V as J,q as p,r as j,S as q,u as be,h as X,F as we,i as Z,C as ee,l as se,n as z,T as A,t as te,v as ae,w as oe,x as re,W as Pe,U as ke,X as ze,y as Ne,Y as $e,B as P,Z as De,_ as N,$ as H,a0 as je,e as Ve,D as qe,K as Be,a1 as Fe,A as Ge,a2 as ne,a3 as U,p as Ye,G as Ce,a4 as Ie,a5 as ge,a6 as Re,a7 as Te,g as W,a8 as We,a9 as Qe,aa as Ke,ab as Ue,ac as fe,ad as ye,ae as Ee,af as Je,M as Xe,ag as G,ah as Ze,ai as es,E as ss,J as ts,aj as as}from"./index-5b8f5a53.js";import{S as os}from"./studentColumns-2ede27bc.js";import{R as C,E as rs,a as Y}from"./ReportItemUnderline-7c06a2bc.js";import{p as ns,a as is,u as ls,g as cs,b as ds}from"./ExaminationAPI-bc1deb88.js";import{E as ve}from"./ExamsScoreItem-5b6c4d0d.js";import{g as hs}from"./generateCustomGrade-93281c1e.js";import{S as ms}from"./School-75c2090c.js";import{e as xs}from"./exams_ico-2188bf14.js";import{B as us}from"./BookSharp-96f4c6a6.js";const ps=$(e.jsx("path",{d:"M3 13h2v-2H3zm0 4h2v-2H3zm0-8h2V7H3zm4 4h14v-2H7zm0 4h14v-2H7zM7 7v2h14V7z"}),"List"),js=$(e.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7-.25c.41 0 .75.34.75.75s-.34.75-.75.75-.75-.34-.75-.75.34-.75.75-.75M8.9 17H7.5c-.28 0-.5-.22-.5-.5v-1.43c0-.13.05-.26.15-.35l5.81-5.81 2.12 2.12-5.83 5.83c-.09.09-.22.14-.35.14m7.95-7.73-1.06 1.06-2.12-2.12 1.06-1.06c.2-.2.51-.2.71 0l1.41 1.41c.2.2.2.51 0 .71"}),"NoteAltRounded"),gs=$(e.jsx("path",{d:"M16 4H4c-1.1 0-2 .9-2 2v12.01c0 1.1.9 1.99 2 1.99h16c1.1 0 2-.9 2-2v-8zM4 18.01V6h11v5h5v7.01z"}),"NoteOutlined"),fs=$(e.jsx("path",{d:"M17.5 13.5H16v-3h1.5zM16 2c-.55 0-1 .45-1 1v1H9V3c0-.55-.45-1-1-1s-1 .45-1 1v1H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3V3c0-.55-.45-1-1-1M9.5 14.25c0 .41-.34.75-.75.75H6c-.55 0-1-.45-1-1v-1.5c0-.55.45-1 1-1h2v-1H5.75c-.41 0-.75-.34-.75-.75S5.34 9 5.75 9H8.5c.55 0 1 .45 1 1v1.5c0 .55-.45 1-1 1h-2v1h2.25c.41 0 .75.34.75.75M19 14c0 .55-.45 1-1 1h-2.5c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1H18c.55 0 1 .45 1 1zm-6.25-7.25c0 .41-.34.75-.75.75s-.75-.34-.75-.75S11.59 6 12 6s.75.34.75.75m0 3.5c0 .41-.34.75-.75.75s-.75-.34-.75-.75.34-.75.75-.75.75.34.75.75m0 3.5c0 .41-.34.75-.75.75s-.75-.34-.75-.75.34-.75.75-.75.75.34.75.75m0 3.5c0 .41-.34.75-.75.75s-.75-.34-.75-.75.34-.75.75-.75.75.34.75.75"}),"ScoreboardRounded"),ys=$(e.jsx("path",{d:"m19.41 7.41-4.83-4.83c-.37-.37-.88-.58-1.41-.58H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8.83c0-.53-.21-1.04-.59-1.42m-9.18 9.88-2.12-2.12a.9959.9959 0 0 1 0-1.41c.39-.39 1.02-.39 1.41 0l1.41 1.41 3.54-3.54c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-4.24 4.24c-.38.4-1.02.4-1.41.01M14 9c-.55 0-1-.45-1-1V3.5L18.5 9z"}),"TaskRounded");var ie={},vs=V;Object.defineProperty(ie,"__esModule",{value:!0});var _e=ie.default=void 0,Ss=vs(D()),bs=e;_e=ie.default=(0,Ss.default)((0,bs.jsx)("path",{d:"M12 5.9c1.16 0 2.1.94 2.1 2.1s-.94 2.1-2.1 2.1S9.9 9.16 9.9 8s.94-2.1 2.1-2.1m0 9c2.97 0 6.1 1.46 6.1 2.1v1.1H5.9V17c0-.64 3.13-2.1 6.1-2.1M12 4C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 9c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4"}),"PersonOutlineOutlined");var le={},ws=V;Object.defineProperty(le,"__esModule",{value:!0});var Ae=le.default=void 0,ks=ws(D()),Cs=e;Ae=le.default=(0,ks.default)((0,Cs.jsx)("path",{d:"M14.59 8 12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"HighlightOffOutlined");var ce={},Is=V;Object.defineProperty(ce,"__esModule",{value:!0});var Me=ce.default=void 0,Rs=Is(D()),Ts=e;Me=ce.default=(0,Rs.default)((0,Ts.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m4.59-12.42L10 14.17l-2.59-2.58L6 13l4 4 8-8z"}),"CheckCircleOutlined");var de={},Es=V;Object.defineProperty(de,"__esModule",{value:!0});var Le=de.default=void 0,_s=Es(D()),As=e;Le=de.default=(0,_s.default)((0,As.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m0-14c-3.3 0-6 2.7-6 6s2.7 6 6 6 6-2.7 6-6-2.6-6-6-6m3 7H9v-2h6z"}),"DoNotDisturbOnTotalSilenceOutlined");var he={},Ms=V;Object.defineProperty(he,"__esModule",{value:!0});var He=he.default=void 0,Ls=Ms(D()),Hs=e;He=he.default=(0,Ls.default)((0,Hs.jsx)("path",{d:"M15 7v12.97l-4.21-1.81-.79-.34-.79.34L5 19.97V7zm4-6H8.99C7.89 1 7 1.9 7 3h10c1.1 0 2 .9 2 2v13l2 1V3c0-1.1-.9-2-2-2m-4 4H5c-1.1 0-2 .9-2 2v16l7-3 7 3V7c0-1.1-.9-2-2-2"}),"BookmarksOutlined");function O({title:s,value:t,icon:h,color:n}){return e.jsxs(d,{direction:"row",spacing:2,sx:{bgcolor:"white",borderRadius:1,padding:2,border:"1px solid lightgray",borderLeft:"2px solid #012E54"},children:[e.jsx(J,{sx:{width:50,height:50,color:`${n}.dark`,bgcolor:`${n}.lighter`},children:h}),e.jsxs(d,{spacing:1,children:[e.jsx(p,{variant:"body2",children:s}),e.jsx(p,{variant:"h5",children:t})]})]})}O.propTypes={title:F.string,value:F.number,icon:F.node,color:F.string};const Se=["Quite impressive, keep it up.","An outstanding result, do not rest on your oars.","shows interest and enthusiasm for study.","An excellent result, keep it up.","Is a very brilliant and clever student in the class.","Is such a pleasure to have great students like you in our class.","Asks questions when needed. ","Always ready for more challenges that is something I like the most about you.","Is one of the hardworking students in our class. ","Such a trustworthy and caring  in the class.","I love that he takes time to think before he speaks.","He is quite active in extracurricular activities. ","Works very well when in the team or with his best friends. ","So far, you progress is consistent. ","Enthusiast to learn and try something new.","Completes every assignment and task on time. ","I like your enthusiasm to learn new things. That’s a great skill you got. ","Your performance this time is truly impressive. Do you mind sharing how many hours you study at home everyday?","Very hardworking and supportive students in our class. We’re lucky to have you.","So much surprised by his transformations.  Great!","This school is so proud to have smart kids like you.Agem among us.","Very brilliant and clever student of the class.","Such a pleasure to have great students like you in our class.","Is a sincere and dedicated student who always helps others.","Leads a team very well, and quite a great manager for group activities.","Having great potential and getting his tasks finished on time.","Is positive, confident, and very supportive to others. ","Completes every assigned work on time, with a great focus. "," practicing a lot at home, I think. Impressive performance so far. ","Such a great student that others might have a lot to learn from. ","Seems like you are born with leadership skills, very active, and managed. ","Spends time thinking and choosing the right words to respond. ","Learns things a lot faster and remembers them for a longer period. ","Very confident and speaks very well in front of the whole class. ","Have an interest in learning something new and be present while teaching. ","Successfully passing the training phase, now it’s time to level up.","Keep hustling you will achieve it soon."],Os=["Has a well-developed sense of humor.","Holds many varied interests.","Has a keen interest that has been shared with the class.","Displays and talks about personal items from home when they relate to topics of study.","Provides background knowledge about topics of particular interest to them.","Has an impressive understanding and depth of knowledge about their interests.","Seeks additional information independently about classroom topics that pique interest.","Reads extensively for enjoyment.","Frequently discusses concepts about which they have read.","Is a gifted performer.","Is a talented artist.","Is a flair for dramatic reading and acting.","Enjoys sharing their musical talent with the class.","Discusses ideas that they’ve read regularly.","Enjoys showing off their musical abilities to the rest of the class.","Reads every day for pleasure.","Has a firm grasp of their interests.","Has a neat hobby that they shared with the rest of the class.","Has a wide range of interests.","Independently seeks out additional information on classroom topics.","Is a fantastic performer.","Is a gifted musician.","possesses a witty sense of humor."],Ps=["is an enthusiastic learner who seems to enjoy school.","exhibits a positive outlook and attitude in the classroom.","appears well rested and ready for each day's activities.","shows enthusiasm for classroom activities.","shows initiative and looks for new ways to get involved.","uses instincts to deal with matters independently and in a positive way.","strives to reach their full potential.","is committed to doing their best.","seeks new challenges.","takes responsibility for their learning.","cooperates consistently with the teacher and other students.","transitions easily between classroom activities without distraction.","is courteous and shows good manners in the classroom.","follows classroom rules.","conducts themselves with maturity.","responds appropriately when corrected.","remains focused on the activity at hand.","resists the urge to be distracted by other students.","is kind and helpful to everyone in the classroom.","sets an example of excellence in behavior and cooperation.","shows respect for teachers and peers.","treats school property and the belongings of others with care and respect.","is honest and trustworthy in dealings with others.","displays good citizenship by assisting other students.","joins in school community projects.","is concerned about the feelings of peers.","faithfully performs classroom tasks.","can be depended on to do what they are asked to do.","seeks responsibilities and follows through.","is thoughtful in interactions with others.","is kind, respectful and helpful when interacting with peers","is respectful of other students in our classroom and the school community","demonstrates responsibility daily by caring for the materials in our classroom carefully and thoughtfully","takes  classroom jobs seriously and demonstrates responsibility when completing them","is always honest and can be counted on to recount information when asked","is considerate when interacting with  teachers","demonstrates manners on a daily basis and is always respectful","has incredible self-discipline and always gets work done in a timely manner","can be counted on to be one of the first students to begin working on the task that is given","perseveres when faced with difficulty by asking questions and trying best","does not give up when facing a task that is difficult and always does best","is such a caring and demonstrates concern for peers","demonstrates caring nature when helping peers when they need the assistance","is a model citizen in our classroom","is demonstrates citizenship in our classroom by helping to keep it clean and taking care of the materials in it","can always be counted on to cooperate with peers","is able to cooperate and work well with any of the other students in the class","is exceptionally organized and takes care of things","is always enthusiastic when completing work","is agreeable and polite when working with others","is thoughtful and kind in interactions with others","is creative when problem solving","is very hardworking and always completes all of work","is patient and kind when working with peers who need extra assistance","trustworthy and can always be counted on to step in and help where needed"];function zs({open:s,setOpen:t,id:h}){const{schoolSessionDispatch:n}=j.useContext(q),m=be(),v={conduct:"",interest:"",teachersComments:"",headteachersComments:""},g=()=>t(!1),{mutateAsync:o,isLoading:f}=X(ns),S=a=>{o({_id:h,comments:a},{onSettled:()=>{m.invalidateQueries(["student-records"]),m.invalidateQueries(["exams-scores"])},onSuccess:i=>{n(oe(i)),g()},onError:i=>{n(re(i))}})};return e.jsx(we,{initialValues:v,onSubmit:S,children:({values:a,setFieldValue:u,errors:i,touched:b,handleSubmit:y})=>e.jsxs(Z,{open:s,onClose:g,maxWidth:"sm",fullWidth:!0,className:"add-remark",children:[e.jsx(ee,{title:"Add Remarks",onClose:g}),e.jsx(se,{children:e.jsxs(d,{spacing:2,paddingY:2,children:[e.jsx(z,{freeSolo:!0,options:Os,getOptionLabel:r=>r||"",value:a.interest,onChange:(r,x)=>u("interest",x),renderInput:r=>e.jsx(A,{...r,label:"Interest",size:"small",error:!!i.interest,helperText:b.interest&&i.interest})}),e.jsx(z,{freeSolo:!0,options:Ps,getOptionLabel:r=>r||"",value:a.conduct,onChange:(r,x)=>u("conduct",x),renderInput:r=>e.jsx(A,{...r,label:"Conduct",size:"small",error:!!i.conduct,helperText:b.conduct&&i.conduct})}),e.jsx(z,{freeSolo:!0,options:Se,getOptionLabel:r=>r||"",value:a.teachersComments,onChange:(r,x)=>u("teachersComments",x),renderInput:r=>e.jsx(A,{...r,label:"Teacher's Comments",size:"small",error:!!i.teachersComments,helperText:b.teachersComments&&i.teachersComments})}),e.jsx(z,{freeSolo:!0,options:Se,getOptionLabel:r=>r||"",value:a.headteachersComments,onChange:(r,x)=>u("headteachersComments",x),renderInput:r=>e.jsx(A,{...r,label:"Headteacher's Comments",size:"small",error:!!i.headteachersComments,helperText:b.headteachersComments&&i.headteachersComments})})]})}),e.jsx(te,{sx:{padding:2},children:e.jsx(ae,{loading:f,variant:"contained",onClick:y,children:"Save Changes"})})]})})}const Ns=({student:s})=>{var y,r,x,R;const t=JSON.parse(localStorage.getItem("@school_info")),{userState:{session:h}}=j.useContext(ke),{schoolSessionState:n,schoolSessionDispatch:m}=j.useContext(q),{palette:v}=ze(),g=j.useRef(),o=n.viewReport.open,[f,S]=j.useState(!1),a=()=>{m({type:"closeViewReport"})},{mutateAsync:u,isLoading:i}=X({mutationFn:is}),b=()=>{Be.fire({title:"Publishing Reports",text:`You are about to publish the report of ${(s==null?void 0:s.fullName)||"student"}.Do you wish to continue?`,showCancelButton:!0,backdrop:!1}).then(({isConfirmed:l})=>{if(l){m({type:"openGeneralAlert",payload:{message:"Publishing reports.This might take a while please wait....",severity:"info"}});const c={sessionId:h.sessionId,termId:h.termId,student:s==null?void 0:s._id,level:s==null?void 0:s.levelId};u(c,{onSuccess:()=>{m(oe("Results have been published Successfully!!!"))},onError:()=>{m(re("An error has occured.Couldnt Generate Reports.Try again later"))}})}})};return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{open:o,onClose:a,fullWidth:!0,maxWidth:"md",TransitionComponent:Ne,children:[e.jsx(ee,{title:"Report Card",onClose:a}),e.jsxs(te,{children:[e.jsx(ae,{loading:i,onClick:b,children:i?"Please Wait....":"Publish Report"}),e.jsx($e,{trigger:()=>e.jsx(P,{variant:"contained",children:"Print Report"}),content:()=>g.current,documentTitle:s==null?void 0:s.fullName})]}),e.jsx(se,{children:e.jsxs(d,{ref:g,spacing:1,sx:{maxWidth:"8.5in",minHeight:"11in",margin:"auto",padding:"16px",border:"1px solid lightgray"},children:[e.jsxs(d,{direction:"row",justifyContent:"center",alignItems:"center",columnGap:2,children:[t!=null&&t.badge?e.jsx(J,{alt:"school logo",loading:"lazy",srcSet:`/images/users/${t==null?void 0:t.badge}`,sx:{width:70,height:70}}):e.jsx(De,{sx:{width:50,height:50}}),e.jsxs(d,{justifyContent:"center",alignItems:"center",children:[e.jsx(p,{variant:"h5",children:N.startCase(t==null?void 0:t.name)}),e.jsx(p,{variant:"caption",children:t==null?void 0:t.address}),e.jsx(p,{variant:"caption",children:t==null?void 0:t.location}),e.jsx(p,{variant:"caption",fontStyle:"italic",children:t==null?void 0:t.motto})]})]}),e.jsx(p,{sx:{textAlign:"center",borderTop:`solid 2px ${v.secondary.main}`,bgcolor:"primary.main",color:"primary.contrastText",width:"100%",padding:"4px"},variant:"body2",children:"Report Card"}),e.jsx(d,{justifyContent:"center",alignItems:"center",children:e.jsx(J,{src:(s==null?void 0:s.profile)===""||(s==null?void 0:s.profile)===void 0||(s==null?void 0:s.profile)===null?null:s==null?void 0:s.profile,sx:{width:60,height:60,alignSelf:"center"}})}),e.jsxs(H,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(H,{children:e.jsxs(d,{children:[e.jsx(C,{title:"ID",text:s==null?void 0:s.indexnumber}),e.jsx(C,{title:"Full Name",text:s==null?void 0:s.fullName}),e.jsx(C,{title:"Class",text:`${s==null?void 0:s.level}`}),e.jsx(C,{title:"No. On Roll",text:s==null?void 0:s.rollNumber}),e.jsx(C,{title:"Grade",text:s==null?void 0:s.grade}),e.jsx(C,{title:"Promoted",text:""})]})}),e.jsxs(H,{sx:{flexGrow:1,alignItems:"center",textAlign:"center"},children:[e.jsx("p",{children:"Position"}),e.jsx(p,{variant:"h5",color:"error",children:s==null?void 0:s.position})]}),e.jsx(H,{children:e.jsxs(d,{children:[e.jsx(C,{title:"Academic Year",text:s==null?void 0:s.academicYear}),e.jsx(C,{title:"Term/Semester",text:s==null?void 0:s.term}),e.jsx(C,{title:"Vacation Date",text:je(s==null?void 0:s.vacationDate).format("Do MMMM,YYYY")}),e.jsx(C,{title:"Reopening Date",text:je(s==null?void 0:s.reOpeningDate).format("Do MMMM,YYYY")})]})})]}),e.jsx(d,{children:e.jsxs("table",{style:{textAlign:"center",borderCollapse:"collapse"},border:"1",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Subject"}),e.jsx("th",{children:" Class Score (50%)"}),e.jsx("th",{children:" Exams Score (50%)"}),e.jsx("th",{children:"Total Score (100%)"}),e.jsx("th",{children:"Grade"}),e.jsx("th",{children:"Remarks"})]})}),e.jsx("tbody",{children:(s==null?void 0:s.scores)!==void 0?(s==null?void 0:s.scores.length)!==0&&(s==null?void 0:s.scores.map(l=>e.jsx(rs,{item:l},l.subject))):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",style:{padding:"3px 1px",fontSize:"20px"},children:"No Student Record Available"})})}),e.jsx("tfoot",{style:{textAlign:"center",textDecoration:"underline",borderTop:`solid 5px ${v.secondary.main}`,bgcolor:"primary.main",color:"primary.contrastText",width:"100%",padding:1},children:e.jsxs("tr",{children:[e.jsx("th",{children:"Overall Score"}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{children:s==null?void 0:s.overallScore}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{})]})})]})}),e.jsx(H,{sx:{flex:1},children:e.jsxs(d,{rowGap:1,children:[e.jsxs(d,{direction:"row",justifyContent:"flex-end",columnGap:6,spacing:6,pt:1,pr:8,children:[e.jsx(C,{title:"Attendance  ",text:"    "}),e.jsx(C,{title:"Out Of           ",text:"       "})]}),e.jsx(d,{children:e.jsx(Y,{title:"Conduct & Attitude",text:((y=s==null?void 0:s.comments)==null?void 0:y.conduct)||"Hardworking"})}),e.jsx(d,{children:e.jsx(Y,{title:"Interest",text:((r=s==null?void 0:s.comments)==null?void 0:r.interest)||"Hardworking"})}),e.jsx(d,{children:e.jsx(Y,{title:"Class Teacher's Remarks",text:((x=s==null?void 0:s.comments)==null?void 0:x.teachersComments)||"Excellent Performance Keep it up!"})}),e.jsx(d,{children:e.jsx(Y,{title:"Headmaster's Remarks",text:((R=s==null?void 0:s.comments)==null?void 0:R.headteachersComments)||"Good job done!"})}),e.jsx(Ve,{className:"add-remarks-btn",onClick:()=>S(!0),sx:{cursor:"pointer"},children:"Add Remarks"})]})}),e.jsx(qe,{}),e.jsxs(d,{justifyContent:"center",alignItems:"center",children:[e.jsx(p,{children:"Bill"}),e.jsxs("table",{width:"60%",border:"1",style:{borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{children:"GHS"}),e.jsx("th",{children:"GHP"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{paddingLeft:"5px",fontSize:"13px"},children:"Tuition Fee"}),e.jsx("td",{}),e.jsx("td",{})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{paddingLeft:"5px",fontSize:"13px"},children:"Others"}),e.jsx("td",{}),e.jsx("td",{})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{paddingLeft:"5px",fontSize:"13px"},children:"Arrears"}),e.jsx("td",{}),e.jsx("td",{})]})]}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Total"}),e.jsx("th",{}),e.jsx("th",{})]})})]})]}),e.jsx(p,{style:{fontSize:"10px",fontStyle:"italic"},children:"Powered by FrebbyTech Consults (0543772591)"})]})})]}),e.jsx(zs,{open:f,setOpen:S,id:s==null?void 0:s._id})]})},$s=Pe.memo(Ns),Ds=({setTab:s,options:t})=>{const{schoolSessionState:h,schoolSessionDispatch:n}=j.useContext(q),m=h.examsScore,v=be(),[g,o]=j.useState({severity:"",text:""}),[f,S]=j.useState([]),a={subject:"",classScore:0,examsScore:0},u={subject:"Subject",classScore:"Class",examsScore:"Exams",totalScore:"Total",grade:"Grade",remarks:"Remarks"},i=(l,c)=>{const w=Number(l.classScore)+Number(l.examsScore),T=hs(w,t==null?void 0:t.grades),M={...l,...T},L=N.merge(N.keyBy([...f,M],"subject"));S(N.values(L)),c.resetForm()},b=l=>{S(c=>c.filter(({subject:T})=>T!==l))},{mutateAsync:y,isLoading:r}=X({mutationFn:ls}),x=()=>{const l={session:m.data,scores:f};y(l,{onSettled:()=>{v.invalidateQueries(["student-records"]),v.invalidateQueries(["exams-scores"]),v.invalidateQueries(["exams-details"]),v.invalidateQueries(["exams-reports"]),v.invalidateQueries(["exams-by-id"])},onSuccess:c=>{n(oe(c)),s("1")},onError:c=>{n(re(c))}})},R=()=>n({type:"openAddExamsScore",payload:{open:!1,data:{}}});return e.jsx(we,{initialValues:a,validationSchema:Fe,onSubmit:i,children:({values:l,errors:c,touched:w,handleChange:T,handleSubmit:M,setFieldValue:L})=>e.jsxs(e.Fragment,{children:[g.text&&e.jsx(Ge,{sx:{marginY:1},severity:g.severity,onClose:()=>o({text:""}),children:g.text}),e.jsxs(ne,{children:[e.jsxs(U,{container:!0,spacing:2,rowGap:2,children:[e.jsxs(U,{item:!0,xs:12,md:5,padding:2,children:[e.jsxs(d,{spacing:2,paddingY:2,children:[e.jsx(z,{freeSolo:!0,options:t==null?void 0:t.subjects,loadingText:"Loading Subjects.Please Wait...",getOptionLabel:I=>I||"",value:l.subject,onChange:(I,B)=>L("subject",B),renderInput:I=>e.jsx(A,{...I,label:"Subject",size:"small",error:!!c.subject,helperText:w.subject&&c.subject})}),e.jsx(A,{type:"number",label:"Class Score",size:"small",value:l.classScore,onChange:T("classScore"),error:!!c.classScore,helperText:w.classScore&&c.classScore}),e.jsx(A,{type:"number",label:"Exams Score",size:"small",value:l.examsScore,onChange:T("examsScore"),error:!!c.examsScore,helperText:w.examsScore&&c.examsScore})]}),e.jsx(P,{variant:"contained",size:"small",onClick:M,children:"Add Score"})]}),e.jsxs(U,{item:!0,xs:12,md:7,padding:2,children:[e.jsx(ve,{item:u,title:!0}),e.jsx(Ye,{sx:{maxHeight:300,overflowY:"scroll"},children:f.map(I=>e.jsx(ve,{item:I,removeSubject:b},I.subject))})]})]}),e.jsxs(d,{spacing:2,direction:"row",justifyContent:"flex-end",children:[e.jsx(P,{onClick:R,children:"Cancel"}),e.jsx(ae,{variant:"contained",disabled:f.length===0,onClick:x,loading:r,children:"Save Results"})]})]})]})})};function Vs({details:s}){const t=[{field:"subject",title:"Subject"},{field:"classScore",title:"Class Score"},{field:"examsScore",title:"Exams Score"},{field:"totalScore",title:"Total Score",cellStyle:{color:"red"}},{field:"grade",title:"Grade"},{field:"remarks",title:"Remarks",cellStyle:{color:"green"},render:({totalScore:h,remarks:n})=>e.jsx(P,{sx:{color:ge(h).color,bgcolor:ge(h).bg},children:n})}];return e.jsx(ne,{children:e.jsx(Ce,{icon:(s==null?void 0:s.profile)||e.jsx(ms,{}),title:(s==null?void 0:s.fullName)||"Student",columns:t,data:s==null?void 0:s.scores,actions:[],search:!1,addButtonImg:Ie,addButtonMessage:"No Exams Score available"})})}function qs(){var u,i,b,y,r,x,R,l;const{schoolSessionState:s,schoolSessionDispatch:t}=j.useContext(q),h=s.examsScore,[n]=Re(),{levelId:m}=Te(),[v,g]=j.useState("1"),o=W({queryKey:["exams-by-id",n.get("exams_id")],queryFn:()=>cs(n.get("exams_id")),enabled:!!n.get("exams_id")}),f=W({queryKey:["subjects",m],queryFn:()=>Ee(m),enabled:!!m,select:({subjects:c,grades:w})=>({subjects:c,grades:w})}),S=()=>t({type:"openAddExamsScore",payload:{open:!1,data:{}}}),a=()=>{t({type:"openViewReport"})};return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{open:h.open,onClose:S,fullWidth:!0,maxWidth:"md",children:[e.jsx(ee,{title:"Student Assessment",subtitle:"View and manipulate results of student",onClose:S}),o.isLoading?e.jsx(d,{justifyContent:"center",alignItems:"center",children:e.jsx(We,{})}):o!=null&&o.isError?e.jsx(d,{justifyContent:"center",alignItems:"center",children:e.jsx(p,{children:"An error has occurred!"})}):e.jsxs(se,{children:[e.jsx(p,{variant:"h4",children:(u=o==null?void 0:o.data)==null?void 0:u.fullName}),e.jsxs(p,{textAlign:"right",variant:"h5",children:["Overall Score - ",N.sumBy((i=o==null?void 0:o.data)==null?void 0:i.scores,"totalScore")??0]}),e.jsxs(d,{spacing:2,py:1,children:[e.jsx(p,{children:"Results Entry"}),e.jsx(Qe,{variant:"determinate",value:(y=(b=o==null?void 0:o.data)==null?void 0:b.entry)==null?void 0:y.percent,color:"secondary"}),e.jsxs(p,{textAlign:"center",fontSize:11,children:[(x=(r=o==null?void 0:o.data)==null?void 0:r.entry)==null?void 0:x.completed,"/",(l=(R=o==null?void 0:o.data)==null?void 0:R.entry)==null?void 0:l.total," ","completed"]})]}),e.jsx(te,{children:e.jsx(P,{variant:"contained",startIcon:e.jsx(js,{}),onClick:a,children:"View Report"})}),e.jsxs(Ke,{value:v,children:[e.jsxs(Ue,{onChange:(c,w)=>g(w),children:[e.jsx(fe,{label:"Exams Score",value:"1",icon:e.jsx(fs,{}),iconPosition:"start"}),e.jsx(fe,{label:"New Exams Score",value:"2",icon:e.jsx(ys,{}),iconPosition:"start"})]}),e.jsx(ye,{value:"1",children:e.jsx(Vs,{details:o.data,options:f})}),e.jsx(ye,{value:"2",children:e.jsx(Ds,{setTab:g,options:f==null?void 0:f.data})})]})]})]}),e.jsx($s,{student:o.data})]})}const Bs=j.lazy(()=>Je(()=>import("./LevelExamScoreInput-0ec1afa6.js"),["assets/LevelExamScoreInput-0ec1afa6.js","assets/index-5b8f5a53.js","assets/index-ec9514e5.css","assets/AnimatedContainer-c7efad6f.js","assets/ExaminationAPI-bc1deb88.js","assets/generateCustomGrade-93281c1e.js","assets/NoteRounded-a4f6fc26.js"])),Zs=({type:s})=>{var l,c,w,T,M,L,I,B;const t=Xe(),{userState:{session:h}}=j.useContext(ke),{levelId:n,level:m}=Te(),[v,g]=Re(),{schoolSessionDispatch:o}=j.useContext(q),[f,S]=j.useState(!1),a=W({queryKey:["exams-details",n],queryFn:()=>ds({sessionId:h.sessionId,termId:h.termId,levelId:n}),enabled:!!n&&!!h.sessionId&&!!h.termId}),u=W({queryKey:["subjects",n],queryFn:()=>Ee(n),enabled:!!n,select:({subjects:k,grades:E})=>({subjects:k,grades:E})}),i=k=>{g(E=>(E.set("exams_id",k==null?void 0:k._id),E.set("student_id",k==null?void 0:k.studentId),E)),o({type:"openAddExamsScore",payload:{open:!0,data:{levelId:n,studentId:k.studentId,sessionId:h.sessionId,termId:h.termId}}})},b=[...os,{field:null,title:"Exams Details",render:k=>e.jsx(P,{variant:"outlined",onClick:()=>i(k),children:"View Details"})}],y={width:28,height:28},r=()=>{t(`/${s}/reports/${n}`)},x=j.useCallback(()=>{var xe,ue;const k=["Index Number","Student","Class  Score","Exams  Score","Total  Score"],E=(ue=(xe=a==null?void 0:a.data)==null?void 0:xe.students)==null?void 0:ue.map(_=>({indexnumber:_==null?void 0:_.indexnumber,student:_==null?void 0:_.fullName})),Q=G.json_to_sheet(E),me=G.book_new();G.book_append_sheet(me,Q,m||"Subject"),G.sheet_add_aoa(Q,[k],{origin:"A1"});const Oe=E.reduce((_,K)=>{var pe;return Math.max(_,(pe=K==null?void 0:K.student)==null?void 0:pe.length)},10);Q["!cols"]=[{wch:Oe}],Ze(me,`${m||"Subject"}.xlsx`,{compression:!0})},[(l=a==null?void 0:a.data)==null?void 0:l.students]),R=()=>{S(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(es,{to:s==="course"?"/course/level":"/examination",color:"primary.main"}),e.jsxs(ne,{sx:{display:"flex",flexDirection:{xs:"column-reverse",sm:"row"},justifyContent:"space-between",alignItems:"center",gap:2,bgcolor:"#fff",my:2},children:[e.jsx(ss,{title:"Examination Portal",subtitle:"Track,manage and control academic and class activities",img:xs,backColor:"#012e54"}),e.jsx(p,{sx:{display:{xs:"none",md:"inline-flex"}},variant:"h5",paragraph:!0,whiteSpace:"nowrap",children:m})]}),e.jsxs(H,{sx:{width:"100%",display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(200px,1fr))",gap:2,py:4},children:[e.jsx(O,{title:"Total Student",value:(c=a.data)==null?void 0:c.noOfStudents,icon:e.jsx(_e,{sx:y}),color:"info"}),e.jsx(O,{title:"Highest Marks",value:(w=a.data)==null?void 0:w.highestMarks,icon:e.jsx(He,{sx:y}),color:"success"}),e.jsx(O,{title:"Lowest Marks",value:(T=a.data)==null?void 0:T.lowestMarks,icon:e.jsx(Le,{sx:y}),color:"warning"}),e.jsx(O,{title:"Pass Students",value:(M=a.data)==null?void 0:M.passStudents,icon:e.jsx(Me,{sx:y}),color:"success"}),e.jsx(O,{title:"Failed Students",value:(L=a.data)==null?void 0:L.failStudents,icon:e.jsx(Ae,{sx:y}),color:"error"})]}),e.jsx(Ce,{title:m??"Students",icon:Ie,isLoading:a.isLoading,columns:b,search:!0,data:(I=a==null?void 0:a.data)==null?void 0:I.students,actions:[{icon:()=>e.jsx(gs,{color:"info"}),position:"toolbar",tooltip:"Download Assessment Sheet",onClick:x,isFreeAction:!0},{icon:()=>e.jsx(us,{color:"warning"}),position:"toolbar",tooltip:"Import Results",onClick:R,isFreeAction:!0},{icon:()=>e.jsx(ps,{color:"error"}),position:"toolbar",tooltip:"View Students Report",onClick:r,isFreeAction:!0}],handleRefresh:a.refetch,addButtonImg:ts.student,addButtonMessage:"😑 No Students results available !!!!"}),e.jsx(qs,{}),e.jsx(j.Suspense,{fallback:e.jsx(as,{}),children:e.jsx(Bs,{open:f,setOpen:S,grades:(B=u==null?void 0:u.data)==null?void 0:B.grades,defaultSubject:""})})]})};export{Zs as default};
