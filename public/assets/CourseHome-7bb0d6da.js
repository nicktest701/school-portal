import{j as e,M as i,I as o,l as U,m as d,ak as E,fQ as _,r as q,a0 as z,c as G,e as M,A as Q,D as u,an as a}from"./index-ce442eb1.js";import{d as H,C as x}from"./CustomCard-25c50229.js";import{d as p}from"./Subject-d60fab2e.js";import{d as F}from"./Person3-1da9e9a8.js";import{D as c}from"./DashboardCard-fffc64d2.js";import{R as N,L as O,B as J}from"./index-dc9eb6e7.js";import{a as V}from"./courseAPI-0bcd1e07.js";function X({data:s}){return e.jsxs(i,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(150px,1fr))",gap:2,py:4},children:[e.jsx(c,{title:"Levels",value:s==null?void 0:s.levels,icon:e.jsx(o,{sx:{bgcolor:"error.lighter"},children:e.jsx(H,{sx:{width:20,height:20,color:"error.darker"}})})}),e.jsx(c,{title:"Courses",value:s==null?void 0:s.courses,icon:e.jsx(o,{sx:{bgcolor:"info.lighter"},children:e.jsx(F,{sx:{width:20,height:20,color:"info.darker"}})})}),e.jsx(c,{title:"Students",value:s==null?void 0:s.students,icon:e.jsx(o,{sx:{bgcolor:"success.lighter"},children:e.jsx(p,{sx:{width:20,height:20,color:"success.darker"}})})})]})}function $({label:s,value:r,color:t,m:l}){return e.jsxs(U,{justifyContent:"space-between",alignItems:"center",spacing:3,children:[e.jsx(i,{sx:{width:100,height:100,borderRadius:"50%",bgcolor:t||"primary.main",display:"flex",justifyContent:"center",alignItems:"center",marginLeft:l},children:e.jsx(d,{textAlign:"center",fontSize:20,color:"#fff",children:r})}),e.jsx(d,{children:s})]})}const Y=({values:s,labels:r})=>{const{palette:t}=E();return e.jsx(i,{sx:{minWidth:200,height:200},children:e.jsx(N,{datasetIdKey:"id",data:{labels:r,datasets:[{data:s,borderColor:t.primary.main,backgroundColor:[t.primary.main,t.secondary.main],fill:"-2"}]},options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:10},elements:{line:{borderWidth:3}},scales:{r:{angleLines:{display:!1}}},plugins:{legend:{display:!1,position:"bottom"}}}})})},Z=({labels:s,values:r,values2:t})=>{const{palette:l}=E();return e.jsx(i,{sx:{minWidth:200,height:200},children:e.jsx(O,{datasetIdKey:"line",data:{labels:s,datasets:[{label:"Present",data:r,borderColor:l.secondary.main,tension:.3},t&&{label:"Absent",data:t,borderColor:l.primary.main,tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:10},scales:{x:{ticks:{},grid:{display:!1}},y:{ticks:{},grid:{display:!1}}},plugins:{legend:{}}}})})},I=({labels:s,data:r})=>{const{palette:t}=_();return e.jsx(i,{sx:{minWidth:200,height:200},children:e.jsx(J,{data:{labels:s,datasets:[{label:"No of Students",data:r,backgroundColor:[t.primary.main,t.secondary.main],barThickness:10,borderRadius:10}]},options:{responsive:!0,maintainAspectRatio:!1,layout:{padding:2,autoPadding:!0},scales:{x:{ticks:{},grid:{display:!1}},y:{ticks:{},grid:{display:!1}}},plugins:{legend:{display:!1}}}})})};function ee({data:s}){return e.jsxs(i,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(150px,1fr))",gap:2,py:4},children:[e.jsx(c,{title:"Present Today",value:s==null?void 0:s.present,icon:e.jsx(o,{sx:{bgcolor:"info.lighter"},children:e.jsx(F,{sx:{width:20,height:20,color:"info.darker"}})})}),e.jsx(c,{title:"Absent Today",value:s==null?void 0:s.absent,icon:e.jsx(o,{sx:{bgcolor:"success.lighter"},children:e.jsx(p,{sx:{width:20,height:20,color:"success.darker"}})})}),e.jsx(c,{title:"Unmarked Today",value:s==null?void 0:s.unknown,icon:e.jsx(o,{sx:{bgcolor:"warning.lighter"},children:e.jsx(p,{sx:{width:20,height:20,color:"warning.darker"}})})})]})}function oe(){var m,j,y,f,v,C,b,k,A,w,S,T,W,L,R,D,B;const{user:s,userState:{session:r}}=q.useContext(z),t=G({queryKey:["course-dashboard-info"],queryFn:()=>V({session:r==null?void 0:r.sessionId,term:r==null?void 0:r.termId,teacher:s==null?void 0:s.id}),enabled:!!(r!=null&&r.sessionId)&&!!(r!=null&&r.termId)&&!!(s!=null&&s.id)}),l=(j=(m=t==null?void 0:t.data)==null?void 0:m.studentInEachLevel)==null?void 0:j.map(n=>n==null?void 0:n.level),K=(f=(y=t==null?void 0:t.data)==null?void 0:y.studentInEachLevel)==null?void 0:f.map(n=>n==null?void 0:n.students),h=(C=(v=t==null?void 0:t.data)==null?void 0:v.groupedWeeklyAttendance)==null?void 0:C.map(n=>n==null?void 0:n.date),P=(k=(b=t==null?void 0:t.data)==null?void 0:b.groupedWeeklyAttendance)==null?void 0:k.map(n=>n==null?void 0:n.present),g=(w=(A=t==null?void 0:t.data)==null?void 0:A.groupedWeeklyAttendance)==null?void 0:w.map(n=>n==null?void 0:n.absent);return e.jsxs(e.Fragment,{children:[e.jsx(M,{title:(S=s==null?void 0:s.fullname)==null?void 0:S.toUpperCase(),subtitle:"We hope your having a great day!",color:"white",bgColor:"primary.main",icon:e.jsx(Q,{loading:"lazy",srcSet:`https://school-portal-aivn.onrender.com/api/frebbys/v1/images/users/${s==null?void 0:s.profile}`,sx:{width:80,height:80}})}),e.jsx(d,{variant:"h5",py:2,children:"Summary"}),e.jsx(u,{}),e.jsx(X,{data:t==null?void 0:t.data}),e.jsx(d,{variant:"h5",py:2,children:"Student Overview"}),e.jsx(u,{}),e.jsxs(a,{container:!0,spacing:3,py:2,children:[e.jsx(a,{item:!0,lg:4,md:4,xs:12,children:e.jsx(x,{title:"Students by Gender",children:e.jsxs(i,{sx:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",height:200},children:[e.jsx($,{color:"primary.main",label:"Males",value:((L=(W=(T=t==null?void 0:t.data)==null?void 0:T.groupedStudents)==null?void 0:W.male)==null?void 0:L.length)??0,m:0}),e.jsx($,{color:"secondary.main",label:"Females",value:((B=(D=(R=t==null?void 0:t.data)==null?void 0:R.groupedStudents)==null?void 0:D.female)==null?void 0:B.length)??0,m:"-12px"})]})})}),e.jsx(a,{item:!0,lg:8,md:8,xs:12,children:e.jsx(x,{title:"Students in levels",children:e.jsx(I,{labels:l,data:K})})})]}),e.jsx(d,{variant:"h5",py:2,children:"Level Attendance"}),e.jsx(u,{}),e.jsx(ee,{data:t==null?void 0:t.data}),e.jsxs(a,{container:!0,spacing:3,children:[e.jsx(a,{item:!0,lg:8,sm:6,xs:12,children:e.jsx(x,{title:"Total Weekly Attendance",children:e.jsx(Z,{labels:h,values:P,values2:g})})}),e.jsx(a,{item:!0,lg:4,sm:6,xs:12,children:e.jsx(x,{title:"Weekly Absent",children:e.jsx(Y,{labels:h,values:g})})})]})]})}export{oe as default};
