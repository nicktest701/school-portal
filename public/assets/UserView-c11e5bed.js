import{c as oe,j as a,G as J,g as K,r as j,f as X,i as D,k as ne,l as ie,n as le,al as re,m as de,S,b as G,p as ce,q as xe,am as me,x as U,s as A,t as k,U as pe,H as he,v as ue,an as fe,J as P,B as f,A as je,D as H,h as we,O as ge,ao as ye,ap as be}from"./index-a08c4904.js";import{M as Ce,P as s}from"./ProfileItem-e91ade34.js";import{B as ve}from"./Back-26c0fe57.js";import{C as Pe}from"./CustomTitle-d0e5d50c.js";import{B as De}from"./ButtonGroup-ed336fd9.js";import{E as Se}from"./Edit-d3e93a55.js";import{C as _}from"./Chip-a33d5899.js";import"./ArrowBackRounded-b2e199d9.js";const Z=oe(a.jsx("path",{d:"M3 17h18c.55 0 1 .45 1 1s-.45 1-1 1H3c-.55 0-1-.45-1-1s.45-1 1-1m-.5-4.43c.36.21.82.08 1.03-.28l.47-.82.48.83c.21.36.67.48 1.03.28.36-.21.48-.66.28-1.02l-.49-.84h.95c.41 0 .75-.34.75-.75s-.34-.75-.75-.75H5.3l.47-.82c.21-.36.09-.82-.27-1.03-.36-.2-.82-.08-1.03.28L4 8.47l-.47-.82c-.21-.36-.67-.48-1.03-.28-.36.21-.48.67-.27 1.03l.47.82h-.95c-.41 0-.75.34-.75.75s.34.75.75.75h.95l-.48.83c-.2.36-.08.82.28 1.02m8 0c.36.21.82.08 1.03-.28l.47-.82.48.83c.21.36.67.48 1.03.28.36-.21.48-.66.28-1.02l-.48-.83h.95c.41 0 .75-.34.75-.75s-.34-.75-.75-.75h-.96l.47-.82c.21-.36.08-.82-.27-1.03-.36-.21-.82-.08-1.02.27l-.48.82-.47-.82c-.21-.36-.67-.48-1.02-.27-.36.21-.48.67-.27 1.03l.47.82h-.96c-.41-.01-.75.33-.75.74s.34.75.75.75h.95l-.48.83c-.2.36-.08.82.28 1.02M23 9.97c0-.41-.34-.75-.75-.75h-.95l.47-.82c.21-.36.08-.82-.27-1.03-.36-.21-.82-.08-1.02.27l-.48.83-.47-.82c-.21-.36-.67-.48-1.02-.27-.36.21-.48.67-.27 1.03l.47.82h-.95c-.42-.01-.76.33-.76.74s.34.75.75.75h.95l-.48.83c-.21.36-.08.82.28 1.02.36.21.82.08 1.03-.28l.47-.82.48.83c.21.36.67.48 1.03.28.36-.21.48-.66.28-1.02l-.48-.83h.95c.4-.01.74-.35.74-.76"}),"PasswordRounded");function Ue({open:c,setOpen:r}){const{id:w}=J(),b=K(),{schoolSessionDispatch:x}=j.useContext(X),C={id:w,password:"",confirmPassword:""},{mutateAsync:g,isLoading:i}=D({mutationFn:me}),e=(d,o)=>{delete d.confirmPassword,U.fire({title:"Updating Password",text:"Do you wish to proceed?",showCancelButton:!0,allowOutsideClick:!1}).then(({isConfirmed:n,isDenied:m,isDismissed:p})=>{n&&g(d,{onSuccess:h=>{b.invalidateQueries(["user",w]),x(A(h)),o.setSubmitting(!1),y(),x({type:"viewUser",payload:{open:!1,data:{}}})},onError:h=>{x(k(h))}}),p&&o.setSubmitting(!1)})},y=()=>r(!1);return a.jsxs(ne,{open:c,maxWidth:"xs",fullWidth:!0,children:[a.jsx(ie,{title:"Password Reset",onClose:y}),a.jsx(le,{initialValues:C,onSubmit:e,enableReinitialize:!0,validationSchema:re,children:({values:d,errors:o,touched:n,handleChange:m,handleSubmit:p})=>a.jsxs(a.Fragment,{children:[a.jsx(de,{children:a.jsxs(S,{padding:2,spacing:1,children:[a.jsx(G,{type:"password",label:"Password",fullWidth:!0,size:"small",autoComplete:"no",value:d.password,onChange:m("password"),error:!!(n.password&&o.password),helperText:n.password&&o.password}),a.jsx(G,{type:"password",label:"Confirm Password",fullWidth:!0,size:"small",value:d.confirmPassword,onChange:m("confirmPassword"),error:!!(n.confirmPassword&&o.confirmPassword),helperText:n.confirmPassword&&o.confirmPassword})]})}),a.jsx(ce,{children:a.jsx(xe,{loading:i,variant:"contained",color:"primary",onClick:p,startIcon:a.jsx(Z,{}),children:"Update Password"})})]})})]})}const ee=()=>{var I,B,E,M,R,F,Q,T,O,L,$,q,V,W,Y;const c=K(),{id:r}=J(),w=he(),[b,x]=j.useState(null),[C,g]=j.useState(null),{schoolSessionDispatch:i}=j.useContext(X),e=ue({queryKey:["user",r],queryFn:()=>fe(r),initialData:(I=c.getQueryData(["users"]))==null?void 0:I.find(t=>(t==null?void 0:t._id)===r)});j.useEffect(()=>{var t;x(`/images/users/${(t=e==null?void 0:e.data)==null?void 0:t.profile}`)},[e==null?void 0:e.data]);const y=()=>{w(`/users/${r}/edit`)},{mutateAsync:d}=D({mutationFn:ye}),o=()=>{var t,l;U.fire({title:(t=e==null?void 0:e.data)!=null&&t.active?"Do you want to disable this account?":"Do you want to enable this account?",text:(l=e==null?void 0:e.data)!=null&&l.active?"Disabling Account":"Enabling Account",showCancelButton:!0}).then(u=>{var N,z;if(u.isConfirmed){const se={id:(N=e==null?void 0:e.data)==null?void 0:N._id,active:(z=e==null?void 0:e.data)!=null&&z.active?0:1};d(se,{onSuccess:v=>{c.invalidateQueries(["users"]),c.invalidateQueries(["user",r]),i(A(v)),n()},onError:v=>{i(k(v))}})}})},n=()=>{i({type:"viewUser",payload:{open:!1,data:{}}})},{mutateAsync:m,isLoading:p}=D({mutationFn:be}),h=()=>{U.fire({title:"Deleting User",text:"Do you want to delete?",showCancelButton:!0}).then(t=>{var l;t.isConfirmed&&m((l=e==null?void 0:e.data)==null?void 0:l._id,{onSuccess:u=>{c.invalidateQueries(["users"]),i(A(u)),n()},onError:u=>{i(k(u))}})})},ae=()=>{g(!0)},te=()=>{var t,l;i({type:"sendQuickMessage",payload:{open:!0,data:{email:(t=e==null?void 0:e.data)==null?void 0:t.email,phonenumber:(l=e==null?void 0:e.data)==null?void 0:l.phonenumber}}})};return a.jsxs(a.Fragment,{children:[a.jsxs(a.Fragment,{children:[a.jsx(ve,{color:"#012e54"}),a.jsx(Pe,{title:"User Information",subtitle:"Track,manage and control courses assigned to you",color:"primary.main"}),a.jsxs(P,{children:[a.jsx(S,{width:"100%",justifyContent:"flex-end",alignItems:"flex-end",children:a.jsxs(De,{children:[a.jsx(f,{endIcon:a.jsx(Z,{}),onClick:ae,children:"Update Password"}),a.jsx(f,{endIcon:a.jsx(Se,{}),onClick:y,children:"Edit"})]})}),a.jsxs(P,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",paddingY:2,gap:4,children:[a.jsx(P,{sx:{p:1,border:"1px solid lightgray",borderRadius:"50%"},children:a.jsx(je,{srcSet:b,sx:{width:100,height:100}})}),a.jsx(f,{startIcon:a.jsx(Ce,{}),onClick:te,children:"Send Message"})]}),a.jsx(H,{flexItem:!0,children:a.jsx(_,{label:"Personal Information",color:"primary"})}),a.jsx(s,{label:"Name",text:`${(B=e==null?void 0:e.data)==null?void 0:B.fullname}`}),a.jsx(s,{label:"Username",text:`${(E=e==null?void 0:e.data)==null?void 0:E.username}`}),a.jsx(s,{label:"Role",text:(M=e==null?void 0:e.data)==null?void 0:M.role}),a.jsx(s,{label:"Date Of Birth",tex:!0,text:we(new Date((R=e==null?void 0:e.data)==null?void 0:R.dateofbirth)).format("Do MMMM, YYYY.")}),a.jsx(s,{label:"Gender",text:(F=e==null?void 0:e.data)==null?void 0:F.gender}),a.jsx(s,{label:"Email Address",text:(Q=e==null?void 0:e.data)==null?void 0:Q.email}),a.jsx(s,{label:"Telephone No.",text:(T=e==null?void 0:e.data)==null?void 0:T.phonenumber}),a.jsx(s,{label:"Address",text:(O=e==null?void 0:e.data)==null?void 0:O.address}),a.jsx(s,{label:"Residence",text:(L=e==null?void 0:e.data)==null?void 0:L.residence}),a.jsx(s,{label:"Nationality",text:($=e==null?void 0:e.data)==null?void 0:$.nationality}),a.jsx(H,{flexItem:!0,children:a.jsx(_,{label:"Account Status",color:"primary"})}),a.jsx(s,{label:"Account",text:(q=e==null?void 0:e.data)!=null&&q.active?"Active":"Disabled",valueStyle:{color:(V=e==null?void 0:e.data)!=null&&V.active?"green":"red"}}),a.jsxs(S,{direction:"row",spacing:2,flexWrap:"wrap",justifyContent:"flex-end",py:2,children:[a.jsx(f,{variant:"contained",color:(W=e==null?void 0:e.data)!=null&&W.active?"primary":"warning",onClick:o,children:(Y=e==null?void 0:e.data)!=null&&Y.active?"Disable Account":"Enable Account"}),a.jsx(f,{variant:"contained",color:"error",onClick:h,children:"Delete Account"})]})]})]}),a.jsx(Ue,{open:C,setOpen:g}),p&&a.jsx(ge,{value:"Removing user details"})]})};ee.propTypes={};const Qe=pe.memo(ee);export{Qe as default};
