import{Q as Pe,j as e,r as S,U as it,S as je,g as Te,a2 as ue,bt as jt,i as Ie,z as bt,l as we,m as P,n as R,T as g,t as rt,B as G,ap as $,F as be,bu as St,v as Y,q as w,b9 as B,aZ as Tt,aK as X,ba as ge,bb as Ce,bv as Ct,X as U,bw as tt,bx as Pt,aF as It,aG as wt,u as st,h as ot,C as lt,a1 as pt,$ as zt,a0 as vt,_ as fe,a as b,b2 as Wt,w as dt,x as mt,f as ct,by as yt,bz as At,bA as Dt,bB as Nt,ab as Bt,bC as Lt,Z as Rt,aW as Ft,G as kt,aU as Ot,bD as Et,as as Mt,aD as Vt,bE as _t,bF as qt,a4 as Gt,bG as Ht,bH as Ut,J as $t,M as Yt,N as nt,A as Kt}from"./index-e0c0d8c9.js";import{g as Qt}from"./termAPI-d812cd0b.js";import{a as Xt,p as Jt,b as Zt}from"./studentAPI-fc20c9bb.js";import{M as K}from"./MedicalAllergy-c598e69c.js";import{A as en}from"./ArrowForwardRounded-290a0ee6.js";import{S as tn}from"./School-d12f3e03.js";import{N as nn}from"./NoteRounded-237415b8.js";import{A as an}from"./AnimatedContainer-504714af.js";import{I as rn}from"./studentColumns-9e760bc6.js";const sn=Pe(e.jsx("path",{d:"M20 21v-3h3v-2h-3v-3h-2v3h-3v2h3v3zm-4.97.5H5.66c-.72 0-1.38-.38-1.73-1l-2.36-4.1c-.36-.62-.35-1.38.01-2L7.92 3.49c.36-.61 1.02-.99 1.73-.99h4.7c.71 0 1.37.38 1.73.99l4.48 7.71c-.5-.13-1.02-.2-1.56-.2-.28 0-.56.02-.84.06L14.35 4.5h-4.7L3.31 15.41l2.35 4.09h7.89c.35.77.85 1.45 1.48 2M13.34 15c-.22.63-.34 1.3-.34 2H7.25l-.73-1.27 4.58-7.98h1.8l2.53 4.42c-.56.42-1.05.93-1.44 1.51l-2-3.49L9.25 15z"}),"AddToDrive"),ze=Pe(e.jsx("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward"),on=Pe(e.jsx("path",{d:"M9 16.17 5.53 12.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0z"}),"CheckRounded");function ln({open:m,setOpen:l}){const{userState:{session:f}}=S.useContext(it),{schoolSessionDispatch:I}=S.useContext(je),[t,n]=S.useState({_id:"",levelType:"",students:[]}),[i,o]=S.useState({termId:"",sessionId:"",label:""}),a=Te({queryKey:["terms"],queryFn:()=>Qt(),enabled:!!(f!=null&&f.sessionId),select:r=>r.filter(({to:c})=>ue(new Date(f.to))>ue(new Date(c))).map(({termId:c,sessionId:d,academicYear:y,term:j})=>({termId:c,sessionId:d,label:`${y},${j}`}))}),p=Te({queryKey:["previous-levels",i==null?void 0:i.termId],queryFn:()=>jt(i),enabled:!!(i!=null&&i.termId),select:r=>r.map(({_id:u,level:c,students:d})=>({_id:u,levelType:`${c.name}${c.type}`,students:d}))}),s=()=>{var r;((r=t==null?void 0:t.students)==null?void 0:r.length)!==0&&I({type:"openAddStudentFileDialog",payload:{data:t==null?void 0:t.students,type:"previous"}})};return e.jsxs(Ie,{open:m,maxWidth:"xs",fullWidth:!0,children:[e.jsx(bt,{children:" Students from Session"}),e.jsx(we,{children:e.jsxs(P,{spacing:2,paddingY:2,children:[e.jsx(R,{size:"small",options:a.data??[],noOptionsText:"No session available",disableClearable:!0,fullWidth:!0,value:i,onChange:(r,u)=>{n({_id:"",levelType:"",students:[]}),o(u)},isOptionEqualToValue:(r,u)=>r.termId===u.termId||u.termId===""||u.termId===null||u.termId===void 0,getOptionLabel:r=>r.label||"",renderInput:r=>e.jsx(g,{...r,label:"Select School Session"})}),e.jsx(R,{size:"small",options:(p==null?void 0:p.data)??[],noOptionsText:"No level available",disableClearable:!0,fullWidth:!0,value:t,onChange:(r,u)=>n(u),isOptionEqualToValue:(r,u)=>r._id===u._id||u._id===""||u._id===null||u._id===void 0,getOptionLabel:r=>r.levelType||"",renderInput:r=>e.jsx(g,{...r,label:"Select Level"})})]})}),e.jsxs(rt,{children:[e.jsx(G,{onClick:()=>l(!1),children:"Cancel"}),e.jsx(G,{variant:"contained",onClick:s,disabled:!(t!=null&&t._id),children:"Load Students"})]})]})}const xt=({setMode:m})=>{const{studentState:{newStudent:{personal:l}},studentDispatch:f}=S.useContext($),[I,t]=S.useState(""),[n,i]=S.useState(ue(l==null?void 0:l.dateofbirth)),o=Te({queryKey:["student-exist",I],queryFn:()=>Xt(I),enabled:!!I,refetchOnMount:!0,refetchOnWindowFocus:!0}),a=(p,s)=>{p.dateofbirth=ue(n).format("L"),f({type:"addNewStudent",payload:{personal:{...p,isCompleted:!0}}}),s.setSubmitting(!1),m("photo-info")};return e.jsx(be,{initialValues:l,onSubmit:a,enableReinitialize:!0,validationSchema:St,children:({values:p,errors:s,touched:r,setFieldValue:u,handleChange:c,handleSubmit:d,isSubmitting:y})=>e.jsxs(P,{py:2,spacing:2,children:[e.jsx(P,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(Y,{loading:y,variant:"contained",color:"primary",onClick:d,endIcon:e.jsx(ze,{}),disabled:o==null?void 0:o.isError,children:"Continue"})}),e.jsx(w,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Personal Details"}),e.jsx(g,{label:"Student ID",type:"text",sx:{maxWidth:300},size:"small",value:p.indexnumber,onChange:j=>{u("indexnumber",j.target.value),t(j.target.value)},error:o.isError||!!(r!=null&&r.indexnumber&&(s!=null&&s.indexnumber)),helperText:(o==null?void 0:o.error)||(r==null?void 0:r.indexnumber)&&(s==null?void 0:s.indexnumber)}),e.jsxs(B,{children:[e.jsx(g,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:p.firstname,onChange:c("firstname"),error:!!(r.firstname&&s.firstname),helperText:r.firstname&&s.firstname}),e.jsx(g,{label:"Surname",fullWidth:!0,size:"small",value:p.surname,onChange:c("surname"),error:!!(r.surname&&s.surname),helperText:r.surname&&s.surname}),e.jsx(g,{label:"Othername",fullWidth:!0,size:"small",value:p.othername,onChange:c("othername"),error:!!(r.othername&&s.othername),helperText:r.othername&&s.othername})]}),e.jsxs(B,{children:[e.jsx(Tt,{label:"Date of Birth",date:n,setDate:i,disableFuture:!0,error:!!(r.dateofbirth&&s.dateofbirth),helperText:r.dateofbirth&&s.dateofbirth}),e.jsxs(g,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:p.gender,onChange:c("gender"),error:!!(r.gender&&s.gender),helperText:r.gender&&s.gender,children:[e.jsx(X,{value:"male",children:"Male"}),e.jsx(X,{value:"female",children:"Female"})]})]}),e.jsxs(B,{children:[e.jsx(g,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:p.email,onChange:c("email"),error:!!(r.email&&s.email),helperText:r.email&&s.email}),e.jsx(g,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:p.phonenumber,onChange:c("phonenumber"),error:!!(r.phonenumber&&s.phonenumber),helperText:r.phonenumber&&s.phonenumber})]}),e.jsx(g,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,value:p.address,onChange:c("address"),error:!!(r.address&&s.address),helperText:r.address&&s.address}),e.jsxs(B,{children:[e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",options:ge,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:j=>j||"",value:p.residence,onChange:(j,v)=>u("residence",v),renderInput:j=>e.jsx(g,{...j,label:"Residence",fullWidth:!0,size:"small",error:!!(r.residence&&s.residence),helperText:r.residence&&s.residence})}),e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:Ce,noOptionsText:"No Nationality available",getOptionLabel:j=>j||"",value:p.nationality,onChange:(j,v)=>u("nationality",v),renderInput:j=>e.jsx(g,{...j,label:"Nationality",fullWidth:!0,size:"small",error:!!(r.nationality&&s.nationality),helperText:r.nationality&&s.nationality})})]})]})})};xt.propTypes={};const pn=({setMode:m})=>{const{studentState:{newStudent:{parent:l}},studentDispatch:f}=S.useContext($),I=(t,n)=>{f({type:"addNewStudent",payload:{parent:{...t,isCompleted:!0}}}),n.setSubmitting(!1),m("medical-info")};return e.jsx(be,{initialValues:l,onSubmit:I,enableReinitialize:!0,validationSchema:Ct,children:({values:t,errors:n,touched:i,setFieldValue:o,handleChange:a,handleSubmit:p,isSubmitting:s})=>{var r,u,c,d,y,j,v,M,_,V,x,h,L,F,q,W,z,k,O,E,J,Z,ee,te,ne,ae,ie,re,se,oe,le,pe,de,me,ce,ye,xe,Se,H,ve,We,Ae,De,Ne,Be,Le,Re,Fe,ke,Oe,Ee,Me,Ve,_e,qe,Ge,He,Ue,$e,Ye,Ke,Qe,Xe,Je,Ze,et;return e.jsxs(P,{py:2,spacing:1,children:[e.jsxs("div",{style:{maxHeight:350,overflowY:"auto"},children:[e.jsxs(P,{py:2,spacing:1,children:[e.jsxs(P,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:[e.jsx(w,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Parent/Guardian Information"}),e.jsx(U,{sx:{width:30,height:30,bgcolor:"primary.main"},children:"1"})]}),e.jsxs(B,{children:[e.jsx(g,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:(r=t==null?void 0:t.parent1)==null?void 0:r.firstname,onChange:a("parent1.firstname"),error:!!((u=i.parent1)!=null&&u.firstname&&((c=n.parent1)!=null&&c.firstname)),helperText:((d=i.parent1)==null?void 0:d.firstname)&&((y=n.parent1)==null?void 0:y.firstname)}),e.jsx(g,{label:"Surname",fullWidth:!0,size:"small",value:(j=t==null?void 0:t.parent1)==null?void 0:j.surname,onChange:a("parent1.surname"),error:!!((v=i.parent1)!=null&&v.surname&&((M=n.parent1)!=null&&M.surname)),helperText:((_=i.parent1)==null?void 0:_.surname)&&((V=n.parent1)==null?void 0:V.surname)})]}),e.jsxs(B,{children:[e.jsxs(g,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:(x=t==null?void 0:t.parent1)==null?void 0:x.gender,onChange:a("parent1.gender"),error:!!((h=i.parent1)!=null&&h.gender&&((L=n.parent1)!=null&&L.gender)),helperText:((F=i.parent1)==null?void 0:F.gender)&&((q=n.parent1)==null?void 0:q.gender),children:[e.jsx(X,{value:"male",children:"Male"}),e.jsx(X,{value:"female",children:"Female"})]}),e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",options:tt,loadingText:"Please wait....",noOptionsText:"No Relationship available",getOptionLabel:T=>T||"",value:(W=t==null?void 0:t.parent1)==null?void 0:W.relationship,onInputChange:(T,C)=>o("parent1.relationship",C),renderInput:T=>{var C,A,D,N;return e.jsx(g,{...T,label:"Relationship",fullWidth:!0,size:"small",error:!!((C=i.parent1)!=null&&C.relationship&&((A=n.parent1)!=null&&A.relationship)),helperText:((D=i.parent1)==null?void 0:D.relationship)&&((N=n.parent1)==null?void 0:N.relationship)})}})]}),e.jsxs(B,{children:[e.jsx(g,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:(z=t==null?void 0:t.parent1)==null?void 0:z.email,onChange:a("parent1.email"),error:!!((k=i.parent1)!=null&&k.email&&((O=n.parent1)!=null&&O.email)),helperText:((E=i.parent1)==null?void 0:E.email)&&((J=n.parent1)==null?void 0:J.email)}),e.jsx(g,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(Z=t==null?void 0:t.parent1)==null?void 0:Z.phonenumber,onChange:a("parent1.phonenumber"),error:!!((ee=i.parent1)!=null&&ee.phonenumber&&((te=n.parent1)!=null&&te.phonenumber)),helperText:((ne=i.parent1)==null?void 0:ne.phonenumber)&&((ae=n.parent1)==null?void 0:ae.phonenumber)})]}),e.jsx(g,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,multiline:!0,value:(ie=t==null?void 0:t.parent1)==null?void 0:ie.address,onChange:a("parent1.address"),error:!!((re=i.parent1)!=null&&re.address&&((se=n.parent1)!=null&&se.address)),helperText:((oe=i.parent1)==null?void 0:oe.address)&&((le=n.parent1)==null?void 0:le.address)}),e.jsxs(B,{children:[e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",options:ge,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:T=>T||"",value:(pe=t==null?void 0:t.parent1)==null?void 0:pe.residence,onChange:(T,C)=>o("parent1.residence",C),renderInput:T=>{var C,A,D,N;return e.jsx(g,{...T,label:"Residence",fullWidth:!0,size:"small",error:!!((C=i.parent1)!=null&&C.residence&&((A=n.parent1)!=null&&A.residence)),helperText:((D=i.parent1)==null?void 0:D.residence)&&((N=n.parent1)==null?void 0:N.residence)})}}),e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:Ce,noOptionsText:"No Nationality available",getOptionLabel:T=>T||"",value:(de=t==null?void 0:t.parent1)==null?void 0:de.nationality,onChange:(T,C)=>o("parent1.nationality",C),renderInput:T=>{var C,A,D,N;return e.jsx(g,{...T,label:"Nationality",fullWidth:!0,size:"small",error:!!((C=i.parent1)!=null&&C.nationality&&((A=n.parent1)!=null&&A.nationality)),helperText:((D=i.parent1)==null?void 0:D.nationality)&&((N=n.parent1)==null?void 0:N.nationality)})}})]})]}),e.jsxs(P,{py:2,spacing:1,children:[e.jsxs(P,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:[e.jsx(w,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Parent/Guardian Information"}),e.jsx(U,{sx:{width:30,height:30,bgcolor:"primary.main"},children:"2"})]}),e.jsxs(B,{children:[e.jsx(g,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:(me=t==null?void 0:t.parent2)==null?void 0:me.firstname,onChange:a("parent2.firstname"),error:!!((ce=i.parent2)!=null&&ce.firstname&&((ye=n.parent2)!=null&&ye.firstname)),helperText:((xe=i.parent2)==null?void 0:xe.firstname)&&((Se=n.parent2)==null?void 0:Se.firstname)}),e.jsx(g,{label:"Surname",fullWidth:!0,size:"small",value:(H=t==null?void 0:t.parent2)==null?void 0:H.surname,onChange:a("parent2.surname"),error:!!((ve=i.parent2)!=null&&ve.surname&&((We=n.parent2)!=null&&We.surname)),helperText:((Ae=i.parent2)==null?void 0:Ae.surname)&&((De=n.parent2)==null?void 0:De.surname)})]}),e.jsxs(B,{children:[e.jsxs(g,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:(Ne=t==null?void 0:t.parent2)==null?void 0:Ne.gender,onChange:a("parent2.gender"),error:!!((Be=i.parent2)!=null&&Be.gender&&((Le=n.parent2)!=null&&Le.gender)),helperText:((Re=i.parent2)==null?void 0:Re.gender)&&((Fe=n.parent2)==null?void 0:Fe.gender),children:[e.jsx(X,{value:"male",children:"Male"}),e.jsx(X,{value:"female",children:"Female"})]}),e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",options:tt,loadingText:"Please wait....",noOptionsText:"No Relationship available",getOptionLabel:T=>T||"",value:(ke=t==null?void 0:t.parent2)==null?void 0:ke.relationship,onInputChange:(T,C)=>o("parent2.relationship",C),renderInput:T=>{var C,A,D,N;return e.jsx(g,{...T,label:"Relationship",fullWidth:!0,size:"small",error:!!((C=i.parent2)!=null&&C.relationship&&((A=n.parent2)!=null&&A.relationship)),helperText:((D=i.parent2)==null?void 0:D.relationship)&&((N=n.parent2)==null?void 0:N.relationship)})}})]}),e.jsxs(B,{children:[e.jsx(g,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:(Oe=t==null?void 0:t.parent2)==null?void 0:Oe.email,onChange:a("parent2.email"),error:!!((Ee=i.parent2)!=null&&Ee.email&&((Me=n.parent2)!=null&&Me.email)),helperText:((Ve=i.parent2)==null?void 0:Ve.email)&&((_e=n.parent2)==null?void 0:_e.email)}),e.jsx(g,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(qe=t==null?void 0:t.parent2)==null?void 0:qe.phonenumber,onChange:a("parent2.phonenumber"),error:!!((Ge=i.parent2)!=null&&Ge.phonenumber&&((He=n.parent2)!=null&&He.phonenumber)),helperText:((Ue=i.parent2)==null?void 0:Ue.phonenumber)&&(($e=n.parent2)==null?void 0:$e.phonenumber)})]}),e.jsx(g,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,multiline:!0,value:(Ye=t==null?void 0:t.parent2)==null?void 0:Ye.address,onChange:a("parent2.address"),error:!!((Ke=i.parent2)!=null&&Ke.address&&((Qe=n.parent2)!=null&&Qe.address)),helperText:((Xe=i.parent2)==null?void 0:Xe.address)&&((Je=n.parent2)==null?void 0:Je.address)}),e.jsxs(B,{children:[e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",options:ge,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:T=>T||"",value:(Ze=t==null?void 0:t.parent2)==null?void 0:Ze.residence,onChange:(T,C)=>o("parent2.residence",C),renderInput:T=>{var C,A,D,N;return e.jsx(g,{...T,label:"Residence",fullWidth:!0,size:"small",error:!!((C=i.parent2)!=null&&C.residence&&((A=n.parent2)!=null&&A.residence)),helperText:((D=i.parent2)==null?void 0:D.residence)&&((N=n.parent2)==null?void 0:N.residence)})}}),e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:Ce,noOptionsText:"No Nationality available",getOptionLabel:T=>T||"",value:(et=t==null?void 0:t.parent2)==null?void 0:et.nationality,onChange:(T,C)=>o("parent2.nationality",C),renderInput:T=>{var C,A,D,N;return e.jsx(g,{...T,label:"Nationality",fullWidth:!0,size:"small",error:!!((C=i.parent2)!=null&&C.nationality&&((A=n.parent2)!=null&&A.nationality)),helperText:((D=i.parent2)==null?void 0:D.nationality)&&((N=n.parent2)==null?void 0:N.nationality)})}})]})]})]}),e.jsx(P,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(Y,{loading:s,variant:"contained",color:"primary",onClick:p,children:"Save & Continue"})})]})}})},ht=({setMode:m})=>{const{studentState:{newStudent:{medical:l}},studentDispatch:f}=S.useContext($),I=(t,n)=>{f({type:"addNewStudent",payload:{medical:{...t,isCompleted:!0}}}),n.setSubmitting(!1),m("academic-info")};return e.jsx(be,{initialValues:l,onSubmit:I,enableReinitialize:!0,validationSchema:Pt,children:({values:t,errors:n,touched:i,handleChange:o,handleSubmit:a,isSubmitting:p})=>{var s,r,u,c,d,y,j,v,M,_,V,x,h,L,F;return e.jsxs(P,{padding:2,spacing:1,children:[e.jsx(P,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(Y,{loading:p,variant:"contained",color:"primary",onClick:a,endIcon:e.jsx(ze,{}),children:"Continue"})}),e.jsx(w,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Medical Records"}),e.jsx(w,{variant:"body2",color:"primary.main",children:"(Kindly note that this section, even though required, will not affect your child’s admission into the school)."}),e.jsxs(P,{width:{xs:"100%",md:"80%"},py:5,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(K,{title:"1. Heart Disease",value:t.heartDisease,setValue:o("heartDisease")}),e.jsx(K,{title:"2. Visual Impairment",value:t.visualImpairment,setValue:o("visualImpairment")})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(K,{title:"3. Asthma",value:t.asthma,setValue:o("asthma")}),e.jsx(K,{title:"4. Hearing Impairment",value:t.hearingImpairment,setValue:o("hearingImpairment")})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(K,{title:"5. Siezures",value:t.siezures,setValue:o("siezures")}),e.jsx(K,{title:"6. Physical Disability",value:t.physicalDisability,setValue:o("physicalDisability")})]})]}),e.jsxs(P,{py:2,spacing:1,children:[e.jsx(w,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Emergency Contact"}),e.jsxs(B,{children:[e.jsx(g,{label:"Fullname",type:"text",fullWidth:!0,size:"small",value:(s=t==null?void 0:t.emergencyContact)==null?void 0:s.fullname,onChange:o("emergencyContact.fullname"),error:!!((r=i==null?void 0:i.emergencyContact)!=null&&r.fullname&&((u=n==null?void 0:n.emergencyContact)!=null&&u.fullname)),helperText:((c=i==null?void 0:i.emergencyContact)==null?void 0:c.fullname)&&((d=n==null?void 0:n.emergencyContact)==null?void 0:d.fullname)}),e.jsx(g,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(y=t==null?void 0:t.emergencyContact)==null?void 0:y.phonenumber,onChange:o("emergencyContact.phonenumber"),error:!!((j=i==null?void 0:i.emergencyContact)!=null&&j.phonenumber&&((v=n==null?void 0:n.emergencyContact)!=null&&v.phonenumber)),helperText:((M=i==null?void 0:i.emergencyContact)==null?void 0:M.phonenumber)&&((_=n==null?void 0:n.emergencyContact)==null?void 0:_.phonenumber)})]}),e.jsx(B,{children:e.jsx(g,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,value:(V=t==null?void 0:t.emergencyContact)==null?void 0:V.address,onChange:o("emergencyContact.address"),error:!!((x=i==null?void 0:i.emergencyContact)!=null&&x.address&&((h=n==null?void 0:n.emergencyContact)!=null&&h.address)),helperText:((L=i==null?void 0:i.emergencyContact)==null?void 0:L.address)&&((F=n==null?void 0:n.emergencyContact)==null?void 0:F.address)})})]})]})}})};ht.propTypes={};function Q({title:m,value:l}){return e.jsxs(P,{direction:"row",justifyContent:"space-between",alignItems:"center",spacing:3,pr:6,children:[e.jsx(w,{textAlign:"right",fontSize:11,children:m}),e.jsx(It,{sx:{fontSize:11},value:l,control:e.jsx(wt,{size:"small",checked:!0}),label:l,slotProps:{typography:{sx:{fontSize:11}}}})]})}function dn({open:m,setOpen:l,setMode:f}){var F,q,W,z,k,O,E,J,Z,ee,te,ne,ae,ie,re,se,oe,le,pe,de,me,ce,ye,xe;const I=st(),t=JSON.parse(localStorage.getItem("@school_info")),{studentState:{newStudent:{personal:n,photo:i,medical:o,parent:a,academic:p},studentDispatch:s}}=S.useContext($),{schoolSessionDispatch:r}=S.useContext(je),u=S.useRef(),[c,d]=S.useState(""),[y,j]=S.useState(!1),{mutateAsync:v,isLoading:M}=ot({mutationFn:Jt}),_=()=>{n.profile=i==null?void 0:i.profile,v({personal:n,medical:o,parent:a,academic:p},{onSettled:()=>{I.invalidateQueries(["students-by-current-level"]),I.invalidateQueries(["all-students"])},onSuccess:H=>{H&&(r(dt("New Student Added")),j(!0),d(H),localStorage.removeItem("@student"))},onError:H=>{r(mt(H))}})},V=()=>{c?(f("personal-info"),l(!1),s({type:"addNewStudent",payload:{}})):l(!1)},x={fontSize:12,color:"primary",fontWeight:"700"},h={fontSize:10},L={width:"100%",borderBottom:"1px solid black",backgroundColor:"black",color:"#fff",padding:"2px"};return e.jsxs(Ie,{open:m,fullWidth:!0,maxWidth:"lg",onClose:()=>l(!1),children:[e.jsx(lt,{title:"Admission Form",subtitle:"Preview of student information. Please check before saving your information.",onClose:V}),e.jsxs(pt,{display:"flex",gap:2,justifyContent:"center",alignItems:"center",pt:2,children:[e.jsx(zt,{trigger:()=>e.jsx(G,{variant:"outlined",children:"Print Form"}),content:()=>u.current,documentTitle:"Admission"}),e.jsx(Y,{loading:M,variant:"contained",color:"primary",onClick:_,children:"Save Student Data"})]}),e.jsx(we,{children:e.jsxs("div",{ref:u,children:[e.jsxs(P,{justifyContent:"center",alignItems:"center",sx:{maxWidth:"8.5in",minHeight:"11in",margin:"auto",padding:"16px",border:"1px solid lightgray",position:"relative",backgroundSize:"contain",backgroundPosition:"center center !important"},children:[e.jsx(w,{variant:"body1",sx:{justifySelf:"start",py:4},children:"Admission Form"}),t!=null&&t.badge?e.jsx(U,{alt:"school logo",loading:"lazy",srcSet:`/images/users/${t==null?void 0:t.badge}`,sx:{width:100,height:100}}):e.jsx(vt,{sx:{width:100,height:100}}),e.jsxs(P,{justifyContent:"center",alignItems:"center",width:"100%",children:[e.jsx(w,{variant:"h4",children:fe.startCase(t==null?void 0:t.name)}),e.jsx(w,{variant:"caption",children:t==null?void 0:t.address}),e.jsx(w,{variant:"caption",children:t==null?void 0:t.location}),e.jsx(w,{variant:"caption",fontStyle:"italic",children:t==null?void 0:t.motto})]}),e.jsx(w,{variant:"h3",textTransform:"uppercase",my:2,children:`${n==null?void 0:n.surname} ${n==null?void 0:n.firstname} ${n==null?void 0:n.othername}`})]}),e.jsxs(P,{className:"admission-form",spacing:1,sx:{maxWidth:"8.5in",minHeight:"11in",margin:"auto",padding:"16px",border:"1px solid lightgray",position:"relative",backgroundSize:"contain",backgroundPosition:"center center !important"},children:[c&&e.jsx("small",{style:{position:"absolute",bottom:"0",right:0,paddingRight:"8px",paddingBottom:"8px"},children:c}),e.jsx("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:e.jsx(U,{variant:"square",src:i==null?void 0:i.profile,sx:{alignSelf:"center",width:80,height:80}})}),e.jsxs("div",{style:{paddingBottom:"8px"},children:[e.jsx("legend",{style:L,children:"Personal Data"}),e.jsx(b,{secondary:"Student ID",primary:n==null?void 0:n.indexnumber,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(b,{secondary:"Full Name",primary:`${n==null?void 0:n.surname} ${n==null?void 0:n.firstname} ${n==null?void 0:n.othername}`,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Date of Birth",primary:ue(new Date(n==null?void 0:n.dateofbirth)).format("LL"),primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Gender",primary:n==null?void 0:n.gender,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Email Address",primary:n==null?void 0:n.email,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Phone Number",primary:n==null?void 0:n.phonenumber,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Residence",primary:n==null?void 0:n.residence,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Nationality",primary:n==null?void 0:n.nationality,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Address",primary:n==null?void 0:n.address,primaryTypographyProps:x,secondaryTypographyProps:h})]})]}),e.jsxs("div",{style:{paddingBottom:"8px"},children:[e.jsx("legend",{style:L,children:"Parent/Guardian Information"}),e.jsxs(P,{children:[e.jsx(w,{color:"primary.main",sx:{fontWeight:"bold",fontSize:11},children:"Parent 1 / Guardian 1"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(b,{secondary:"Surname",primary:(F=a==null?void 0:a.parent1)==null?void 0:F.surname,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"First Name",primary:(q=a==null?void 0:a.parent1)==null?void 0:q.firstname,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Relationship",primary:(W=a==null?void 0:a.parent1)==null?void 0:W.relationship,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Gender",primary:(z=a==null?void 0:a.parent1)==null?void 0:z.gender,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Email Address",primary:(k=a==null?void 0:a.parent1)==null?void 0:k.email,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Phone Number",primary:(O=a==null?void 0:a.parent1)==null?void 0:O.phonenumber,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Residence",primary:(E=a==null?void 0:a.parent1)==null?void 0:E.residence,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Nationality",primary:(J=a==null?void 0:a.parent1)==null?void 0:J.nationality,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Address",primary:(Z=a==null?void 0:a.parent1)==null?void 0:Z.address,primaryTypographyProps:x,secondaryTypographyProps:h})]})]}),e.jsxs(P,{children:[e.jsx(w,{color:"primary.main",sx:{fontWeight:"bold",fontSize:11},children:"Parent 2 / Guardian 2"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(b,{secondary:"Surname",primary:(ee=a==null?void 0:a.parent2)==null?void 0:ee.surname,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"First Name",primary:(te=a==null?void 0:a.parent2)==null?void 0:te.firstname,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Relationship",primary:(ne=a==null?void 0:a.parent2)==null?void 0:ne.relationship,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Gender",primary:(ae=a==null?void 0:a.parent2)==null?void 0:ae.gender,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Email Address",primary:(ie=a==null?void 0:a.parent2)==null?void 0:ie.email,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Phone Number",primary:(re=a==null?void 0:a.parent2)==null?void 0:re.phonenumber,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Residence",primary:(se=a==null?void 0:a.parent2)==null?void 0:se.residence,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Nationality",primary:(oe=a==null?void 0:a.parent2)==null?void 0:oe.nationality,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Address",primary:(le=a==null?void 0:a.parent2)==null?void 0:le.address,primaryTypographyProps:x,secondaryTypographyProps:h})]})]})]}),e.jsxs("div",{style:{paddingBottom:"8px"},children:[e.jsx("legend",{style:L,children:"Medical Records"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(Q,{title:"1. Heart Disease",value:o.heartDisease}),e.jsx(Q,{title:"2. Asthma",value:o.asthma}),e.jsx(Q,{title:"3. Siezures",value:o.siezures}),e.jsx(Q,{title:"4. Visual Impairment",value:o.visualImpairment}),e.jsx(Q,{title:"5. Hearing Impairment",value:o.hearingImpairment}),e.jsx(Q,{title:"6. Physical Disability",value:o.physicalDisability})]}),e.jsx(w,{color:"primary.main",sx:{fontWeight:"bold",fontSize:11},children:"Emergency Contact"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(b,{secondary:"Fullname",primary:(pe=o==null?void 0:o.emergencyContact)==null?void 0:pe.fullname,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Phone Number",primary:(de=o==null?void 0:o.emergencyContact)==null?void 0:de.phonenumber,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Address",primary:(me=o==null?void 0:o.emergencyContact)==null?void 0:me.address,primaryTypographyProps:x,secondaryTypographyProps:h})]})]}),e.jsxs("div",{style:{paddingBottom:"8px"},children:[e.jsx("legend",{style:L,children:"Academic Records"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(b,{secondary:"Current Level",primary:(ce=p==null?void 0:p.level)==null?void 0:ce.type,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Previous School Name",primary:(ye=p==null?void 0:p.previousSchool)==null?void 0:ye.name,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Location",primary:(xe=p==null?void 0:p.previousSchool)==null?void 0:xe.location,primaryTypographyProps:x,secondaryTypographyProps:h})]})]})]})]})}),M&&e.jsx(Wt,{})]})}const ut=({setMode:m})=>{var u;const{studentState:{newStudent:{academic:l}},studentDispatch:f}=S.useContext($),[I,t]=S.useState(!1),[n,i]=S.useState((u=l==null?void 0:l.previousSchool)==null?void 0:u.report),{levelsOption:o}=ct(),{getRootProps:a,getInputProps:p,open:s}=yt({noClick:!0,noKeyboard:!0,maxFiles:1,accept:{"image/*":[".jpeg",".png",".webp"],"application/pdf":[".pdf"]},multiple:!1,onDrop:c=>{if(!fe.isEmpty(c)){const d=new FileReader;d.onload=function(y){const j=y.target.result;i(j)},d.readAsDataURL(c[0])}}}),r=(c,d)=>{c.previousSchool.report=n,f({type:"addNewStudent",payload:{academic:{...c,isCompleted:!0}}}),d.setSubmitting(!1),t(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(be,{initialValues:l,onSubmit:r,enableReinitialize:!0,validationSchema:At,children:({values:c,errors:d,touched:y,setFieldValue:j,handleChange:v,handleSubmit:M,isSubmitting:_})=>{var V,x,h,L,F,q;return e.jsxs(P,{py:2,spacing:1,children:[e.jsx(P,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(Y,{loading:_,variant:"contained",color:"primary",onClick:M,endIcon:e.jsx(ze,{}),children:"Continue"})}),e.jsx(w,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Academic Records"}),e.jsx(B,{children:e.jsx(R,{fullWidth:!0,size:"small",options:o,noOptionsText:"No Level available",getOptionLabel:W=>W.type||"",isOptionEqualToValue:(W,z)=>z._id===void 0||z._id===""||z._id===W._id,value:c.level,onChange:(W,z)=>j("level",z),renderInput:W=>{var z,k,O,E;return e.jsx(g,{...W,label:"Current Level",fullWidth:!0,size:"small",error:!!((z=y==null?void 0:y.level)!=null&&z.type&&((k=d==null?void 0:d.level)!=null&&k.type)),helperText:((O=y==null?void 0:y.level)==null?void 0:O.type)&&((E=d==null?void 0:d.level)==null?void 0:E.type)})}})}),e.jsx(w,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Previous School Records"}),e.jsxs(B,{children:[e.jsx(g,{label:"School Name",type:"text",fullWidth:!0,size:"small",value:(V=c==null?void 0:c.previousSchool)==null?void 0:V.name,onChange:v("previousSchool.name"),error:!!((x=y==null?void 0:y.previousSchool)!=null&&x.name&&((h=d==null?void 0:d.previousSchool)!=null&&h.name)),helperText:((L=y==null?void 0:y.previousSchool)==null?void 0:L.name)&&((F=d==null?void 0:d.previousSchool)==null?void 0:F.name)}),e.jsx(R,{freeSolo:!0,fullWidth:!0,size:"small",options:ge,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:W=>W||"",value:(q=c==null?void 0:c.previousSchool)==null?void 0:q.location,onInputChange:(W,z)=>j("previousSchool.location",z),renderInput:W=>{var z,k,O,E;return e.jsx(g,{...W,label:"Location",fullWidth:!0,size:"small",error:!!((z=y==null?void 0:y.previousSchool)!=null&&z.location&&((k=d==null?void 0:d.previousSchool)!=null&&k.location)),helperText:((O=y==null?void 0:y.previousSchool)==null?void 0:O.location)&&((E=d==null?void 0:d.previousSchool)==null?void 0:E.location)})}})]}),e.jsx(w,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"A copy of the most recent school report"}),e.jsx(P,{padding:2,spacing:1,...a({className:"dropzone"}),style:{border:"1px dashed black"},children:e.jsxs(P,{spacing:2,justifyContent:"center",alignItems:"center",paddingY:1,children:[e.jsx(U,{variant:"square",src:n,sx:{width:120,height:120},children:e.jsx(Dt,{})}),e.jsxs(P,{children:[e.jsx("input",{...p()}),e.jsx(w,{textAlign:"center",paragraph:!0,children:"Drag & drop your report here"}),e.jsx(G,{variant:"outlined",onClick:s,startIcon:e.jsx(sn,{}),children:"Upload Report"})]}),!fe.isEmpty(n)&&e.jsx("iframe",{style:{width:"100%",height:"5in"},src:n})]})})]})}}),e.jsx(dn,{open:I,setOpen:t,setMode:m})]})};ut.propTypes={};const gt=({setMode:m})=>{const{studentState:{newStudent:{photo:l}},studentDispatch:f}=S.useContext($),[I,t]=S.useState(l==null?void 0:l.profile),{getRootProps:n,getInputProps:i,open:o}=yt({noClick:!0,noKeyboard:!0,maxFiles:1,accept:{"image/*":[".jpeg",".png"]},maxSize:2e5,multiple:!1,onDrop:p=>{if(!fe.isEmpty(p)){const s=new FileReader;s.onload=function(r){const u=r.target.result;t(u)},s.readAsDataURL(p[0])}}});S.useEffect(()=>{var s;const p=JSON.parse(localStorage.getItem("@student"));if(p){t((s=p==null?void 0:p.photo)==null?void 0:s.profile);return}},[]);const a=()=>{f({type:"addNewStudent",payload:{photo:{profile:I,isCompleted:!0}}}),m("parent-info")};return e.jsxs(P,{padding:2,spacing:1,...n({className:"dropzone"}),style:{border:"1px dashed black"},children:[e.jsx(P,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(Y,{variant:"contained",onClick:a,endIcon:e.jsx(en,{}),children:"Continue"})}),e.jsx(w,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Upload Photo"}),e.jsxs(P,{spacing:2,justifyContent:"center",alignItems:"center",paddingY:1,children:[e.jsx(U,{variant:"square",src:I,sx:{width:120,height:120}}),e.jsxs(P,{children:[e.jsx("input",{...i()}),e.jsx(w,{textAlign:"center",paragraph:!0,children:"Drag & drop your photo here"}),e.jsx(G,{variant:"outlined",onClick:o,startIcon:e.jsx(Nt,{}),children:"Upload Image"})]})]})]})};gt.propTypes={};function he({initValue:m,title:l,isCompleted:f,showProgress:I}){return e.jsxs(e.Fragment,{children:[e.jsxs(P,{justifyContent:"center",alignItems:"çenter",children:[e.jsx(U,{sx:{alignSelf:"center",mb:1,bgcolor:f?"success.main":null},children:f?e.jsx(on,{}):m}),e.jsx(w,{variant:"caption",textAlign:"center",children:l})]}),I&&e.jsx(Bt,{variant:"determinate",sx:{width:80,borderRadius:1,bgcolor:f?"success.main":null},color:f?"success":"primary",value:f?100:0})]})}const mn=()=>{var l,f,I,t,n;const{studentState:{newStudent:m}}=S.useContext($);return e.jsxs(Lt,{sx:{width:"100%",display:"flex",justifyContent:"center",py:2},children:[e.jsx(he,{initValue:1,title:"Personal Details",showProgress:!0,isCompleted:(l=m==null?void 0:m.personal)==null?void 0:l.isCompleted}),e.jsx(he,{initValue:2,title:"Upload Photo",showProgress:!0,isCompleted:(f=m==null?void 0:m.photo)==null?void 0:f.isCompleted}),e.jsx(he,{initValue:3,title:"Guardian Information",showProgress:!0,isCompleted:(I=m==null?void 0:m.parent)==null?void 0:I.isCompleted}),e.jsx(he,{initValue:4,title:"Medical Records",showProgress:!0,isCompleted:(t=m==null?void 0:m.medical)==null?void 0:t.isCompleted}),e.jsx(he,{initValue:5,title:"Academic Records",showProgress:!1,isCompleted:(n=m==null?void 0:m.academic)==null?void 0:n.isCompleted})]})},at="text/csv",cn="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",yn="application/vnd.ms-excel",ft=()=>{const{schoolSessionDispatch:m}=S.useContext(je),[l,f]=S.useState("personal-info"),[I,t]=S.useState(!1),n=Rt(),i=Ft(n.breakpoints.up("md")),o="Are you sure you want to leave this page? Your changes may not be saved.";S.useEffect(()=>{const s=r=>{r.preventDefault(),r.returnValue=o};return window.addEventListener("beforeunload",s),()=>{window.removeEventListener("beforeunload",s)}},[]);function a(s){const r=s.target.files[0];try{const u=new FileReader;r.type===at?u.readAsBinaryString(r):u.readAsArrayBuffer(r),u.onload=function(c){let d=[];(r.type===cn||r.type===yn)&&(d=Ht(c.target.result)),r.type===at&&(d=Ut(c.target.result)),d.length!==0&&m({type:"openAddStudentFileDialog",payload:{data:d,type:"file"}})}}catch{}}const p=()=>{let s=l;switch(l){case"photo-info":s="personal-info";break;case"parent-info":s="photo-info";break;case"medical-info":s="parent-info";break;case"academic-info":s="medical-info";break;default:s="photo-info"}return s};return e.jsxs(e.Fragment,{children:[e.jsxs(e.Fragment,{children:[e.jsx(kt,{title:"New Student",subtitle:"  Track,manage and control academic and class activities",icon:e.jsx(tn,{sx:{width:30,height:30}}),color:"primary.main"}),i&&e.jsx(mn,{}),e.jsxs(pt,{children:[l!=="personal-info"&&e.jsx(Ot,{onClick:()=>f(p()),children:e.jsx(Et,{})}),e.jsxs(Mt,{variant:"contained",size:"small",sx:{display:"flex",justifyContent:"flex-end",py:2},children:[e.jsx(G,{sx:{bgcolor:"var(--secondary)"},children:e.jsxs(Vt,{htmlFor:"studentFile",title:"Import students",sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:1,color:"primary.main",fontSize:11,cursor:"pointer"},children:[e.jsx(nn,{htmlColor:"#fff"}),e.jsx(w,{variant:"caption",color:"#fff",children:"From file"}),e.jsx(_t,{type:"file",id:"studentFile",name:"studentFile",hidden:!0,inputProps:{accept:".xlsx,.xls,.csv"},onChange:a,onClick:s=>{s.target.value=null,s.currentTarget.value=null}})]})}),e.jsx(G,{startIcon:e.jsx(qt,{}),onClick:()=>t(!0),children:"From Previous Sessions"})]})]}),e.jsxs(Gt,{sx:{py:4,mb:4,border:"1px solid lightgray",bgcolor:"#fff"},children:[l==="personal-info"&&e.jsx(xt,{mode:l,setMode:f}),l==="photo-info"&&e.jsx(gt,{mode:l,setMode:f}),l==="parent-info"&&e.jsx(pn,{mode:l,setMode:f}),l==="medical-info"&&e.jsx(ht,{mode:l,setMode:f}),l==="academic-info"&&e.jsx(ut,{setMode:f})]})]}),e.jsx(ln,{open:I,setOpen:t})]})};ft.propTypes={};function xn(){var d;const{userState:{session:m}}=S.useContext(it),l=st(),[f,I]=S.useState(""),[t,n]=S.useState({_id:"",type:""}),{schoolSessionState:i,schoolSessionDispatch:o}=S.useContext(je),a=i.addStudentFileData,{levelsOption:p}=ct(),s=()=>{nt.fire({title:"Exiting",text:"Do you want to exit?",showCancelButton:!0}).then(({isConfirmed:y})=>{y&&o({type:"closeAddStudentFileDialog"})})},{mutateAsync:r,isLoading:u}=ot({mutationFn:Zt}),c=()=>{if(I(""),t._id===""){I("Please select a level!");return}const y={students:a==null?void 0:a.data,session:{sessionId:m.sessionId,termId:m.termId,levelId:t._id},type:a.type};nt.fire({title:"Importing students",text:`Do you want to import students in ${t.type}?`,showCancelButton:!0}).then(({isConfirmed:j})=>{j&&r(y,{onSettled:()=>{l.invalidateQueries(["all-students"])},onSuccess:v=>{o(dt(v)),o({type:"closeAddStudentFileDialog"})},onError:v=>{o(mt(v))}})})};return e.jsxs(Ie,{open:a.open,fullScreen:!0,fullWidth:!0,children:[e.jsx(lt,{title:"Students",subtitle:"import students from file or previous academic year",onClose:s}),e.jsxs(rt,{sx:{paddingX:3},children:[e.jsx(G,{onClick:s,children:"Cancel"}),e.jsx(Y,{variant:"contained",loading:u,onClick:c,children:"Import Students"})]}),e.jsx(R,{size:"small",options:p,noOptionsText:"No Level available",getOptionLabel:y=>y.type||"",isOptionEqualToValue:(y,j)=>j._id===void 0||j._id===""||j._id===y._id,value:t,onChange:(y,j)=>n(j),renderInput:y=>e.jsx(g,{...y,label:"Select Level",size:"small",error:!!f,helperText:f,required:!0,FormHelperTextProps:{sx:{color:"error.main"}}}),sx:{width:250,marginLeft:3}}),e.jsx(we,{children:((d=a.data)==null?void 0:d.length)===0?e.jsx(w,{children:"No data available"}):e.jsx($t,{title:(t==null?void 0:t.type)||"Students",icon:Yt.student,columns:rn,data:a==null?void 0:a.data,options:{pageSize:10,pageSizeOptions:[10,20,30,50]},actions:[]})})]})}const hn=()=>{const[m,l]=S.useState({severity:"",text:""});return e.jsxs(e.Fragment,{children:[m.text&&e.jsx(Kt,{severity:m.severity,onClose:()=>l({text:""}),children:m.text}),e.jsx(e.Fragment,{children:e.jsx(an,{children:e.jsx(ft,{msg:m,setMsg:l})})}),e.jsx(xn,{})]})};hn.propTypes={};export{hn as default};
