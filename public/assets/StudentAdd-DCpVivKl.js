import{p as fe,j as e,r as S,a1 as at,S as je,c as Te,m as he,fI as bt,t as Pe,aH as St,w as Ie,k as T,T as f,B as L,fl as $,x as be,fJ as Tt,l as w,a0 as Q,fK as Ct,A as U,fL as Pt,M as It,U as wt,b as it,d as rt,v as st,P as ot,o as zt,_ as ue,g as lt,h as pt,fM as vt,aC as At,bt as Wt,e as dt,I as Dt,eM as Nt,C as Bt,F as Lt,z as Rt,H as Ft,G as kt,V as Ot,fN as Et,fO as Mt,f as et,O as Vt}from"./index-B8PQHtjc.js";import{L as _t,i as qt,P as Gt,f as Ht,g as Ut,C as $t}from"./CustomizedMaterialTable-BQoTtwVw.js";import{g as Yt}from"./termAPI-1V1q_gIm.js";import{A as F}from"./Autocomplete-Dw57Ihk7.js";import{D as Kt}from"./DialogActions-BmNk8sop.js";import{C as B}from"./CustomFormControl-Duiznp8E.js";import{C as Qt}from"./CustomDatePicker-_ngoDY-2.js";import{T as ge,N as Ce}from"./nationality-Dhsqpti8.js";import{a as Xt,p as Jt,b as Zt}from"./studentAPI-DyXUet_8.js";import{h as tt,A as en}from"./sessionColumns-oq904N9H.js";import{M as Y}from"./MedicalAllergy-8xDJIAcn.js";import{u as mt}from"./useLevel-K9fH0Cop.js";import{R as tn}from"./index-DThQnLGZ.js";import{G as ct}from"./GlobalSpinner-DbblD88Y.js";import{L as b}from"./ListItemText-DzMM1D1F.js";import{u as yt,A as nn}from"./index-CeIRQj8o.js";import{u as an}from"./index-BqG4A_N5.js";import{S as rn}from"./School-F8mJoAwr.js";import{B as sn}from"./ButtonGroup-ZC3qSltg.js";import{N as on}from"./NoteRounded-DYrWuwPi.js";import{I as ln}from"./studentColumns-mOrPrRKB.js";import{E as pn}from"./images-B5fNBSni.js";import"./TabPanel-WHfZdNAn.js";import"./useThemeProps-CEPKeDia.js";import"./Toolbar-YM__bEFh.js";import"./Chip-DmEpgF7y.js";import"./Skeleton-DWRiBFRT.js";import"./InputAdornment-DAOlZ4uj.js";import"./ListItem-CQImyTSy.js";import"./ListItemSecondaryAction-DOVMjMKm.js";import"./listItemButtonClasses-DySKLRoc.js";import"./Grid2-B2FVLpOz.js";import"./Link-kLE4_HTq.js";import"./ListItemButton-Di0YOqWQ.js";import"./Check-JB41DPzl.js";import"./DeleteOutline-BlPFLwFk.js";import"./AdapterMoment-BOypM_74.js";import"./generateUtilityClasses-BPC_uuYP.js";import"./createTheme-DxYQS8Dz.js";import"./createStyled-CJd69Mvg.js";import"./currencyFormatter-DjBDW3hY.js";import"./CircleRounded-YWo57tpF.js";import"./gradeColor-B1MTvGsq.js";const dn=fe(e.jsx("path",{d:"M20 21v-3h3v-2h-3v-3h-2v3h-3v2h3v3zm-4.97.5H5.66c-.72 0-1.38-.38-1.73-1l-2.36-4.1c-.36-.62-.35-1.38.01-2L7.92 3.49c.36-.61 1.02-.99 1.73-.99h4.7c.71 0 1.37.38 1.73.99l4.48 7.71c-.5-.13-1.02-.2-1.56-.2q-.42 0-.84.06L14.35 4.5h-4.7L3.31 15.41l2.35 4.09h7.89c.35.77.85 1.45 1.48 2M13.34 15c-.22.63-.34 1.3-.34 2H7.25l-.73-1.27 4.58-7.98h1.8l2.53 4.42c-.56.42-1.05.93-1.44 1.51l-2-3.49L9.25 15z"}),"AddToDrive"),we=fe(e.jsx("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward"),mn=fe(e.jsx("path",{d:"M9 16.17 5.53 12.7a.996.996 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.996.996 0 0 0-1.41 0z"}),"CheckRounded"),cn=fe(e.jsx("path",{d:"M9 3 5 6.99h3V14h2V6.99h3zm7 14.01V10h-2v7.01h-3L15 21l4-3.99z"}),"ImportExport");function yn({open:y,setOpen:p}){const{userState:{session:j}}=S.useContext(at),{schoolSessionDispatch:I}=S.useContext(je),[t,n]=S.useState({_id:"",levelType:"",students:[]}),[i,o]=S.useState({termId:"",sessionId:"",label:""}),a=Te({queryKey:["terms"],queryFn:()=>Yt(),enabled:!!(j!=null&&j.sessionId),select:r=>r.filter(({to:s})=>he(new Date(j.to))>he(new Date(s))).map(({termId:s,sessionId:l,academicYear:m,term:g})=>({termId:s,sessionId:l,label:`${m},${g}`}))}),c=Te({queryKey:["previous-levels",i==null?void 0:i.termId],queryFn:()=>bt(i),enabled:!!(i!=null&&i.termId),select:r=>r.map(({_id:u,level:s,students:l})=>({_id:u,levelType:`${s.name}${s.type}`,students:l}))}),d=()=>{var r;((r=t==null?void 0:t.students)==null?void 0:r.length)!==0&&I({type:"openAddStudentFileDialog",payload:{data:t==null?void 0:t.students,type:"previous"}})};return e.jsxs(Pe,{open:y,maxWidth:"xs",fullWidth:!0,children:[e.jsx(St,{children:" Students from Session"}),e.jsx(Ie,{children:e.jsxs(T,{spacing:2,paddingY:2,children:[e.jsx(F,{size:"small",options:a.data??[],noOptionsText:"No session available",disableClearable:!0,fullWidth:!0,value:i,onChange:(r,u)=>{n({_id:"",levelType:"",students:[]}),o(u)},isOptionEqualToValue:(r,u)=>r.termId===u.termId||u.termId===""||u.termId===null||u.termId===void 0,getOptionLabel:r=>r.label||"",renderInput:r=>e.jsx(f,{...r,label:"Select School Session"})}),e.jsx(F,{size:"small",options:(c==null?void 0:c.data)??[],noOptionsText:"No level available",disableClearable:!0,fullWidth:!0,value:t,onChange:(r,u)=>n(u),isOptionEqualToValue:(r,u)=>r._id===u._id||u._id===""||u._id===null||u._id===void 0,getOptionLabel:r=>r.levelType||"",renderInput:r=>e.jsx(f,{...r,label:"Select Level"})})]})}),e.jsxs(Kt,{children:[e.jsx(L,{onClick:()=>p(!1),children:"Cancel"}),e.jsx(L,{variant:"contained",onClick:d,disabled:!(t!=null&&t._id),children:"Load Students"})]})]})}const xt=({setMode:y})=>{const{studentState:{newStudent:{personal:p}},studentDispatch:j}=S.useContext($),[I,t]=S.useState(""),[n,i]=S.useState(he(p==null?void 0:p.dateofbirth)),o=Te({queryKey:["student-exist",I],queryFn:()=>Xt(I),enabled:!!I,refetchOnMount:!0,refetchOnWindowFocus:!0}),a=(c,d)=>{c.dateofbirth=he(n).format("L"),j({type:"addNewStudent",payload:{personal:{...c,isCompleted:!0}}}),d.setSubmitting(!1),y("photo-info")};return e.jsx(be,{initialValues:p,onSubmit:a,enableReinitialize:!0,validationSchema:Tt,children:({values:c,errors:d,touched:r,setFieldValue:u,handleChange:s,handleSubmit:l,isSubmitting:m})=>e.jsxs(T,{py:2,spacing:2,children:[e.jsx(T,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(L,{loading:m,variant:"contained",color:"primary",onClick:l,endIcon:e.jsx(we,{}),disabled:o==null?void 0:o.isError,children:"Continue"})}),e.jsx(w,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Personal Details"}),e.jsx(f,{label:"Student ID",type:"text",sx:{maxWidth:300},size:"small",value:c.indexnumber,onChange:g=>{u("indexnumber",g.target.value),t(g.target.value)},error:o.isError||!!(r!=null&&r.indexnumber&&(d!=null&&d.indexnumber)),helperText:(o==null?void 0:o.error)||(r==null?void 0:r.indexnumber)&&(d==null?void 0:d.indexnumber)}),e.jsxs(B,{children:[e.jsx(f,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:c.firstname,onChange:s("firstname"),error:!!(r.firstname&&d.firstname),helperText:r.firstname&&d.firstname}),e.jsx(f,{label:"Surname",fullWidth:!0,size:"small",value:c.surname,onChange:s("surname"),error:!!(r.surname&&d.surname),helperText:r.surname&&d.surname}),e.jsx(f,{label:"Othername",fullWidth:!0,size:"small",value:c.othername,onChange:s("othername"),error:!!(r.othername&&d.othername),helperText:r.othername&&d.othername})]}),e.jsxs(B,{children:[e.jsx(Qt,{label:"Date of Birth",date:n,setDate:i,disableFuture:!0,error:!!(r.dateofbirth&&d.dateofbirth),helperText:r.dateofbirth&&d.dateofbirth}),e.jsxs(f,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:c.gender,onChange:s("gender"),error:!!(r.gender&&d.gender),helperText:r.gender&&d.gender,children:[e.jsx(Q,{value:"male",children:"Male"}),e.jsx(Q,{value:"female",children:"Female"})]})]}),e.jsxs(B,{children:[e.jsx(f,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:c.email,onChange:s("email"),error:!!(r.email&&d.email),helperText:r.email&&d.email}),e.jsx(f,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:c.phonenumber,onChange:s("phonenumber"),error:!!(r.phonenumber&&d.phonenumber),helperText:r.phonenumber&&d.phonenumber})]}),e.jsx(f,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,value:c.address,onChange:s("address"),error:!!(r.address&&d.address),helperText:r.address&&d.address}),e.jsxs(B,{children:[e.jsx(F,{freeSolo:!0,fullWidth:!0,size:"small",options:ge,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:g=>g||"",value:c.residence,onChange:(g,z)=>u("residence",z),renderInput:g=>e.jsx(f,{...g,label:"Residence",fullWidth:!0,size:"small",error:!!(r.residence&&d.residence),helperText:r.residence&&d.residence})}),e.jsx(F,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:Ce,noOptionsText:"No Nationality available",getOptionLabel:g=>g||"",value:c.nationality,onChange:(g,z)=>u("nationality",z),renderInput:g=>e.jsx(f,{...g,label:"Nationality",fullWidth:!0,size:"small",error:!!(r.nationality&&d.nationality),helperText:r.nationality&&d.nationality})})]})]})})};xt.propTypes={};const xn=({setMode:y})=>{const{studentState:{newStudent:{parent:p}},studentDispatch:j}=S.useContext($),I=(t,n)=>{j({type:"addNewStudent",payload:{parent:{...t,isCompleted:!0}}}),n.setSubmitting(!1),y("medical-info")};return e.jsx(be,{initialValues:p,onSubmit:I,enableReinitialize:!0,validationSchema:Ct,children:({values:t,errors:n,touched:i,setFieldValue:o,handleChange:a,handleSubmit:c,isSubmitting:d})=>{var r,u,s,l,m,g,z,V,q,_,x,h,R,k,G,A,v,O,E,M,X,J,Z,ee,te,ne,ae,ie,re,se,oe,le,pe,de,me,ce,ye,Se,H,ze,ve,Ae,We,De,Ne,Be,Le,Re,Fe,ke,Oe,Ee,Me,Ve,_e,qe,Ge,He,Ue,$e,Ye,Ke,Qe,Xe,Je,Ze;return e.jsxs(T,{py:2,spacing:1,children:[e.jsxs("div",{style:{maxHeight:350,overflowY:"auto"},children:[e.jsxs(T,{py:2,spacing:1,children:[e.jsxs(T,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:[e.jsx(w,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Parent/Guardian Information"}),e.jsx(U,{sx:{width:30,height:30,bgcolor:"primary.main"},children:"1"})]}),e.jsxs(B,{children:[e.jsx(f,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:(r=t==null?void 0:t.parent1)==null?void 0:r.firstname,onChange:a("parent1.firstname"),error:!!((u=i.parent1)!=null&&u.firstname&&((s=n.parent1)!=null&&s.firstname)),helperText:((l=i.parent1)==null?void 0:l.firstname)&&((m=n.parent1)==null?void 0:m.firstname)}),e.jsx(f,{label:"Surname",fullWidth:!0,size:"small",value:(g=t==null?void 0:t.parent1)==null?void 0:g.surname,onChange:a("parent1.surname"),error:!!((z=i.parent1)!=null&&z.surname&&((V=n.parent1)!=null&&V.surname)),helperText:((q=i.parent1)==null?void 0:q.surname)&&((_=n.parent1)==null?void 0:_.surname)})]}),e.jsxs(B,{children:[e.jsxs(f,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:(x=t==null?void 0:t.parent1)==null?void 0:x.gender,onChange:a("parent1.gender"),error:!!((h=i.parent1)!=null&&h.gender&&((R=n.parent1)!=null&&R.gender)),helperText:((k=i.parent1)==null?void 0:k.gender)&&((G=n.parent1)==null?void 0:G.gender),children:[e.jsx(Q,{value:"male",children:"Male"}),e.jsx(Q,{value:"female",children:"Female"})]}),e.jsx(F,{freeSolo:!0,fullWidth:!0,size:"small",options:tt,loadingText:"Please wait....",noOptionsText:"No Relationship available",getOptionLabel:C=>C||"",value:(A=t==null?void 0:t.parent1)==null?void 0:A.relationship,onInputChange:(C,P)=>o("parent1.relationship",P),renderInput:C=>{var P,W,D,N;return e.jsx(f,{...C,label:"Relationship",fullWidth:!0,size:"small",error:!!((P=i.parent1)!=null&&P.relationship&&((W=n.parent1)!=null&&W.relationship)),helperText:((D=i.parent1)==null?void 0:D.relationship)&&((N=n.parent1)==null?void 0:N.relationship)})}})]}),e.jsxs(B,{children:[e.jsx(f,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:(v=t==null?void 0:t.parent1)==null?void 0:v.email,onChange:a("parent1.email"),error:!!((O=i.parent1)!=null&&O.email&&((E=n.parent1)!=null&&E.email)),helperText:((M=i.parent1)==null?void 0:M.email)&&((X=n.parent1)==null?void 0:X.email)}),e.jsx(f,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(J=t==null?void 0:t.parent1)==null?void 0:J.phonenumber,onChange:a("parent1.phonenumber"),error:!!((Z=i.parent1)!=null&&Z.phonenumber&&((ee=n.parent1)!=null&&ee.phonenumber)),helperText:((te=i.parent1)==null?void 0:te.phonenumber)&&((ne=n.parent1)==null?void 0:ne.phonenumber)})]}),e.jsx(f,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,multiline:!0,value:(ae=t==null?void 0:t.parent1)==null?void 0:ae.address,onChange:a("parent1.address"),error:!!((ie=i.parent1)!=null&&ie.address&&((re=n.parent1)!=null&&re.address)),helperText:((se=i.parent1)==null?void 0:se.address)&&((oe=n.parent1)==null?void 0:oe.address)}),e.jsxs(B,{children:[e.jsx(F,{freeSolo:!0,fullWidth:!0,size:"small",options:ge,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:C=>C||"",value:(le=t==null?void 0:t.parent1)==null?void 0:le.residence,onChange:(C,P)=>o("parent1.residence",P),renderInput:C=>{var P,W,D,N;return e.jsx(f,{...C,label:"Residence",fullWidth:!0,size:"small",error:!!((P=i.parent1)!=null&&P.residence&&((W=n.parent1)!=null&&W.residence)),helperText:((D=i.parent1)==null?void 0:D.residence)&&((N=n.parent1)==null?void 0:N.residence)})}}),e.jsx(F,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:Ce,noOptionsText:"No Nationality available",getOptionLabel:C=>C||"",value:(pe=t==null?void 0:t.parent1)==null?void 0:pe.nationality,onChange:(C,P)=>o("parent1.nationality",P),renderInput:C=>{var P,W,D,N;return e.jsx(f,{...C,label:"Nationality",fullWidth:!0,size:"small",error:!!((P=i.parent1)!=null&&P.nationality&&((W=n.parent1)!=null&&W.nationality)),helperText:((D=i.parent1)==null?void 0:D.nationality)&&((N=n.parent1)==null?void 0:N.nationality)})}})]})]}),e.jsxs(T,{py:2,spacing:1,children:[e.jsxs(T,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:[e.jsx(w,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Parent/Guardian Information"}),e.jsx(U,{sx:{width:30,height:30,bgcolor:"primary.main"},children:"2"})]}),e.jsxs(B,{children:[e.jsx(f,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:(de=t==null?void 0:t.parent2)==null?void 0:de.firstname,onChange:a("parent2.firstname"),error:!!((me=i.parent2)!=null&&me.firstname&&((ce=n.parent2)!=null&&ce.firstname)),helperText:((ye=i.parent2)==null?void 0:ye.firstname)&&((Se=n.parent2)==null?void 0:Se.firstname)}),e.jsx(f,{label:"Surname",fullWidth:!0,size:"small",value:(H=t==null?void 0:t.parent2)==null?void 0:H.surname,onChange:a("parent2.surname"),error:!!((ze=i.parent2)!=null&&ze.surname&&((ve=n.parent2)!=null&&ve.surname)),helperText:((Ae=i.parent2)==null?void 0:Ae.surname)&&((We=n.parent2)==null?void 0:We.surname)})]}),e.jsxs(B,{children:[e.jsxs(f,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:(De=t==null?void 0:t.parent2)==null?void 0:De.gender,onChange:a("parent2.gender"),error:!!((Ne=i.parent2)!=null&&Ne.gender&&((Be=n.parent2)!=null&&Be.gender)),helperText:((Le=i.parent2)==null?void 0:Le.gender)&&((Re=n.parent2)==null?void 0:Re.gender),children:[e.jsx(Q,{value:"male",children:"Male"}),e.jsx(Q,{value:"female",children:"Female"})]}),e.jsx(F,{freeSolo:!0,fullWidth:!0,size:"small",options:tt,loadingText:"Please wait....",noOptionsText:"No Relationship available",getOptionLabel:C=>C||"",value:(Fe=t==null?void 0:t.parent2)==null?void 0:Fe.relationship,onInputChange:(C,P)=>o("parent2.relationship",P),renderInput:C=>{var P,W,D,N;return e.jsx(f,{...C,label:"Relationship",fullWidth:!0,size:"small",error:!!((P=i.parent2)!=null&&P.relationship&&((W=n.parent2)!=null&&W.relationship)),helperText:((D=i.parent2)==null?void 0:D.relationship)&&((N=n.parent2)==null?void 0:N.relationship)})}})]}),e.jsxs(B,{children:[e.jsx(f,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:(ke=t==null?void 0:t.parent2)==null?void 0:ke.email,onChange:a("parent2.email"),error:!!((Oe=i.parent2)!=null&&Oe.email&&((Ee=n.parent2)!=null&&Ee.email)),helperText:((Me=i.parent2)==null?void 0:Me.email)&&((Ve=n.parent2)==null?void 0:Ve.email)}),e.jsx(f,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(_e=t==null?void 0:t.parent2)==null?void 0:_e.phonenumber,onChange:a("parent2.phonenumber"),error:!!((qe=i.parent2)!=null&&qe.phonenumber&&((Ge=n.parent2)!=null&&Ge.phonenumber)),helperText:((He=i.parent2)==null?void 0:He.phonenumber)&&((Ue=n.parent2)==null?void 0:Ue.phonenumber)})]}),e.jsx(f,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,multiline:!0,value:($e=t==null?void 0:t.parent2)==null?void 0:$e.address,onChange:a("parent2.address"),error:!!((Ye=i.parent2)!=null&&Ye.address&&((Ke=n.parent2)!=null&&Ke.address)),helperText:((Qe=i.parent2)==null?void 0:Qe.address)&&((Xe=n.parent2)==null?void 0:Xe.address)}),e.jsxs(B,{children:[e.jsx(F,{freeSolo:!0,fullWidth:!0,size:"small",options:ge,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:C=>C||"",value:(Je=t==null?void 0:t.parent2)==null?void 0:Je.residence,onChange:(C,P)=>o("parent2.residence",P),renderInput:C=>{var P,W,D,N;return e.jsx(f,{...C,label:"Residence",fullWidth:!0,size:"small",error:!!((P=i.parent2)!=null&&P.residence&&((W=n.parent2)!=null&&W.residence)),helperText:((D=i.parent2)==null?void 0:D.residence)&&((N=n.parent2)==null?void 0:N.residence)})}}),e.jsx(F,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:Ce,noOptionsText:"No Nationality available",getOptionLabel:C=>C||"",value:(Ze=t==null?void 0:t.parent2)==null?void 0:Ze.nationality,onChange:(C,P)=>o("parent2.nationality",P),renderInput:C=>{var P,W,D,N;return e.jsx(f,{...C,label:"Nationality",fullWidth:!0,size:"small",error:!!((P=i.parent2)!=null&&P.nationality&&((W=n.parent2)!=null&&W.nationality)),helperText:((D=i.parent2)==null?void 0:D.nationality)&&((N=n.parent2)==null?void 0:N.nationality)})}})]})]})]}),e.jsx(T,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(L,{loading:d,variant:"contained",color:"primary",onClick:c,children:"Save & Continue"})})]})}})},ht=({setMode:y})=>{const{studentState:{newStudent:{medical:p}},studentDispatch:j}=S.useContext($),I=(t,n)=>{j({type:"addNewStudent",payload:{medical:{...t,isCompleted:!0}}}),n.setSubmitting(!1),y("academic-info")};return e.jsx(be,{initialValues:p,onSubmit:I,enableReinitialize:!0,validationSchema:Pt,children:({values:t,errors:n,touched:i,handleChange:o,handleSubmit:a,isSubmitting:c})=>{var d,r,u,s,l,m,g,z,V,q,_,x,h,R,k;return e.jsxs(T,{padding:2,spacing:1,children:[e.jsx(T,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(L,{loading:c,variant:"contained",color:"primary",onClick:a,endIcon:e.jsx(we,{}),children:"Continue"})}),e.jsx(w,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Medical Records"}),e.jsx(w,{variant:"body2",color:"primary.main",children:"(Kindly note that this section, even though required, will not affect your child’s admission into the school)."}),e.jsxs(T,{width:{xs:"100%",md:"80%"},py:5,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(Y,{title:"1. Heart Disease",value:t.heartDisease,setValue:o("heartDisease")}),e.jsx(Y,{title:"2. Visual Impairment",value:t.visualImpairment,setValue:o("visualImpairment")})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(Y,{title:"3. Asthma",value:t.asthma,setValue:o("asthma")}),e.jsx(Y,{title:"4. Hearing Impairment",value:t.hearingImpairment,setValue:o("hearingImpairment")})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(Y,{title:"5. Siezures",value:t.siezures,setValue:o("siezures")}),e.jsx(Y,{title:"6. Physical Disability",value:t.physicalDisability,setValue:o("physicalDisability")})]})]}),e.jsxs(T,{py:2,spacing:1,children:[e.jsx(w,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Emergency Contact"}),e.jsxs(B,{children:[e.jsx(f,{label:"Fullname",type:"text",fullWidth:!0,size:"small",value:(d=t==null?void 0:t.emergencyContact)==null?void 0:d.fullname,onChange:o("emergencyContact.fullname"),error:!!((r=i==null?void 0:i.emergencyContact)!=null&&r.fullname&&((u=n==null?void 0:n.emergencyContact)!=null&&u.fullname)),helperText:((s=i==null?void 0:i.emergencyContact)==null?void 0:s.fullname)&&((l=n==null?void 0:n.emergencyContact)==null?void 0:l.fullname)}),e.jsx(f,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(m=t==null?void 0:t.emergencyContact)==null?void 0:m.phonenumber,onChange:o("emergencyContact.phonenumber"),error:!!((g=i==null?void 0:i.emergencyContact)!=null&&g.phonenumber&&((z=n==null?void 0:n.emergencyContact)!=null&&z.phonenumber)),helperText:((V=i==null?void 0:i.emergencyContact)==null?void 0:V.phonenumber)&&((q=n==null?void 0:n.emergencyContact)==null?void 0:q.phonenumber)})]}),e.jsx(B,{children:e.jsx(f,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,value:(_=t==null?void 0:t.emergencyContact)==null?void 0:_.address,onChange:o("emergencyContact.address"),error:!!((x=i==null?void 0:i.emergencyContact)!=null&&x.address&&((h=n==null?void 0:n.emergencyContact)!=null&&h.address)),helperText:((R=i==null?void 0:i.emergencyContact)==null?void 0:R.address)&&((k=n==null?void 0:n.emergencyContact)==null?void 0:k.address)})})]})]})}})};ht.propTypes={};function K({title:y,value:p}){return e.jsxs(T,{direction:"row",justifyContent:"space-between",alignItems:"center",spacing:3,pr:6,children:[e.jsx(w,{textAlign:"right",fontSize:11,children:y}),e.jsx(It,{sx:{fontSize:11},value:p,control:e.jsx(wt,{size:"small",checked:!0}),label:p,slotProps:{typography:{sx:{fontSize:11}}}})]})}function hn({open:y,setOpen:p,setMode:j}){var k,G,A,v,O,E,M,X,J,Z,ee,te,ne,ae,ie,re,se,oe,le,pe,de,me,ce,ye;const I=it(),t=JSON.parse(localStorage.getItem("@school_info")),{studentState:{newStudent:{personal:n,photo:i,medical:o,parent:a,academic:c},studentDispatch:d}}=S.useContext($),{schoolSessionDispatch:r}=S.useContext(je),u=S.useRef(),[s,l]=S.useState(""),[m,g]=S.useState(!1),{mutateAsync:z,isPending:V}=rt({mutationFn:Jt}),q=()=>{n.profile=i==null?void 0:i.profile,z({personal:n,medical:o,parent:a,academic:c},{onSettled:()=>{I.invalidateQueries(["students-by-current-level"]),I.invalidateQueries(["all-students"])},onSuccess:H=>{H&&(r(lt("New Student Added")),g(!0),l(H),localStorage.removeItem("@student"))},onError:H=>{r(pt(H))}})},_=()=>{s?(j("personal-info"),p(!1),d({type:"addNewStudent",payload:{}})):p(!1)},x={fontSize:12,color:"primary",fontWeight:"700"},h={fontSize:10},R={width:"100%",borderBottom:"1px solid black",backgroundColor:"black",color:"#fff",padding:"2px"};return e.jsxs(Pe,{open:y,fullWidth:!0,maxWidth:"lg",onClose:()=>p(!1),children:[e.jsx(st,{title:"Admission Form",subtitle:"Preview of student information. Please check before saving your information.",onClose:_}),e.jsxs(ot,{display:"flex",gap:2,justifyContent:"center",alignItems:"center",pt:2,children:[e.jsx(tn,{trigger:()=>e.jsx(L,{variant:"outlined",children:"Print Form"}),content:()=>u.current,documentTitle:"Admission"}),e.jsx(L,{loading:V,variant:"contained",color:"primary",onClick:q,children:"Save Student Data"})]}),e.jsx(Ie,{children:e.jsxs("div",{ref:u,children:[e.jsxs(T,{justifyContent:"center",alignItems:"center",sx:{maxWidth:"8.5in",minHeight:"11in",margin:"auto",padding:"16px",border:"1px solid lightgray",position:"relative",backgroundSize:"contain",backgroundPosition:"center center !important"},children:[e.jsx(w,{variant:"body1",sx:{justifySelf:"start",py:4},children:"Admission Form"}),t!=null&&t.badge?e.jsx(U,{alt:"school logo",loading:"lazy",srcSet:`/images/users/${t==null?void 0:t.badge}`,sx:{width:100,height:100}}):e.jsx(zt,{sx:{width:100,height:100}}),e.jsxs(T,{justifyContent:"center",alignItems:"center",width:"100%",children:[e.jsx(w,{variant:"h4",children:ue.startCase(t==null?void 0:t.name)}),e.jsx(w,{variant:"caption",children:t==null?void 0:t.address}),e.jsx(w,{variant:"caption",children:t==null?void 0:t.location}),e.jsx(w,{variant:"caption",fontStyle:"italic",children:t==null?void 0:t.motto})]}),e.jsx(w,{variant:"h3",textTransform:"uppercase",my:2,children:`${n==null?void 0:n.surname} ${n==null?void 0:n.firstname} ${n==null?void 0:n.othername}`})]}),e.jsxs(T,{className:"admission-form",spacing:1,sx:{maxWidth:"8.5in",minHeight:"11in",margin:"auto",padding:"16px",border:"1px solid lightgray",position:"relative",backgroundSize:"contain",backgroundPosition:"center center !important"},children:[s&&e.jsx("small",{style:{position:"absolute",bottom:"0",right:0,paddingRight:"8px",paddingBottom:"8px"},children:s}),e.jsx("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:e.jsx(U,{variant:"square",src:i==null?void 0:i.profile,sx:{alignSelf:"center",width:80,height:80}})}),e.jsxs("div",{style:{paddingBottom:"8px"},children:[e.jsx("legend",{style:R,children:"Personal Data"}),e.jsx(b,{secondary:"Student ID",primary:n==null?void 0:n.indexnumber,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(b,{secondary:"Full Name",primary:`${n==null?void 0:n.surname} ${n==null?void 0:n.firstname} ${n==null?void 0:n.othername}`,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Date of Birth",primary:he(new Date(n==null?void 0:n.dateofbirth)).format("LL"),primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Gender",primary:n==null?void 0:n.gender,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Email Address",primary:n==null?void 0:n.email,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Phone Number",primary:n==null?void 0:n.phonenumber,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Residence",primary:n==null?void 0:n.residence,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Nationality",primary:n==null?void 0:n.nationality,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Address",primary:n==null?void 0:n.address,primaryTypographyProps:x,secondaryTypographyProps:h})]})]}),e.jsxs("div",{style:{paddingBottom:"8px"},children:[e.jsx("legend",{style:R,children:"Parent/Guardian Information"}),e.jsxs(T,{children:[e.jsx(w,{color:"primary.main",sx:{fontWeight:"bold",fontSize:11},children:"Parent 1 / Guardian 1"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(b,{secondary:"Surname",primary:(k=a==null?void 0:a.parent1)==null?void 0:k.surname,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"First Name",primary:(G=a==null?void 0:a.parent1)==null?void 0:G.firstname,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Relationship",primary:(A=a==null?void 0:a.parent1)==null?void 0:A.relationship,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Gender",primary:(v=a==null?void 0:a.parent1)==null?void 0:v.gender,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Email Address",primary:(O=a==null?void 0:a.parent1)==null?void 0:O.email,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Phone Number",primary:(E=a==null?void 0:a.parent1)==null?void 0:E.phonenumber,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Residence",primary:(M=a==null?void 0:a.parent1)==null?void 0:M.residence,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Nationality",primary:(X=a==null?void 0:a.parent1)==null?void 0:X.nationality,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Address",primary:(J=a==null?void 0:a.parent1)==null?void 0:J.address,primaryTypographyProps:x,secondaryTypographyProps:h})]})]}),e.jsxs(T,{children:[e.jsx(w,{color:"primary.main",sx:{fontWeight:"bold",fontSize:11},children:"Parent 2 / Guardian 2"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(b,{secondary:"Surname",primary:(Z=a==null?void 0:a.parent2)==null?void 0:Z.surname,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"First Name",primary:(ee=a==null?void 0:a.parent2)==null?void 0:ee.firstname,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Relationship",primary:(te=a==null?void 0:a.parent2)==null?void 0:te.relationship,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Gender",primary:(ne=a==null?void 0:a.parent2)==null?void 0:ne.gender,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Email Address",primary:(ae=a==null?void 0:a.parent2)==null?void 0:ae.email,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Phone Number",primary:(ie=a==null?void 0:a.parent2)==null?void 0:ie.phonenumber,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Residence",primary:(re=a==null?void 0:a.parent2)==null?void 0:re.residence,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Nationality",primary:(se=a==null?void 0:a.parent2)==null?void 0:se.nationality,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Address",primary:(oe=a==null?void 0:a.parent2)==null?void 0:oe.address,primaryTypographyProps:x,secondaryTypographyProps:h})]})]})]}),e.jsxs("div",{style:{paddingBottom:"8px"},children:[e.jsx("legend",{style:R,children:"Medical Records"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(K,{title:"1. Heart Disease",value:o.heartDisease}),e.jsx(K,{title:"2. Asthma",value:o.asthma}),e.jsx(K,{title:"3. Siezures",value:o.siezures}),e.jsx(K,{title:"4. Visual Impairment",value:o.visualImpairment}),e.jsx(K,{title:"5. Hearing Impairment",value:o.hearingImpairment}),e.jsx(K,{title:"6. Physical Disability",value:o.physicalDisability})]}),e.jsx(w,{color:"primary.main",sx:{fontWeight:"bold",fontSize:11},children:"Emergency Contact"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(b,{secondary:"Fullname",primary:(le=o==null?void 0:o.emergencyContact)==null?void 0:le.fullname,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Phone Number",primary:(pe=o==null?void 0:o.emergencyContact)==null?void 0:pe.phonenumber,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Address",primary:(de=o==null?void 0:o.emergencyContact)==null?void 0:de.address,primaryTypographyProps:x,secondaryTypographyProps:h})]})]}),e.jsxs("div",{style:{paddingBottom:"8px"},children:[e.jsx("legend",{style:R,children:"Academic Records"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(b,{secondary:"Current Level",primary:(me=c==null?void 0:c.level)==null?void 0:me.type,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Previous School Name",primary:(ce=c==null?void 0:c.previousSchool)==null?void 0:ce.name,primaryTypographyProps:x,secondaryTypographyProps:h}),e.jsx(b,{secondary:"Location",primary:(ye=c==null?void 0:c.previousSchool)==null?void 0:ye.location,primaryTypographyProps:x,secondaryTypographyProps:h})]})]})]})]})}),V&&e.jsx(ct,{})]})}const ut=({setMode:y})=>{var u;const{studentState:{newStudent:{academic:p}},studentDispatch:j}=S.useContext($),[I,t]=S.useState(!1),[n,i]=S.useState((u=p==null?void 0:p.previousSchool)==null?void 0:u.report),{levelsOption:o}=mt(),{getRootProps:a,getInputProps:c,open:d}=yt({noClick:!0,noKeyboard:!0,maxFiles:1,accept:{"image/*":[".jpeg",".png",".webp"],"application/pdf":[".pdf"]},multiple:!1,onDrop:s=>{if(!ue.isEmpty(s)){const l=new FileReader;l.onload=function(m){const g=m.target.result;i(g)},l.readAsDataURL(s[0])}}}),r=(s,l)=>{s.previousSchool.report=n,j({type:"addNewStudent",payload:{academic:{...s,isCompleted:!0}}}),l.setSubmitting(!1),t(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(be,{initialValues:p,onSubmit:r,enableReinitialize:!0,validationSchema:vt,children:({values:s,errors:l,touched:m,setFieldValue:g,handleChange:z,handleSubmit:V,isSubmitting:q})=>{var _,x,h,R,k,G;return e.jsxs(T,{py:2,spacing:1,children:[e.jsx(T,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(L,{loading:q,variant:"contained",color:"primary",onClick:V,endIcon:e.jsx(we,{}),children:"Continue"})}),e.jsx(w,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Academic Records"}),e.jsx(B,{children:e.jsx(F,{fullWidth:!0,size:"small",options:o,noOptionsText:"No Level available",getOptionLabel:A=>A.type||"",isOptionEqualToValue:(A,v)=>v._id===void 0||v._id===""||v._id===A._id,value:s.level,onChange:(A,v)=>g("level",v),renderInput:A=>{var v,O,E,M;return e.jsx(f,{...A,label:"Current Level",fullWidth:!0,size:"small",error:!!((v=m==null?void 0:m.level)!=null&&v.type&&((O=l==null?void 0:l.level)!=null&&O.type)),helperText:((E=m==null?void 0:m.level)==null?void 0:E.type)&&((M=l==null?void 0:l.level)==null?void 0:M.type)})}})}),e.jsx(w,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Previous School Records"}),e.jsxs(B,{children:[e.jsx(f,{label:"School Name",type:"text",fullWidth:!0,size:"small",value:(_=s==null?void 0:s.previousSchool)==null?void 0:_.name,onChange:z("previousSchool.name"),error:!!((x=m==null?void 0:m.previousSchool)!=null&&x.name&&((h=l==null?void 0:l.previousSchool)!=null&&h.name)),helperText:((R=m==null?void 0:m.previousSchool)==null?void 0:R.name)&&((k=l==null?void 0:l.previousSchool)==null?void 0:k.name)}),e.jsx(F,{freeSolo:!0,fullWidth:!0,size:"small",options:ge,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:A=>A||"",value:(G=s==null?void 0:s.previousSchool)==null?void 0:G.location,onInputChange:(A,v)=>g("previousSchool.location",v),renderInput:A=>{var v,O,E,M;return e.jsx(f,{...A,label:"Location",fullWidth:!0,size:"small",error:!!((v=m==null?void 0:m.previousSchool)!=null&&v.location&&((O=l==null?void 0:l.previousSchool)!=null&&O.location)),helperText:((E=m==null?void 0:m.previousSchool)==null?void 0:E.location)&&((M=l==null?void 0:l.previousSchool)==null?void 0:M.location)})}})]}),e.jsx(w,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"A copy of the most recent school report"}),e.jsx(T,{padding:2,spacing:1,...a({className:"dropzone"}),style:{border:"1px dashed black"},children:e.jsxs(T,{spacing:2,justifyContent:"center",alignItems:"center",paddingY:1,children:[e.jsx(U,{variant:"square",src:n,sx:{width:120,height:120},children:e.jsx(At,{})}),e.jsxs(T,{children:[e.jsx("input",{...c()}),e.jsx(w,{textAlign:"center",paragraph:!0,children:"Drag & drop your report here"}),e.jsx(L,{variant:"outlined",onClick:d,startIcon:e.jsx(dn,{}),children:"Upload Report"})]}),!ue.isEmpty(n)&&e.jsx("iframe",{style:{width:"100%",height:"5in"},src:n})]})})]})}}),e.jsx(hn,{open:I,setOpen:t,setMode:y})]})};ut.propTypes={};const gt=({setMode:y})=>{const{studentState:{newStudent:{photo:p}},studentDispatch:j}=S.useContext($),[I,t]=S.useState(p==null?void 0:p.profile),{getRootProps:n,getInputProps:i,open:o}=yt({noClick:!0,noKeyboard:!0,maxFiles:1,accept:{"image/*":[".jpeg",".png"]},maxSize:2e5,multiple:!1,onDrop:c=>{if(!ue.isEmpty(c)){const d=new FileReader;d.onload=function(r){const u=r.target.result;t(u)},d.readAsDataURL(c[0])}}});S.useEffect(()=>{var d;const c=JSON.parse(localStorage.getItem("@student"));if(c){t((d=c==null?void 0:c.photo)==null?void 0:d.profile);return}},[]);const a=()=>{j({type:"addNewStudent",payload:{photo:{profile:I,isCompleted:!0}}}),y("parent-info")};return e.jsxs(T,{padding:2,spacing:1,...n({className:"dropzone"}),style:{border:"1px dashed black"},children:[e.jsx(T,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(L,{variant:"contained",onClick:a,endIcon:e.jsx(en,{}),children:"Continue"})}),e.jsx(w,{variant:"h5",color:"primary.main",bgcolor:"whitesmoke",p:1,sx:{fontWeight:"bold"},children:"Upload Photo"}),e.jsxs(T,{spacing:2,justifyContent:"center",alignItems:"center",paddingY:1,children:[e.jsx(U,{variant:"square",src:I,sx:{width:120,height:120}}),e.jsxs(T,{children:[e.jsx("input",{...i()}),e.jsx(w,{textAlign:"center",paragraph:!0,children:"Drag & drop your photo here"}),e.jsx(L,{variant:"outlined",onClick:o,startIcon:e.jsx(nn,{}),children:"Upload Image"})]})]})]})};gt.propTypes={};function xe({initValue:y,title:p,isCompleted:j,showProgress:I}){return e.jsxs(e.Fragment,{children:[e.jsxs(T,{justifyContent:"center",alignItems:"çenter",children:[e.jsx(U,{sx:{alignSelf:"center",mb:1,bgcolor:j?"success.main":null},children:j?e.jsx(mn,{}):y}),e.jsx(w,{variant:"caption",textAlign:"center",children:p})]}),I&&e.jsx(_t,{variant:"determinate",sx:{width:80,borderRadius:1,bgcolor:j?"success.main":null},color:j?"success":"primary",value:j?100:0})]})}const un=()=>{var p,j,I,t,n;const{studentState:{newStudent:y}}=S.useContext($);return e.jsxs(qt,{sx:{width:"100%",display:"flex",justifyContent:"center",py:2},children:[e.jsx(xe,{initValue:1,title:"Personal Details",showProgress:!0,isCompleted:(p=y==null?void 0:y.personal)==null?void 0:p.isCompleted}),e.jsx(xe,{initValue:2,title:"Upload Photo",showProgress:!0,isCompleted:(j=y==null?void 0:y.photo)==null?void 0:j.isCompleted}),e.jsx(xe,{initValue:3,title:"Guardian Information",showProgress:!0,isCompleted:(I=y==null?void 0:y.parent)==null?void 0:I.isCompleted}),e.jsx(xe,{initValue:4,title:"Medical Records",showProgress:!0,isCompleted:(t=y==null?void 0:y.medical)==null?void 0:t.isCompleted}),e.jsx(xe,{initValue:5,title:"Academic Records",showProgress:!1,isCompleted:(n=y==null?void 0:y.academic)==null?void 0:n.isCompleted})]})},nt="text/csv",gn="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fn="application/vnd.ms-excel",ft=()=>{const{schoolSessionDispatch:y}=S.useContext(je),[p,j]=S.useState("personal-info"),[I,t]=S.useState(!1),[n,i]=S.useState(!1),o=Wt(),a=an(o.breakpoints.up("md")),c="Are you sure you want to leave this page? Your changes may not be saved.";S.useEffect(()=>{const s=l=>{l.preventDefault(),l.returnValue=c};return window.addEventListener("beforeunload",s),()=>{window.removeEventListener("beforeunload",s)}},[]);function d(s){t(!0);const l=s.target.files[0];try{const m=new FileReader;l.type===nt?m.readAsBinaryString(l):m.readAsArrayBuffer(l),m.onload=function(g){let z=[];(l.type===gn||l.type===fn)&&(z=Ht(g.target.result)),l.type===nt&&(z=Ut(g.target.result)),z.length!==0&&y({type:"openAddStudentFileDialog",payload:{data:z,type:"file"}}),t(!1)}}catch{}}const r=()=>{let s=p;switch(p){case"photo-info":s="personal-info";break;case"parent-info":s="photo-info";break;case"medical-info":s="parent-info";break;case"academic-info":s="medical-info";break;default:s="photo-info"}return s},u=async()=>{await kt("students")};return e.jsxs(e.Fragment,{children:[e.jsxs(e.Fragment,{children:[e.jsx(dt,{title:"New Student",subtitle:"  Track,manage and control academic and class activities",icon:e.jsx(rn,{sx:{width:30,height:30}}),color:"primary.main"}),a&&e.jsx(un,{}),e.jsx(ot,{children:p!=="personal-info"&&e.jsx(Dt,{onClick:()=>j(r()),children:e.jsx(Nt,{})})}),e.jsxs(Bt,{sx:{py:4,mb:4,border:"1px solid lightgray",bgcolor:"#fff"},children:[e.jsxs(sn,{variant:"contained",size:"small",sx:{display:"flex",flexDirection:{xs:"column",md:"row"},justifyContent:"center",py:2,boxShadow:0,borderRadius:0,gap:{xs:1,md:0}},children:[e.jsx(L,{onClick:u,children:"Download Student Template"}),e.jsx(L,{sx:{bgcolor:"var(--secondary)"},children:e.jsxs(Lt,{htmlFor:"studentFile",title:"Import students",sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:1,color:"primary.main",fontSize:11,cursor:"pointer"},children:[e.jsx(on,{htmlColor:"#fff"}),e.jsx(w,{variant:"caption",color:"#fff",children:"Student From file"}),e.jsx(Rt,{type:"file",id:"studentFile",name:"studentFile",hidden:!0,inputProps:{accept:".xlsx,.xls,.csv"},onChange:d,onClick:s=>{s.target.value=null,s.currentTarget.value=null}})]})}),e.jsx(L,{startIcon:e.jsx(Gt,{}),onClick:()=>i(!0),children:"Student From Previous Sessions"})]}),p==="personal-info"&&e.jsx(xt,{mode:p,setMode:j}),p==="photo-info"&&e.jsx(gt,{mode:p,setMode:j}),p==="parent-info"&&e.jsx(xn,{mode:p,setMode:j}),p==="medical-info"&&e.jsx(ht,{mode:p,setMode:j}),p==="academic-info"&&e.jsx(ut,{setMode:j})]})]}),e.jsx(yn,{open:n,setOpen:i}),I&&e.jsx(Ft,{value:"Loading data.."})]})};ft.propTypes={};const jt=({children:y})=>e.jsx(Et,{mode:"wait",children:e.jsx(Mt.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},transition:{duration:.2},children:y})});jt.propTypes={children:Ot.node};function jn(){var l;const{userState:{session:y}}=S.useContext(at),p=it(),[j,I]=S.useState(""),[t,n]=S.useState({_id:"",type:""}),{schoolSessionState:i,schoolSessionDispatch:o}=S.useContext(je),a=i.addStudentFileData,{levelsOption:c}=mt(),d=()=>{et.fire({title:"Exiting",text:"Unsaved Changes will be lost. Are you sure?",showCancelButton:!0}).then(({isConfirmed:m})=>{m&&o({type:"closeAddStudentFileDialog"})})},{mutateAsync:r,isPending:u}=rt({mutationFn:Zt}),s=()=>{if(I(""),t._id===""){I("Please select a level!");return}const m={students:a==null?void 0:a.data,session:{sessionId:y.sessionId,termId:y.termId,levelId:t._id},type:a.type};et.fire({title:"Importing students",text:`Do you want to import students in ${t.type}?`,showCancelButton:!0}).then(({isConfirmed:g})=>{g&&r(m,{onSettled:()=>{p.invalidateQueries(["all-students"])},onSuccess:z=>{o(lt(z)),o({type:"closeAddStudentFileDialog"})},onError:z=>{o(pt(z))}})})};return e.jsxs(Pe,{open:a.open,fullScreen:!0,fullWidth:!0,children:[e.jsx(st,{onClose:d}),e.jsxs(Ie,{sx:{px:4},children:[e.jsx(dt,{title:"Import Students",subtitle:"Enroll new students by adding their personal and academic details to the system for accurate record-keeping and future reference by importing Student data from excel or csv files.",color:"primary.main"}),e.jsx(T,{spacing:2,py:4,px:2,my:4,border:"1px solid lightgray",children:e.jsxs(w,{children:["Select an ",e.jsx("b",{children:"EXCEL"})," OR ",e.jsx("b",{children:"CSV"})," file containing students information. Make sure the columns matches the accepted fields."]})}),((l=a.data)==null?void 0:l.length)===0?e.jsx(w,{children:"No data available"}):e.jsx($t,{title:(t==null?void 0:t.type)||"Students",icon:pn.student,columns:ln,data:a==null?void 0:a.data,options:{pageSize:10,pageSizeOptions:[10,20,30,50]},actions:[],autoCompleteComponent:e.jsx(F,{size:"small",options:c,noOptionsText:"No Level available",getOptionLabel:m=>m.type||"",isOptionEqualToValue:(m,g)=>g._id===void 0||g._id===""||g._id===m._id,value:t,onChange:(m,g)=>n(g),renderInput:m=>e.jsx(f,{...m,label:"Select Level",size:"small",error:!!j,helperText:j,required:!0,FormHelperTextProps:{sx:{color:"error.main"}}}),sx:{width:250,marginLeft:3}}),showAddButton:!0,addButtonText:"Import Students Data",addButtonIcon:e.jsx(cn,{}),onAddButtonClicked:s})]}),u&&e.jsx(ct,{})]})}const bn=()=>{const[y,p]=S.useState({severity:"",text:""});return e.jsxs(e.Fragment,{children:[y.text&&e.jsx(Vt,{severity:y.severity,onClose:()=>p({text:""}),children:y.text}),e.jsx(e.Fragment,{children:e.jsx(jt,{children:e.jsx(ft,{msg:y,setMsg:p})})}),e.jsx(jn,{})]})};bn.propTypes={};export{bn as default};
