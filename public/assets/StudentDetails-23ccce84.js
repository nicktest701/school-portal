import{a4 as k,j as e,D as je,aw as pe,bO as ye,a7 as W,u as ee,r as C,ak as ae,S as O,h as te,i as H,C as q,l as Y,F as fe,co as An,m as h,bk as I,T as p,n as D,bo as xe,aM as V,bl as me,bm as de,v as be,w as le,x as re,Q as ne,bn as Dn,q as z,a8 as he,am as ge,g as Z,X as J,cp as g,B as N,cq as Cn,cr as Bn,O as Sn,bp as Mn,ae as se,bh as En,b0 as On,N as Ln,cs as kn,p as Fn,ct as Vn,aT as Hn,a as qn,a9 as Yn,bZ as Gn,y as Qn,t as $n,ap as vn,bX as Kn,U as Un,V as _n,aN as Xn,aO as Zn,aP as oe,aQ as ce,cu as Jn,c6 as ei}from"./index-97ebb758.js";import ni from"./StudentEdit-10da6ec0.js";import{u as ii,d as ai,c as ti}from"./studentAPI-95ea0a9f.js";import{M as F}from"./MedicalAllergy-8dac2d4f.js";import{P as Tn}from"./PersonRounded-57535854.js";import{S as li}from"./StudentFeeReportListItem-02293784.js";import{R as ri}from"./Report-aeb368b3.js";import{R as si}from"./ReportRounded-77fbb636.js";import{N as oi}from"./NoteRounded-632424b0.js";const ci=k(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 3c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6m7 13H5v-.23c0-.62.28-1.2.76-1.58C7.47 15.82 9.64 15 12 15s4.53.82 6.24 2.19c.48.38.76.97.76 1.58z"}),"AccountBoxRounded"),pi=k(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zm3.17-6.41a.9959.9959 0 0 1 0-1.41c.39-.39 1.02-.39 1.41 0L12 12.59l1.41-1.41c.39-.39 1.02-.39 1.41 0s.39 1.02 0 1.41L13.41 14l1.41 1.41c.39.39.39 1.02 0 1.41s-1.02.39-1.41 0L12 15.41l-1.41 1.41c-.39.39-1.02.39-1.41 0a.9959.9959 0 0 1 0-1.41L10.59 14zM18 4h-2.5l-.71-.71c-.18-.18-.44-.29-.7-.29H9.91c-.26 0-.52.11-.7.29L8.5 4H6c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1"}),"DeleteForeverRounded"),un=k(e.jsx("path",{d:"M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1c-.1.1-.15.22-.15.36M20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"EditRounded"),xi=k(e.jsx("path",{d:"M20 7h-5V4c0-1.1-.9-2-2-2h-2c-1.1 0-2 .9-2 2v3H4c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2m-9-3h2v5h-2zM7 16H6c-.55 0-1-.45-1-1s.45-1 1-1h1v-1c0-.55.45-1 1-1s1 .45 1 1v1h1c.55 0 1 .45 1 1s-.45 1-1 1H9v1c0 .55-.45 1-1 1s-1-.45-1-1zm6.75-1.5c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h4.5c.41 0 .75.34.75.75s-.34.75-.75.75zm0 3c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h2.5c.41 0 .75.34.75.75s-.34.75-.75.75z"}),"MedicalInformationRounded"),mi=k(e.jsx("path",{d:"m19.23 15.26-2.54-.29c-.61-.07-1.21.14-1.64.57l-1.84 1.84c-2.83-1.44-5.15-3.75-6.59-6.59l1.85-1.85c.43-.43.64-1.03.57-1.64l-.29-2.52c-.12-1.01-.97-1.77-1.99-1.77H5.03c-1.13 0-2.07.94-2 2.07.53 8.54 7.36 15.36 15.89 15.89 1.13.07 2.07-.87 2.07-2v-1.73c.01-1.01-.75-1.86-1.76-1.98"}),"PhoneRounded"),di=k(e.jsx("path",{d:"M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27zM12 17.3c-.72 0-1.3-.58-1.3-1.3 0-.72.58-1.3 1.3-1.3.72 0 1.3.58 1.3 1.3 0 .72-.58 1.3-1.3 1.3m1-4.3h-2V7h2z"}),"Report"),hi=k(e.jsx("path",{d:"M21 12.4V7l-4-4H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h7.4zM15 15c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3M6 6h9v4H6zm13.99 10.25 1.77 1.77L16.77 23H15v-1.77zm3.26.26-.85.85-1.77-1.77.85-.85c.2-.2.51-.2.71 0l1.06 1.06c.2.2.2.52 0 .71"}),"SaveAs"),ie=({divider:a,label:s,icon:o})=>a?e.jsx(je,{textAlign:"left",children:e.jsx(pe,{label:s,size:"small",color:"primary",icon:o||null,sx:{bgcolor:"info.lighter",color:"info.darker"}})}):e.jsx(pe,{label:s,size:"small",color:"primary",icon:o||null}),ji=async a=>{try{return(await ye({method:"GET",url:"/parents/student",params:{id:a}})).data}catch(s){return s.response.data}},yi=async a=>{try{return(await ye({method:"POST",url:"/parents",data:a})).data}catch(s){return s.response.data}},fi=async a=>{try{return(await ye({method:"PUT",url:"/parents",data:a})).data}catch(s){return s.response.data}},ue=()=>{var R;const a=ee(),{studentState:s,studentDispatch:o}=C.useContext(ae),{schoolSessionDispatch:d}=C.useContext(O),{mutateAsync:c}=te({mutationFn:fi}),u=(r,l)=>{c(r,{onSettled:()=>{a.invalidateQueries(["parent"]),l.setSubmitting(!1)},onSuccess:n=>{d(le(n)),f()},onError:n=>{d(re(n))}})},f=()=>{o({type:"editParent",payload:{open:!1,data:{}}})};return e.jsx(e.Fragment,{children:e.jsxs(H,{maxWidth:"md",fullWidth:!0,open:s==null?void 0:s.editParentData.open,onClose:f,children:[e.jsx(q,{title:"Edit Parent/Guardian Information",onClose:f}),e.jsx(Y,{children:e.jsx(fe,{initialValues:(R=s==null?void 0:s.editParentData)==null?void 0:R.data,onSubmit:u,enableReinitialize:!0,validationSchema:An,children:({values:r,errors:l,touched:n,setFieldValue:t,handleChange:i,handleSubmit:j,isSubmitting:b})=>e.jsxs(h,{padding:2,spacing:1,children:[e.jsxs(I,{children:[e.jsx(p,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:r.firstname||"",onChange:i("firstname"),error:!!(n.firstname&&l.firstname),helperText:n.firstname&&l.firstname}),e.jsx(p,{label:"Surname",fullWidth:!0,size:"small",value:r.surname||"",onChange:i("surname"),error:!!(n.surname&&l.surname),helperText:n.surname&&l.surname})]}),e.jsxs(I,{children:[e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",options:xe,loadingText:"Please wait....",noOptionsText:"No Relationship available",getOptionLabel:y=>y||"",value:r==null?void 0:r.relationship,onInputChange:(y,P)=>t("relationship",P),renderInput:y=>e.jsx(p,{...y,label:"Relationship",fullWidth:!0,size:"small",error:!!(n!=null&&n.relationship&&(l!=null&&l.relationship)),helperText:(n==null?void 0:n.relationship)&&(l==null?void 0:l.relationship)})}),e.jsxs(p,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:r.gender||"",onChange:i("gender"),error:!!(n.gender&&l.gender),helperText:n.gender&&l.gender,children:[e.jsx(V,{value:"male",children:"Male"}),e.jsx(V,{value:"female",children:"Female"})]})]}),e.jsxs(I,{children:[e.jsx(p,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:r.email||"",onChange:i("email"),error:!!(n.email&&l.email),helperText:n.email&&l.email}),e.jsx(p,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:r.phonenumber||"",onChange:i("phonenumber"),error:!!(n.phonenumber&&l.phonenumber),helperText:n.phonenumber&&l.phonenumber})]}),e.jsx(p,{label:"Residence Address",fullWidth:!0,size:"small",row:3,maxRows:3,value:r.address||"",onChange:i("address"),error:!!(n.address&&l.address),helperText:n.address&&l.address}),e.jsxs(I,{children:[e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",options:me,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:y=>y,value:r.residence||"",onChange:(y,P)=>t("residence",P),renderInput:y=>e.jsx(p,{...y,label:"Residence",fullWidth:!0,size:"small",error:!!(n.residence&&l.residence),helperText:n.residence&&l.residence})}),e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:de,noOptionsText:"No Nationality available",getOptionLabel:y=>y||"",value:r.nationality||"",onChange:(y,P)=>t("nationality",P),renderInput:y=>e.jsx(p,{...y,label:"Nationality",fullWidth:!0,size:"small",error:!!(n.nationality&&l.nationality),helperText:n.nationality&&l.nationality})})]}),e.jsx(h,{direction:"row",justifyContent:"flex-end",spacing:2,paddingY:4,children:e.jsx(be,{loading:b,variant:"contained",color:"primary",sx:{minWidth:{xs:100,sm:150}},onClick:j,children:"Save Changes"})})]})})})]})})};ue.propTypes={open:W.string,setOpen:W.func};const bi=({open:a,setOpen:s})=>{const{studentState:{newStudent:{parent:o}}}=C.useContext(ae),{schoolSessionDispatch:d}=C.useContext(O),c=ee(),{studentId:u}=ne(),{isLoading:f,mutateAsync:R}=te({mutationFn:yi}),r=(n,t)=>{n.parent1.student=u,n.parent2.student=u,R(n,{onSettled:()=>{c.invalidateQueries(["parent"]),t.setSubmitting(!1)},onSuccess:i=>{d(le(i)),l()},onError:i=>{d(re(i))}})},l=()=>s(!1);return e.jsxs(H,{maxWidth:"md",fullWidth:!0,open:a,onClose:l,children:[e.jsx(q,{title:"New Parent/Guardian Information",onClose:l}),e.jsx(Y,{children:e.jsx(fe,{initialValues:o,onSubmit:r,enableReinitialize:!0,validationSchema:Dn,children:({values:n,errors:t,touched:i,setFieldValue:j,handleChange:b,handleSubmit:y})=>{var P,B,M,E,L,A,G,Q,$,v,K,U,_,X,Ce,Se,Te,we,Pe,Ie,Re,ze,We,Ne,Ae,De,Be,Me,Ee,Oe,Le,ke,Fe,Ve,He,qe,Ye,Ge,Qe,$e,ve,Ke,Ue,_e,Xe,Ze,Je,en,nn,an,tn,ln,rn,sn,on,cn,pn,xn,mn,dn,hn,jn,yn,fn,bn,gn;return e.jsxs(h,{py:2,spacing:1,children:[e.jsxs("div",{style:{maxHeight:350,overflowY:"auto"},children:[e.jsxs(h,{py:2,spacing:1,children:[e.jsxs(h,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:[e.jsx(z,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Parent/Guardian Information"}),e.jsx(he,{sx:{width:30,height:30,bgcolor:"primary.main"},children:"1"})]}),e.jsxs(I,{children:[e.jsx(p,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:(P=n==null?void 0:n.parent1)==null?void 0:P.firstname,onChange:b("parent1.firstname"),error:!!((B=i.parent1)!=null&&B.firstname&&((M=t.parent1)!=null&&M.firstname)),helperText:((E=i.parent1)==null?void 0:E.firstname)&&((L=t.parent1)==null?void 0:L.firstname)}),e.jsx(p,{label:"Surname",fullWidth:!0,size:"small",value:(A=n==null?void 0:n.parent1)==null?void 0:A.surname,onChange:b("parent1.surname"),error:!!((G=i.parent1)!=null&&G.surname&&((Q=t.parent1)!=null&&Q.surname)),helperText:(($=i.parent1)==null?void 0:$.surname)&&((v=t.parent1)==null?void 0:v.surname)})]}),e.jsxs(I,{children:[e.jsxs(p,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:(K=n==null?void 0:n.parent1)==null?void 0:K.gender,onChange:b("parent1.gender"),error:!!((U=i.parent1)!=null&&U.gender&&((_=t.parent1)!=null&&_.gender)),helperText:((X=i.parent1)==null?void 0:X.gender)&&((Ce=t.parent1)==null?void 0:Ce.gender),children:[e.jsx(V,{value:"male",children:"Male"}),e.jsx(V,{value:"female",children:"Female"})]}),e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",options:xe,loadingText:"Please wait....",noOptionsText:"No Relationship available",getOptionLabel:x=>x||"",value:(Se=n==null?void 0:n.parent1)==null?void 0:Se.relationship,onInputChange:(x,m)=>j("parent1.relationship",m),renderInput:x=>{var m,S,T,w;return e.jsx(p,{...x,label:"Relationship",fullWidth:!0,size:"small",error:!!((m=i.parent1)!=null&&m.relationship&&((S=t.parent1)!=null&&S.relationship)),helperText:((T=i.parent1)==null?void 0:T.relationship)&&((w=t.parent1)==null?void 0:w.relationship)})}})]}),e.jsxs(I,{children:[e.jsx(p,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:(Te=n==null?void 0:n.parent1)==null?void 0:Te.email,onChange:b("parent1.email"),error:!!((we=i.parent1)!=null&&we.email&&((Pe=t.parent1)!=null&&Pe.email)),helperText:((Ie=i.parent1)==null?void 0:Ie.email)&&((Re=t.parent1)==null?void 0:Re.email)}),e.jsx(p,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(ze=n==null?void 0:n.parent1)==null?void 0:ze.phonenumber,onChange:b("parent1.phonenumber"),error:!!((We=i.parent1)!=null&&We.phonenumber&&((Ne=t.parent1)!=null&&Ne.phonenumber)),helperText:((Ae=i.parent1)==null?void 0:Ae.phonenumber)&&((De=t.parent1)==null?void 0:De.phonenumber)})]}),e.jsx(p,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,multiline:!0,value:(Be=n==null?void 0:n.parent1)==null?void 0:Be.address,onChange:b("parent1.address"),error:!!((Me=i.parent1)!=null&&Me.address&&((Ee=t.parent1)!=null&&Ee.address)),helperText:((Oe=i.parent1)==null?void 0:Oe.address)&&((Le=t.parent1)==null?void 0:Le.address)}),e.jsxs(I,{children:[e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",options:me,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:x=>x||"",value:(ke=n==null?void 0:n.parent1)==null?void 0:ke.residence,onChange:(x,m)=>j("parent1.residence",m),renderInput:x=>{var m,S,T,w;return e.jsx(p,{...x,label:"Residence",fullWidth:!0,size:"small",error:!!((m=i.parent1)!=null&&m.residence&&((S=t.parent1)!=null&&S.residence)),helperText:((T=i.parent1)==null?void 0:T.residence)&&((w=t.parent1)==null?void 0:w.residence)})}}),e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:de,noOptionsText:"No Nationality available",getOptionLabel:x=>x||"",value:(Fe=n==null?void 0:n.parent1)==null?void 0:Fe.nationality,onChange:(x,m)=>j("parent1.nationality",m),renderInput:x=>{var m,S,T,w;return e.jsx(p,{...x,label:"Nationality",fullWidth:!0,size:"small",error:!!((m=i.parent1)!=null&&m.nationality&&((S=t.parent1)!=null&&S.nationality)),helperText:((T=i.parent1)==null?void 0:T.nationality)&&((w=t.parent1)==null?void 0:w.nationality)})}})]})]}),e.jsxs(h,{py:2,spacing:1,children:[e.jsxs(h,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:[e.jsx(z,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Parent/Guardian Information"}),e.jsx(he,{sx:{width:30,height:30,bgcolor:"primary.main"},children:"2"})]}),e.jsxs(I,{children:[e.jsx(p,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:(Ve=n==null?void 0:n.parent2)==null?void 0:Ve.firstname,onChange:b("parent2.firstname"),error:!!((He=i.parent2)!=null&&He.firstname&&((qe=t.parent2)!=null&&qe.firstname)),helperText:((Ye=i.parent2)==null?void 0:Ye.firstname)&&((Ge=t.parent2)==null?void 0:Ge.firstname)}),e.jsx(p,{label:"Surname",fullWidth:!0,size:"small",value:(Qe=n==null?void 0:n.parent2)==null?void 0:Qe.surname,onChange:b("parent2.surname"),error:!!(($e=i.parent2)!=null&&$e.surname&&((ve=t.parent2)!=null&&ve.surname)),helperText:((Ke=i.parent2)==null?void 0:Ke.surname)&&((Ue=t.parent2)==null?void 0:Ue.surname)})]}),e.jsxs(I,{children:[e.jsxs(p,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:(_e=n==null?void 0:n.parent2)==null?void 0:_e.gender,onChange:b("parent2.gender"),error:!!((Xe=i.parent2)!=null&&Xe.gender&&((Ze=t.parent2)!=null&&Ze.gender)),helperText:((Je=i.parent2)==null?void 0:Je.gender)&&((en=t.parent2)==null?void 0:en.gender),children:[e.jsx(V,{value:"male",children:"Male"}),e.jsx(V,{value:"female",children:"Female"})]}),e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",options:xe,loadingText:"Please wait....",noOptionsText:"No Relationship available",getOptionLabel:x=>x||"",value:(nn=n==null?void 0:n.parent2)==null?void 0:nn.relationship,onInputChange:(x,m)=>j("parent2.relationship",m),renderInput:x=>{var m,S,T,w;return e.jsx(p,{...x,label:"Relationship",fullWidth:!0,size:"small",error:!!((m=i.parent2)!=null&&m.relationship&&((S=t.parent2)!=null&&S.relationship)),helperText:((T=i.parent2)==null?void 0:T.relationship)&&((w=t.parent2)==null?void 0:w.relationship)})}})]}),e.jsxs(I,{children:[e.jsx(p,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:(an=n==null?void 0:n.parent2)==null?void 0:an.email,onChange:b("parent2.email"),error:!!((tn=i.parent2)!=null&&tn.email&&((ln=t.parent2)!=null&&ln.email)),helperText:((rn=i.parent2)==null?void 0:rn.email)&&((sn=t.parent2)==null?void 0:sn.email)}),e.jsx(p,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(on=n==null?void 0:n.parent2)==null?void 0:on.phonenumber,onChange:b("parent2.phonenumber"),error:!!((cn=i.parent2)!=null&&cn.phonenumber&&((pn=t.parent2)!=null&&pn.phonenumber)),helperText:((xn=i.parent2)==null?void 0:xn.phonenumber)&&((mn=t.parent2)==null?void 0:mn.phonenumber)})]}),e.jsx(p,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,multiline:!0,value:(dn=n==null?void 0:n.parent2)==null?void 0:dn.address,onChange:b("parent2.address"),error:!!((hn=i.parent2)!=null&&hn.address&&((jn=t.parent2)!=null&&jn.address)),helperText:((yn=i.parent2)==null?void 0:yn.address)&&((fn=t.parent2)==null?void 0:fn.address)}),e.jsxs(I,{children:[e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",options:me,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:x=>x||"",value:(bn=n==null?void 0:n.parent2)==null?void 0:bn.residence,onChange:(x,m)=>j("parent2.residence",m),renderInput:x=>{var m,S,T,w;return e.jsx(p,{...x,label:"Residence",fullWidth:!0,size:"small",error:!!((m=i.parent2)!=null&&m.residence&&((S=t.parent2)!=null&&S.residence)),helperText:((T=i.parent2)==null?void 0:T.residence)&&((w=t.parent2)==null?void 0:w.residence)})}}),e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:de,noOptionsText:"No Nationality available",getOptionLabel:x=>x||"",value:(gn=n==null?void 0:n.parent2)==null?void 0:gn.nationality,onChange:(x,m)=>j("parent2.nationality",m),renderInput:x=>{var m,S,T,w;return e.jsx(p,{...x,label:"Nationality",fullWidth:!0,size:"small",error:!!((m=i.parent2)!=null&&m.nationality&&((S=t.parent2)!=null&&S.nationality)),helperText:((T=i.parent2)==null?void 0:T.nationality)&&((w=t.parent2)==null?void 0:w.nationality)})}})]})]})]}),e.jsx(h,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(be,{loading:f,variant:"contained",color:"primary",onClick:y,children:"Save"})})]})}})})]})},wn=({open:a,setOpen:s})=>{const{schoolSessionDispatch:o}=C.useContext(O),{studentDispatch:d}=C.useContext(ae),[c,u]=C.useState(!1),{studentId:f}=ne(),R=()=>s(!1),{isFetching:r,data:l}=Z({queryKey:["parent"],queryFn:()=>ji(f),enabled:!!f}),n=(i,j)=>{o({type:"sendQuickMessage",payload:{open:!0,data:{email:j,phonenumber:i}}})},t=i=>{d({type:"editParent",payload:{open:!0,data:i}})};return e.jsxs(e.Fragment,{children:[e.jsxs(H,{open:a,maxWidth:"sm",fullWidth:!0,onClose:R,children:[e.jsx(q,{title:"Parent Information",onClose:R}),e.jsxs(Y,{children:[r&&e.jsx(z,{children:"Loading...."}),(l==null?void 0:l.length)>0?l==null?void 0:l.map((i,j)=>e.jsxs(J,{children:[e.jsx(je,{flexItem:!0,children:e.jsx(pe,{label:`Parent /Guardian ${j+1}`,color:"primary"})}),e.jsx(g,{label:"Name",text:`${i==null?void 0:i.firstname} ${i==null?void 0:i.surname}`}),e.jsx(g,{label:"Relationship",text:i==null?void 0:i.relationship}),e.jsx(g,{label:"Gender",text:i==null?void 0:i.gender}),e.jsx(g,{label:"Email Address",text:i==null?void 0:i.email}),e.jsx(g,{label:"Telephone No.",text:i==null?void 0:i.phonenumber}),e.jsx(g,{label:"Address",text:i==null?void 0:i.address}),e.jsx(g,{label:"Residence",text:i==null?void 0:i.residence}),e.jsx(g,{label:"Nationality",text:i==null?void 0:i.nationality}),e.jsx(J,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",paddingY:2,gap:1,children:e.jsxs(h,{direction:"row",spacing:2,flexWrap:"wrap",children:[e.jsx(N,{size:"small",startIcon:e.jsx(Cn,{}),onClick:()=>n(i==null?void 0:i.phonenumber,i==null?void 0:i.email),children:"Send Message"}),e.jsx(N,{size:"small",endIcon:e.jsx(Bn,{}),onClick:()=>t(i),children:"Edit"})]})})]},i==null?void 0:i._id)):e.jsxs(J,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[e.jsx(z,{children:"No Parent info available"}),e.jsx(N,{onClick:()=>u(!0),children:"Add New"})]})]})]}),e.jsx(ue,{}),e.jsx(bi,{open:c,setOpen:u})]})};wn.propTypes={open:W.bool,setOpen:W.func};const gi=ge.memo(wn),Pn=({medical:a})=>{const s=ee(),{schoolSessionDispatch:o}=C.useContext(O),[d,c]=Sn(),{mutateAsync:u,isLoading:f}=te({mutationFn:ii}),R=(l,n)=>{u(l,{onSettled:()=>{s.invalidateQueries(["student-by-id"]),n.setSubmitting(!1)},onSuccess:t=>{o(le(t)),r()},onError:t=>{o(re(t))}})},r=()=>c({open:"false"});return e.jsxs(H,{open:d.get("open")==="true",maxWidth:"sm",fullWidth:!0,onClose:r,children:[e.jsx(q,{title:"Medical History",onClose:r}),e.jsx(Y,{children:e.jsx(fe,{initialValues:a,onSubmit:R,enableReinitialize:!0,validationSchema:Mn,children:({values:l,errors:n,touched:t,handleChange:i,handleSubmit:j,isSubmitting:b})=>{var y,P,B,M,E,L,A,G,Q,$,v,K,U,_,X;return e.jsxs(h,{padding:2,spacing:1,children:[e.jsx(h,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(be,{loading:b||f,variant:"contained",color:"primary",onClick:j,endIcon:e.jsx(hi,{}),children:"Save Changes"})}),e.jsxs(h,{width:{xs:"100%",md:"80%"},py:5,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(F,{title:"1. Heart Disease",value:l==null?void 0:l.heartDisease,setValue:i("heartDisease")}),e.jsx(F,{title:"2. Visual Impairment",value:l==null?void 0:l.visualImpairment,setValue:i("visualImpairment")})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(F,{title:"3. Asthma",value:l==null?void 0:l.asthma,setValue:i("asthma")}),e.jsx(F,{title:"4. Hearing Impairment",value:l==null?void 0:l.hearingImpairment,setValue:i("hearingImpairment")})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(F,{title:"5. Siezures",value:l==null?void 0:l.siezures,setValue:i("siezures")}),e.jsx(F,{title:"6. Physical Disability",value:l==null?void 0:l.physicalDisability,setValue:i("physicalDisability")})]})]}),e.jsxs(h,{py:2,spacing:1,children:[e.jsx(z,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Emergency Contact"}),e.jsxs(I,{children:[e.jsx(p,{label:"Fullname",type:"text",fullWidth:!0,size:"small",value:(y=l==null?void 0:l.emergencyContact)==null?void 0:y.fullname,onChange:i("emergencyContact.fullname"),error:!!((P=t==null?void 0:t.emergencyContact)!=null&&P.fullname&&((B=n==null?void 0:n.emergencyContact)!=null&&B.fullname)),helperText:((M=t==null?void 0:t.emergencyContact)==null?void 0:M.fullname)&&((E=n==null?void 0:n.emergencyContact)==null?void 0:E.fullname)}),e.jsx(p,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(L=l==null?void 0:l.emergencyContact)==null?void 0:L.phonenumber,onChange:i("emergencyContact.phonenumber"),error:!!((A=t==null?void 0:t.emergencyContact)!=null&&A.phonenumber&&((G=n==null?void 0:n.emergencyContact)!=null&&G.phonenumber)),helperText:((Q=t==null?void 0:t.emergencyContact)==null?void 0:Q.phonenumber)&&(($=n==null?void 0:n.emergencyContact)==null?void 0:$.phonenumber)})]}),e.jsx(I,{children:e.jsx(p,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,value:(v=l==null?void 0:l.emergencyContact)==null?void 0:v.address,onChange:i("emergencyContact.address"),error:!!((K=t==null?void 0:t.emergencyContact)!=null&&K.address&&((U=n==null?void 0:n.emergencyContact)!=null&&U.address)),helperText:((_=t==null?void 0:t.emergencyContact)==null?void 0:_.address)&&((X=n==null?void 0:n.emergencyContact)==null?void 0:X.address)})})]})]})}})})]})};Pn.propTypes={};const In=({report:a,open:s,setOpen:o})=>{const d=()=>o(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(H,{open:s,maxWidth:"md",fullWidth:!0,onClose:d,children:[e.jsx(q,{title:"Previous School Report",onClose:d}),e.jsx(Y,{sx:{display:"flex",flexDirection:"column",justifyContent:"center"},children:e.jsx("iframe",{style:{width:"100%",height:"5in"},src:a})})]}),e.jsx(ue,{})]})};In.propTypes={open:W.bool,setOpen:W.func};const ui=ge.memo(In),Rn=({student:a})=>{var P,B,M,E;const{type:s}=ne(),{schoolSessionDispatch:o}=C.useContext(O),{studentDispatch:d}=C.useContext(ae),c=ee(),[u,f]=C.useState(!1),[R,r]=C.useState(!1),[l,n]=Sn(),t=()=>{n({open:!0})},i=()=>{d({type:"editStudent",payload:{open:!0,data:a}})},{mutateAsync:j}=te(ai),b=()=>{Ln.fire({title:`${a!=null&&a.active?"Disable":"Enable"} Student Acoount`,text:`Do you want to ${a!=null&&a.active?"disable":"enable"} account?`,showCancelButton:!0,backdrop:!1}).then(({isConfirmed:L})=>{L&&j({id:a==null?void 0:a._id,active:a!=null&&a.active?"Yes":"No"},{onSettled:()=>{c.invalidateQueries(["student-by-id"])},onSuccess:A=>{o(le(A))},onError:A=>{o(re(A))}})})},y=()=>{r(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs(se,{children:[e.jsx(z,{variant:"h6",children:"Student Profile"}),e.jsxs(h,{direction:"row",justifyContent:"flex-end",alignItems:"center",columnGap:2,children:[e.jsx(N,{startIcon:e.jsx(un,{}),onClick:i,children:"Edit"}),e.jsx(N,{startIcon:e.jsx(En,{}),onClick:()=>f(!0),children:"Parent Info"}),e.jsx(N,{startIcon:e.jsx(xi,{}),onClick:t,children:"Medical Info"})]}),e.jsx(ie,{divider:!0,label:"Basic Info",icon:e.jsx(Tn,{})}),e.jsxs(h,{paddingY:2,children:[e.jsx(g,{label:"ID",text:a==null?void 0:a.indexnumber}),e.jsx(g,{label:"Name",text:a==null?void 0:a.fullName}),e.jsx(g,{label:"Date of Birth",text:On(new Date(a==null?void 0:a.dateofbirth)).format("Do MMMM, YYYY.")}),e.jsx(g,{label:"Gender",text:a==null?void 0:a.gender})]}),e.jsx(ie,{divider:!0,label:"Contact Info.",icon:e.jsx(mi,{})}),e.jsxs(h,{paddingY:2,children:[e.jsx(g,{label:"Email Address",text:a==null?void 0:a.email}),e.jsx(g,{label:"Telephone Number",text:a==null?void 0:a.phonenumber}),e.jsx(g,{label:"Address",text:a==null?void 0:a.address}),e.jsx(g,{label:"Residence",text:a==null?void 0:a.residence}),e.jsx(g,{label:"Nationality",text:a==null?void 0:a.nationality})]}),e.jsx(ie,{divider:!0,label:"Academic Info.",icon:e.jsx(un,{})}),e.jsxs(h,{paddingY:2,children:[e.jsx(g,{label:"Current Level",text:s||`${a==null?void 0:a.levelName} `}),e.jsx(g,{label:"Previous School",text:`${((B=(P=a==null?void 0:a.academic)==null?void 0:P.previousSchool)==null?void 0:B.name)||"Not Available"} `}),e.jsx(N,{startIcon:e.jsx(di,{}),onClick:y,variant:"contained",sx:{alignSelf:"flex-end"},children:"Previous Report"})]}),e.jsx(ie,{divider:!0,label:"Account Info.",icon:e.jsx(ci,{})}),e.jsx(g,{label:"Account Status",text:a!=null&&a.active?"Active":"Disabled"}),e.jsx(J,{sx:{display:"flex",justifyContent:"flex-end",paddingY:1},children:e.jsx(N,{variant:"contained",color:"error",endIcon:e.jsx(pi,{}),onClick:b,children:a!=null&&a.active?"Disable Account":"Enable Account"})})]}),e.jsx(ni,{}),e.jsx(gi,{open:u,setOpen:f}),e.jsx(Pn,{medical:{...a==null?void 0:a.medical,id:a==null?void 0:a._id}}),e.jsx(ui,{report:(E=(M=a==null?void 0:a.academic)==null?void 0:M.previousSchool)==null?void 0:E.report,open:R,setOpen:r})]})};Rn.propTypes={student:W.object};const zn=({data:a})=>{const{studentId:s}=ne();return e.jsxs(se,{children:[e.jsx(z,{variant:"h6",children:"Student Fees History"}),e.jsx(h,{sx:{width:"100%",maxHeight:"100vh",overflowY:"scroll"},children:(a==null?void 0:a.fees)!==void 0?e.jsx(e.Fragment,{children:a==null?void 0:a.fees.map(o=>{const d=kn();return e.jsx(li,{item:o,studentId:s},d)})}):e.jsx("div",{children:"No Fees History Available"})})]})};zn.propTypes={studentId:W.string};const Wn=({item:a})=>{var d;const{schoolSessionDispatch:s}=C.useContext(O),o=c=>{s({type:"openViewExamsRecord",payload:{open:!0,id:c}})};return e.jsx(Fn,{subheader:e.jsx(Vn,{sx:{bgcolor:"primary.main",color:"secondary.main"},children:a[0]}),sx:{paddingY:1},children:(d=a[1])==null?void 0:d.map(({term:c,_id:u,levelName:f})=>e.jsx(Hn,{onClick:()=>o(u),children:e.jsx(qn,{primary:f,secondary:c,primaryTypographyProps:{fontSize:14},secondaryTypographyProps:{fontSize:13,color:"primary.main",fontWeight:"bold"}})},u))})};Wn.propTypes={item:W.array};const Nn=()=>{const{palette:a}=Yn(),s=C.useRef(),{schoolSessionDispatch:o,schoolSessionState:{examsRecord:d}}=C.useContext(O),{data:c}=Z({queryKey:["student-exams-records",d.id],queryFn:()=>Gn(d.id),enabled:!!d.id}),u=()=>{o({type:"openViewExamsRecord",payload:{open:!1,id:""}})};return e.jsxs(e.Fragment,{children:[e.jsxs(H,{open:d.open,onClose:u,maxWidth:"md",fullWidth:!0,TransitionComponent:Qn,children:[e.jsx(q,{title:"Exams Details",onClose:u}),e.jsx($n,{children:e.jsx(vn,{trigger:()=>e.jsx(N,{variant:"contained",children:"Print Report"}),content:()=>s.current,documentTitle:"Report"})}),e.jsxs(Y,{children:[e.jsx(h,{direction:"row",spacing:2,children:e.jsxs(z,{variant:"h5",children:[c==null?void 0:c.level,"-",c==null?void 0:c.term]})}),e.jsx(h,{children:e.jsxs("table",{style:{textAlign:"center",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Subject"}),e.jsx("th",{children:" Class Score (50%)"}),e.jsx("th",{children:" Exams Score (50%)"}),e.jsx("th",{children:"Total Score (100%)"}),e.jsx("th",{children:"Grade"}),e.jsx("th",{children:"Remarks"})]})}),e.jsx("tbody",{children:(c==null?void 0:c.scores)!==void 0?(c==null?void 0:c.scores.length)!==0&&(c==null?void 0:c.scores.map(f=>e.jsx(Kn,{item:f},f.subject))):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",style:{padding:"3px 1px",fontSize:"20px"},children:"No Student Record Available"})})}),e.jsx("tfoot",{style:{textAlign:"center",textDecoration:"underline",borderTop:`solid 5px ${a.secondary.main}`,bgcolor:"primary.main",color:"primary.contrastText",width:"100%",padding:1},children:e.jsxs("tr",{children:[e.jsx("th",{children:"Overall Score"}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{children:c==null?void 0:c.overallScore}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{})]})})]})})]})]}),e.jsx("div",{className:"print-container",ref:s,children:e.jsx(ri,{student:c})})]})};Nn.propTypes={open:W.bool,setOpen:W.func};const Ci=ge.memo(Nn),Si=({data:a})=>e.jsxs(se,{children:[e.jsx(z,{variant:"h6",children:"Student Academics"}),e.jsx(h,{children:a!==void 0?e.jsx(e.Fragment,{children:a==null?void 0:a.map((s,o)=>e.jsx(Wn,{item:s},o))}):e.jsx("div",{children:"No Academic Records Available"})}),e.jsx(Ci,{})]}),Di=()=>{var i;const{userState:{session:a}}=C.useContext(Un),s=ee(),{studentId:o,type:d,id:c}=ne(),{schoolSessionDispatch:u}=C.useContext(O),[f,R]=C.useState("1"),{data:r}=Z({queryKey:["student-profile",o],queryFn:()=>ti(o),enabled:!!o,initialData:(i=s.getQueryData(["all-students"]))==null?void 0:i.find(j=>(j==null?void 0:j._id)===o)}),l=Z({queryKey:["student-academics",o],queryFn:()=>Jn(a,o,c),enabled:!!o&&!!c}),n=Z({queryKey:["student-fees",o],queryFn:()=>ei(o),enabled:!!o}),t=()=>{u({type:"sendQuickMessage",payload:{open:!0,data:{email:r==null?void 0:r.email,phonenumber:r==null?void 0:r.phonenumber}}})};return e.jsxs(e.Fragment,{children:[e.jsx(_n,{to:"/student/view",color:"primary.main"}),e.jsxs(se,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},justifyContent:{xs:"center",md:"space-between"},alignItems:{xs:"center",md:"start"},gap:5,pt:5},children:[e.jsxs(h,{spacing:1,justifyContent:"center",alignItems:"center",py:2,sx:{position:{xs:"relative",md:"-webkit-sticky"},top:0,minWidth:300},children:[e.jsx(he,{srcSet:(r==null?void 0:r.profile)===""||(r==null?void 0:r.profile)===void 0?null:r==null?void 0:r.profile,sx:{width:100,height:100}}),e.jsx(z,{children:r==null?void 0:r.indexnumber}),e.jsx(z,{variant:"h6",children:r==null?void 0:r.fullName}),e.jsx(z,{variant:"body2",children:d||`${r==null?void 0:r.levelName}`}),e.jsx(N,{variant:"contained",startIcon:e.jsx(Cn,{}),onClick:t,children:"Send Message"})]}),e.jsx(J,{sx:{flexGrow:1},children:e.jsxs(Xn,{value:f,children:[e.jsxs(Zn,{onChange:(j,b)=>R(b),variant:"scrollable",scrollButtons:"auto",children:[e.jsx(oe,{value:"1",label:"Profile",icon:e.jsx(Tn,{}),iconPosition:"start"}),e.jsx(oe,{value:"2",label:"Academic Records",icon:e.jsx(si,{}),iconPosition:"start"}),e.jsx(oe,{value:"3",label:"Fees History",icon:e.jsx(oi,{}),iconPosition:"start"})]}),e.jsx(je,{}),e.jsx(ce,{value:"1",children:e.jsx(Rn,{student:r})}),e.jsx(ce,{value:"2",children:e.jsx(Si,{data:l==null?void 0:l.data})}),e.jsx(ce,{value:"3",children:e.jsx(zn,{data:n==null?void 0:n.data})})]})})]})]})};export{Di as default};
