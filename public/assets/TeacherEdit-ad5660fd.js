import{g as R,H as Q,G as d,r as b,f as M,v as $,h as o,i as q,j as l,W as U,C as G,D as Y,n as _,X as H,J,S as z,Y as K,A as V,T as X,Z as j,b as p,p as Z,B as c,q as v,s as D,t as I,$ as h}from"./index-bb65b4bf.js";import{g as u,p as r}from"./teacherAPI-256d27ef.js";import{C as aa}from"./CustomDatePicker-05a8aa06.js";import{T as ia,N as na}from"./nationality-728e96f8.js";import{B as la}from"./Back-0ebcc4f3.js";import{C as ta}from"./CustomTitle-ed47c53b.js";import{M as L}from"./MenuItem-1edcf8db.js";import{A as N}from"./Autocomplete-95da27f3.js";import"./useMediaQuery-5f0ec7e9.js";import"./InputAdornment-321f8206.js";import"./ListItem-befde9c4.js";import"./listItemButtonClasses-9702db06.js";import"./ListItemSecondaryAction-c66bb893.js";import"./Chip-fa36c3a1.js";import"./ArrowBackRounded-54858719.js";import"./listItemTextClasses-35ff90f6.js";const ea=()=>{var W;const f=R(),w=Q(),{id:m}=d(),[T,C]=b.useState(null),[A,S]=b.useState(null),{schoolSessionDispatch:g}=b.useContext(M),t=$({queryKey:["teacher",m],queryFn:()=>u(m),initialData:(W=f.getQueryData(["teachers",m]))==null?void 0:W.find(n=>(n==null?void 0:n._id)===m),enabled:!!m});b.useEffect(()=>{var n,a;C(o((n=t==null?void 0:t.data)==null?void 0:n.dateofbirth)),S(`/images/users/${(a=t==null?void 0:t.data)==null?void 0:a.profile}`)},[t==null?void 0:t.data]);const{mutateAsync:E,isLoading:P}=q({mutationFn:r}),k=n=>{n==null||delete n.profile,n.dateofbirth=o(T).format("L"),E(n,{onSettled:()=>{f.invalidateQueries(["teachers"]),f.invalidateQueries(["teacher",m])},onSuccess:a=>{g(D(a)),B()},onError:a=>{g(I(a))}})},F=async n=>{var x;const a=(x=n.target)==null?void 0:x.files[0],i={_id:m,profile:a,type:"teachers"};try{const e=await h(i);g(D(e)),S(URL.createObjectURL(a))}catch(e){g(I(e))}f.invalidateQueries(["teachers"])},B=()=>{w(`/teacher/${m}`)};return t!=null&&t.isLoading?l.jsx(U,{}):l.jsxs(G,{children:[l.jsx(la,{to:`/teacher/${m}`,color:"primary.main"}),l.jsx(ta,{title:"Edit Teacher",subtitle:"Manage teachers profile",color:"primary.main"}),l.jsx(Y,{}),l.jsx(_,{initialValues:t==null?void 0:t.data,onSubmit:k,enableReinitialize:!0,validationSchema:H,children:({values:n,errors:a,touched:i,setFieldValue:x,handleChange:e,handleSubmit:O})=>l.jsx(l.Fragment,{children:l.jsx(J,{sx:{bgcolor:"#fff"},children:l.jsxs(z,{padding:2,spacing:1,children:[l.jsx(z,{alignSelf:"center",children:l.jsx(K,{handleImageUpload:F,children:l.jsx(V,{srcSet:A,sx:{width:120,height:120,alignSelf:"center"}})})}),l.jsx(X,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Personal information"}),l.jsxs(j,{children:[l.jsx(p,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:(n==null?void 0:n.firstname)||"",onChange:e("firstname"),error:!!(i!=null&&i.firstname&&(a!=null&&a.firstname)),helperText:(i==null?void 0:i.firstname)&&(a==null?void 0:a.firstname)}),l.jsx(p,{label:"Surname",fullWidth:!0,size:"small",value:(n==null?void 0:n.surname)||"",onChange:e("surname"),error:!!(i!=null&&i.surname&&(a!=null&&a.surname)),helperText:(i==null?void 0:i.surname)&&(a==null?void 0:a.surname)})]}),l.jsx(p,{label:"Username",fullWidth:!0,size:"small",value:(n==null?void 0:n.username)||"",onChange:e("username"),error:!!(i!=null&&i.username&&(a!=null&&a.username)),helperText:(i==null?void 0:i.username)&&(a==null?void 0:a.username)}),l.jsxs(j,{children:[l.jsx(aa,{label:"Date of Birth",date:T,setDate:C,disableFuture:!0,touched:!!(i!=null&&i.dateofbirth&&(a!=null&&a.dateofbirth)),error:(i==null?void 0:i.dateofbirth)&&(a==null?void 0:a.dateofbirth)}),l.jsxs(p,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:(n==null?void 0:n.gender)||"",onChange:e("gender"),error:!!(i!=null&&i.gender&&(a!=null&&a.gender)),helperText:(i==null?void 0:i.gender)&&(a==null?void 0:a.gender),children:[l.jsx(L,{value:"male",children:"male"}),l.jsx(L,{value:"female",children:"female"})]})]}),l.jsxs(j,{children:[l.jsx(p,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:(n==null?void 0:n.email)||"",onChange:e("email"),error:!!(i!=null&&i.email&&(a!=null&&a.email)),helperText:(i==null?void 0:i.email)&&(a==null?void 0:a.email)}),l.jsx(p,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(n==null?void 0:n.phonenumber)||"",onChange:e("phonenumber"),error:!!(i!=null&&i.phonenumber&&(a!=null&&a.phonenumber)),helperText:(i==null?void 0:i.phonenumber)&&(a==null?void 0:a.phonenumber)})]}),l.jsx(p,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,value:(n==null?void 0:n.address)||"",onChange:e("address"),error:!!(i!=null&&i.address&&(a!=null&&a.address)),helperText:(i==null?void 0:i.address)&&(a==null?void 0:a.address)}),l.jsxs(j,{children:[l.jsx(N,{freeSolo:!0,fullWidth:!0,size:"small",options:ia,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:s=>s||"",value:(n==null?void 0:n.residence)||"",onChange:(s,y)=>x("residence",y),renderInput:s=>l.jsx(p,{...s,label:"Residence",fullWidth:!0,size:"small",error:!!(i!=null&&i.residence&&(a!=null&&a.residence)),helperText:(i==null?void 0:i.residence)&&(a==null?void 0:a.residence)})}),l.jsx(N,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:na,noOptionsText:"No Nationality available",getOptionLabel:s=>s||"",value:(n==null?void 0:n.nationality)||"",onChange:(s,y)=>x("nationality",y),renderInput:s=>l.jsx(p,{...s,label:"Nationality",fullWidth:!0,size:"small",error:!!(i!=null&&i.nationality&&(a!=null&&a.nationality)),helperText:(i==null?void 0:i.nationality)&&(a==null?void 0:a.nationality)})})]}),l.jsxs(Z,{children:[l.jsx(c,{onClick:B,children:"Cancel"}),l.jsx(v,{loading:P,variant:"contained",color:"primary",sx:{minWidth:{xs:100,sm:150}},onClick:O,children:"Save Changes"})]})]})})})})]})};ea.propTypes={};export{ea as default};
