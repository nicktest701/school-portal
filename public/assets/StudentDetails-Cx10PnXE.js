import{p as k,j as e,D as je,s as fe,V as A,b as ee,r as C,fl as te,S as L,d as ae,t as H,v as q,w as Y,x as ye,fZ as An,k as h,T as p,a0 as V,B as z,g as re,h as le,i as ne,fK as Nn,l as W,A as pe,X as be,c as Z,P as J,E as Dn,a as un,fL as Bn,C as oe,m as Mn,f as En,L as Ln,bt as On,am as kn,a1 as Fn}from"./index-B8PQHtjc.js";import Vn from"./StudentEdit-Ctu6XxqB.js";import{P as b,M as Cn}from"./ProfileItem-D0GorG9a.js";import{u as Hn,d as qn,e as Yn}from"./studentAPI-DyXUet_8.js";import{C as me}from"./Chip-DmEpgF7y.js";import{C as I}from"./CustomFormControl-Duiznp8E.js";import{T as xe,N as de}from"./nationality-Dhsqpti8.js";import{h as he}from"./sessionColumns-oq904N9H.js";import{A as D,L as Gn}from"./Autocomplete-Dw57Ihk7.js";import{M as F}from"./MedicalAllergy-8xDJIAcn.js";import{P as $n}from"./Person-mhly5Vw0.js";import{P as Sn}from"./PersonRounded-DGWhQpwP.js";import{S as Qn}from"./StudentFeeReportListItem-3cmnK17A.js";import{v as vn}from"./v4-C6aID195.js";import{L as Kn}from"./ListItemButton-Di0YOqWQ.js";import{L as _n}from"./ListItemText-DzMM1D1F.js";import{l as Un}from"./index-DThQnLGZ.js";import{g as Xn,h as Zn}from"./ExaminationAPI-gfcTwHm9.js";import{E as Jn}from"./ReportItemUnderline-MmYFOo6z.js";import{R as ei}from"./ReportCard-RdGRC-ge.js";import{D as ni}from"./DialogActions-BmNk8sop.js";import{B as ii}from"./Back-D8wcFeGb.js";import{f as ti}from"./currentFeeAPI-CpZ1DJJI.js";import{T as ai,a as ri,b as se,c as ce}from"./TabPanel-WHfZdNAn.js";import{R as li}from"./ReportRounded-783hZjIF.js";import{N as oi}from"./NoteRounded-DYrWuwPi.js";import"./CustomDatePicker-_ngoDY-2.js";import"./AdapterMoment-BOypM_74.js";import"./index-BqG4A_N5.js";import"./useThemeProps-CEPKeDia.js";import"./generateUtilityClasses-BPC_uuYP.js";import"./createTheme-DxYQS8Dz.js";import"./createStyled-CJd69Mvg.js";import"./InputAdornment-DAOlZ4uj.js";import"./ListItem-CQImyTSy.js";import"./ListItemSecondaryAction-DOVMjMKm.js";import"./listItemButtonClasses-DySKLRoc.js";import"./CustomImageChooser-CGe9XgpC.js";import"./currencyFormatter-DjBDW3hY.js";import"./CircleRounded-YWo57tpF.js";import"./Link-kLE4_HTq.js";const si=k(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 3c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6m7 13H5v-.23c0-.62.28-1.2.76-1.58C7.47 15.82 9.64 15 12 15s4.53.82 6.24 2.19c.48.38.76.97.76 1.58z"}),"AccountBoxRounded"),ci=k(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zm3.17-6.41a.996.996 0 0 1 0-1.41c.39-.39 1.02-.39 1.41 0L12 12.59l1.41-1.41c.39-.39 1.02-.39 1.41 0s.39 1.02 0 1.41L13.41 14l1.41 1.41c.39.39.39 1.02 0 1.41s-1.02.39-1.41 0L12 15.41l-1.41 1.41c-.39.39-1.02.39-1.41 0a.996.996 0 0 1 0-1.41L10.59 14zM18 4h-2.5l-.71-.71c-.18-.18-.44-.29-.7-.29H9.91c-.26 0-.52.11-.7.29L8.5 4H6c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1"}),"DeleteForeverRounded"),gn=k(e.jsx("path",{d:"M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1q-.15.15-.15.36M20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"EditRounded"),pi=k(e.jsx("path",{d:"M20 7h-5V4c0-1.1-.9-2-2-2h-2c-1.1 0-2 .9-2 2v3H4c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2m-9-3h2v5h-2zM7 16H6c-.55 0-1-.45-1-1s.45-1 1-1h1v-1c0-.55.45-1 1-1s1 .45 1 1v1h1c.55 0 1 .45 1 1s-.45 1-1 1H9v1c0 .55-.45 1-1 1s-1-.45-1-1zm6.75-1.5c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h4.5c.41 0 .75.34.75.75s-.34.75-.75.75zm0 3c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h2.5c.41 0 .75.34.75.75s-.34.75-.75.75z"}),"MedicalInformationRounded"),mi=k(e.jsx("path",{d:"m19.23 15.26-2.54-.29c-.61-.07-1.21.14-1.64.57l-1.84 1.84c-2.83-1.44-5.15-3.75-6.59-6.59l1.85-1.85c.43-.43.64-1.03.57-1.64l-.29-2.52c-.12-1.01-.97-1.77-1.99-1.77H5.03c-1.13 0-2.07.94-2 2.07.53 8.54 7.36 15.36 15.89 15.89 1.13.07 2.07-.87 2.07-2v-1.73c.01-1.01-.75-1.86-1.76-1.98"}),"PhoneRounded"),xi=k(e.jsx("path",{d:"M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27zM12 17.3c-.72 0-1.3-.58-1.3-1.3s.58-1.3 1.3-1.3 1.3.58 1.3 1.3-.58 1.3-1.3 1.3m1-4.3h-2V7h2z"}),"Report"),di=k(e.jsx("path",{d:"M21 12.4V7l-4-4H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h7.4zM15 15c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3M6 6h9v4H6zm13.99 10.25 1.77 1.77L16.77 23H15v-1.77zm3.26.26-.85.85-1.77-1.77.85-.85c.2-.2.51-.2.71 0l1.06 1.06c.2.2.2.52 0 .71"}),"SaveAs"),ie=({divider:t,label:o,icon:s})=>t?e.jsx(je,{textAlign:"left",children:e.jsx(me,{label:o,size:"small",color:"primary",icon:s||null,sx:{bgcolor:"info.lighter",color:"info.darker"}})}):e.jsx(me,{label:o,size:"small",color:"primary",icon:s||null}),hi=async t=>{try{return(await fe({method:"GET",url:"/parents/student",params:{id:t}})).data}catch(o){return o.response.data}},ji=async t=>{try{return(await fe({method:"POST",url:"/parents",data:t})).data}catch(o){return o.response.data}},fi=async t=>{try{return(await fe({method:"PUT",url:"/parents",data:t})).data}catch(o){return o.response.data}},ge=()=>{var P;const t=ee(),{studentState:o,studentDispatch:s}=C.useContext(te),{schoolSessionDispatch:d}=C.useContext(L),{mutateAsync:c}=ae({mutationFn:fi}),g=(l,r)=>{c(l,{onSettled:()=>{t.invalidateQueries(["parent"]),r.setSubmitting(!1)},onSuccess:n=>{d(re(n)),u()},onError:n=>{d(le(n))}})},u=()=>{s({type:"editParent",payload:{open:!1,data:{}}})};return e.jsx(e.Fragment,{children:e.jsxs(H,{maxWidth:"md",fullWidth:!0,open:o==null?void 0:o.editParentData.open,onClose:u,children:[e.jsx(q,{title:"Edit Parent/Guardian Information",onClose:u}),e.jsx(Y,{children:e.jsx(ye,{initialValues:(P=o==null?void 0:o.editParentData)==null?void 0:P.data,onSubmit:g,enableReinitialize:!0,validationSchema:An,children:({values:l,errors:r,touched:n,setFieldValue:a,handleChange:i,handleSubmit:j,isSubmitting:y})=>e.jsxs(h,{padding:2,spacing:1,children:[e.jsxs(I,{children:[e.jsx(p,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:l.firstname||"",onChange:i("firstname"),error:!!(n.firstname&&r.firstname),helperText:n.firstname&&r.firstname}),e.jsx(p,{label:"Surname",fullWidth:!0,size:"small",value:l.surname||"",onChange:i("surname"),error:!!(n.surname&&r.surname),helperText:n.surname&&r.surname})]}),e.jsxs(I,{children:[e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",options:he,loadingText:"Please wait....",noOptionsText:"No Relationship available",getOptionLabel:f=>f||"",value:l==null?void 0:l.relationship,onInputChange:(f,R)=>a("relationship",R),renderInput:f=>e.jsx(p,{...f,label:"Relationship",fullWidth:!0,size:"small",error:!!(n!=null&&n.relationship&&(r!=null&&r.relationship)),helperText:(n==null?void 0:n.relationship)&&(r==null?void 0:r.relationship)})}),e.jsxs(p,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:l.gender||"",onChange:i("gender"),error:!!(n.gender&&r.gender),helperText:n.gender&&r.gender,children:[e.jsx(V,{value:"male",children:"Male"}),e.jsx(V,{value:"female",children:"Female"})]})]}),e.jsxs(I,{children:[e.jsx(p,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:l.email||"",onChange:i("email"),error:!!(n.email&&r.email),helperText:n.email&&r.email}),e.jsx(p,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:l.phonenumber||"",onChange:i("phonenumber"),error:!!(n.phonenumber&&r.phonenumber),helperText:n.phonenumber&&r.phonenumber})]}),e.jsx(p,{label:"Residence Address",fullWidth:!0,size:"small",row:3,maxRows:3,value:l.address||"",onChange:i("address"),error:!!(n.address&&r.address),helperText:n.address&&r.address}),e.jsxs(I,{children:[e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",options:xe,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:f=>f,value:l.residence||"",onChange:(f,R)=>a("residence",R),renderInput:f=>e.jsx(p,{...f,label:"Residence",fullWidth:!0,size:"small",error:!!(n.residence&&r.residence),helperText:n.residence&&r.residence})}),e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:de,noOptionsText:"No Nationality available",getOptionLabel:f=>f||"",value:l.nationality||"",onChange:(f,R)=>a("nationality",R),renderInput:f=>e.jsx(p,{...f,label:"Nationality",fullWidth:!0,size:"small",error:!!(n.nationality&&r.nationality),helperText:n.nationality&&r.nationality})})]}),e.jsx(h,{direction:"row",justifyContent:"flex-end",spacing:2,paddingY:4,children:e.jsx(z,{loading:y,variant:"contained",color:"primary",sx:{minWidth:{xs:100,sm:150}},onClick:j,children:"Save Changes"})})]})})})]})})};ge.propTypes={open:A.string,setOpen:A.func};const yi=({open:t,setOpen:o})=>{const{studentState:{newStudent:{parent:s}}}=C.useContext(te),{schoolSessionDispatch:d}=C.useContext(L),c=ee(),{studentId:g}=ne(),{isPending:u,mutateAsync:P}=ae({mutationFn:ji}),l=(n,a)=>{n.parent1.student=g,n.parent2.student=g,P(n,{onSettled:()=>{c.invalidateQueries(["parent"]),a.setSubmitting(!1)},onSuccess:i=>{d(re(i)),r()},onError:i=>{d(le(i))}})},r=()=>o(!1);return e.jsxs(H,{maxWidth:"md",fullWidth:!0,open:t,onClose:r,children:[e.jsx(q,{title:"New Parent/Guardian Information",onClose:r}),e.jsx(Y,{children:e.jsx(ye,{initialValues:s,onSubmit:l,enableReinitialize:!0,validationSchema:Nn,children:({values:n,errors:a,touched:i,setFieldValue:j,handleChange:y,handleSubmit:f})=>{var R,B,M,E,O,N,G,$,Q,v,K,_,U,X,ue,Ce,Se,Te,we,Pe,Re,Ie,ze,We,Ae,Ne,De,Be,Me,Ee,Le,Oe,ke,Fe,Ve,He,qe,Ye,Ge,$e,Qe,ve,Ke,_e,Ue,Xe,Ze,Je,en,nn,tn,an,rn,ln,on,sn,cn,pn,mn,xn,dn,hn,jn,fn,yn,bn;return e.jsxs(h,{py:2,spacing:1,children:[e.jsxs("div",{style:{maxHeight:350,overflowY:"auto"},children:[e.jsxs(h,{py:2,spacing:1,children:[e.jsxs(h,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:[e.jsx(W,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Parent/Guardian Information"}),e.jsx(pe,{sx:{width:30,height:30,bgcolor:"primary.main"},children:"1"})]}),e.jsxs(I,{children:[e.jsx(p,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:(R=n==null?void 0:n.parent1)==null?void 0:R.firstname,onChange:y("parent1.firstname"),error:!!((B=i.parent1)!=null&&B.firstname&&((M=a.parent1)!=null&&M.firstname)),helperText:((E=i.parent1)==null?void 0:E.firstname)&&((O=a.parent1)==null?void 0:O.firstname)}),e.jsx(p,{label:"Surname",fullWidth:!0,size:"small",value:(N=n==null?void 0:n.parent1)==null?void 0:N.surname,onChange:y("parent1.surname"),error:!!((G=i.parent1)!=null&&G.surname&&(($=a.parent1)!=null&&$.surname)),helperText:((Q=i.parent1)==null?void 0:Q.surname)&&((v=a.parent1)==null?void 0:v.surname)})]}),e.jsxs(I,{children:[e.jsxs(p,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:(K=n==null?void 0:n.parent1)==null?void 0:K.gender,onChange:y("parent1.gender"),error:!!((_=i.parent1)!=null&&_.gender&&((U=a.parent1)!=null&&U.gender)),helperText:((X=i.parent1)==null?void 0:X.gender)&&((ue=a.parent1)==null?void 0:ue.gender),children:[e.jsx(V,{value:"male",children:"Male"}),e.jsx(V,{value:"female",children:"Female"})]}),e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",options:he,loadingText:"Please wait....",noOptionsText:"No Relationship available",getOptionLabel:m=>m||"",value:(Ce=n==null?void 0:n.parent1)==null?void 0:Ce.relationship,onInputChange:(m,x)=>j("parent1.relationship",x),renderInput:m=>{var x,S,T,w;return e.jsx(p,{...m,label:"Relationship",fullWidth:!0,size:"small",error:!!((x=i.parent1)!=null&&x.relationship&&((S=a.parent1)!=null&&S.relationship)),helperText:((T=i.parent1)==null?void 0:T.relationship)&&((w=a.parent1)==null?void 0:w.relationship)})}})]}),e.jsxs(I,{children:[e.jsx(p,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:(Se=n==null?void 0:n.parent1)==null?void 0:Se.email,onChange:y("parent1.email"),error:!!((Te=i.parent1)!=null&&Te.email&&((we=a.parent1)!=null&&we.email)),helperText:((Pe=i.parent1)==null?void 0:Pe.email)&&((Re=a.parent1)==null?void 0:Re.email)}),e.jsx(p,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(Ie=n==null?void 0:n.parent1)==null?void 0:Ie.phonenumber,onChange:y("parent1.phonenumber"),error:!!((ze=i.parent1)!=null&&ze.phonenumber&&((We=a.parent1)!=null&&We.phonenumber)),helperText:((Ae=i.parent1)==null?void 0:Ae.phonenumber)&&((Ne=a.parent1)==null?void 0:Ne.phonenumber)})]}),e.jsx(p,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,multiline:!0,value:(De=n==null?void 0:n.parent1)==null?void 0:De.address,onChange:y("parent1.address"),error:!!((Be=i.parent1)!=null&&Be.address&&((Me=a.parent1)!=null&&Me.address)),helperText:((Ee=i.parent1)==null?void 0:Ee.address)&&((Le=a.parent1)==null?void 0:Le.address)}),e.jsxs(I,{children:[e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",options:xe,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:m=>m||"",value:(Oe=n==null?void 0:n.parent1)==null?void 0:Oe.residence,onChange:(m,x)=>j("parent1.residence",x),renderInput:m=>{var x,S,T,w;return e.jsx(p,{...m,label:"Residence",fullWidth:!0,size:"small",error:!!((x=i.parent1)!=null&&x.residence&&((S=a.parent1)!=null&&S.residence)),helperText:((T=i.parent1)==null?void 0:T.residence)&&((w=a.parent1)==null?void 0:w.residence)})}}),e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:de,noOptionsText:"No Nationality available",getOptionLabel:m=>m||"",value:(ke=n==null?void 0:n.parent1)==null?void 0:ke.nationality,onChange:(m,x)=>j("parent1.nationality",x),renderInput:m=>{var x,S,T,w;return e.jsx(p,{...m,label:"Nationality",fullWidth:!0,size:"small",error:!!((x=i.parent1)!=null&&x.nationality&&((S=a.parent1)!=null&&S.nationality)),helperText:((T=i.parent1)==null?void 0:T.nationality)&&((w=a.parent1)==null?void 0:w.nationality)})}})]})]}),e.jsxs(h,{py:2,spacing:1,children:[e.jsxs(h,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:[e.jsx(W,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Parent/Guardian Information"}),e.jsx(pe,{sx:{width:30,height:30,bgcolor:"primary.main"},children:"2"})]}),e.jsxs(I,{children:[e.jsx(p,{label:"Firstname",type:"text",fullWidth:!0,size:"small",value:(Fe=n==null?void 0:n.parent2)==null?void 0:Fe.firstname,onChange:y("parent2.firstname"),error:!!((Ve=i.parent2)!=null&&Ve.firstname&&((He=a.parent2)!=null&&He.firstname)),helperText:((qe=i.parent2)==null?void 0:qe.firstname)&&((Ye=a.parent2)==null?void 0:Ye.firstname)}),e.jsx(p,{label:"Surname",fullWidth:!0,size:"small",value:(Ge=n==null?void 0:n.parent2)==null?void 0:Ge.surname,onChange:y("parent2.surname"),error:!!(($e=i.parent2)!=null&&$e.surname&&((Qe=a.parent2)!=null&&Qe.surname)),helperText:((ve=i.parent2)==null?void 0:ve.surname)&&((Ke=a.parent2)==null?void 0:Ke.surname)})]}),e.jsxs(I,{children:[e.jsxs(p,{label:"Gender",select:!0,fullWidth:!0,size:"small",value:(_e=n==null?void 0:n.parent2)==null?void 0:_e.gender,onChange:y("parent2.gender"),error:!!((Ue=i.parent2)!=null&&Ue.gender&&((Xe=a.parent2)!=null&&Xe.gender)),helperText:((Ze=i.parent2)==null?void 0:Ze.gender)&&((Je=a.parent2)==null?void 0:Je.gender),children:[e.jsx(V,{value:"male",children:"Male"}),e.jsx(V,{value:"female",children:"Female"})]}),e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",options:he,loadingText:"Please wait....",noOptionsText:"No Relationship available",getOptionLabel:m=>m||"",value:(en=n==null?void 0:n.parent2)==null?void 0:en.relationship,onInputChange:(m,x)=>j("parent2.relationship",x),renderInput:m=>{var x,S,T,w;return e.jsx(p,{...m,label:"Relationship",fullWidth:!0,size:"small",error:!!((x=i.parent2)!=null&&x.relationship&&((S=a.parent2)!=null&&S.relationship)),helperText:((T=i.parent2)==null?void 0:T.relationship)&&((w=a.parent2)==null?void 0:w.relationship)})}})]}),e.jsxs(I,{children:[e.jsx(p,{label:"Email",fullWidth:!0,size:"small",row:3,maxRows:3,value:(nn=n==null?void 0:n.parent2)==null?void 0:nn.email,onChange:y("parent2.email"),error:!!((tn=i.parent2)!=null&&tn.email&&((an=a.parent2)!=null&&an.email)),helperText:((rn=i.parent2)==null?void 0:rn.email)&&((ln=a.parent2)==null?void 0:ln.email)}),e.jsx(p,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(on=n==null?void 0:n.parent2)==null?void 0:on.phonenumber,onChange:y("parent2.phonenumber"),error:!!((sn=i.parent2)!=null&&sn.phonenumber&&((cn=a.parent2)!=null&&cn.phonenumber)),helperText:((pn=i.parent2)==null?void 0:pn.phonenumber)&&((mn=a.parent2)==null?void 0:mn.phonenumber)})]}),e.jsx(p,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,multiline:!0,value:(xn=n==null?void 0:n.parent2)==null?void 0:xn.address,onChange:y("parent2.address"),error:!!((dn=i.parent2)!=null&&dn.address&&((hn=a.parent2)!=null&&hn.address)),helperText:((jn=i.parent2)==null?void 0:jn.address)&&((fn=a.parent2)==null?void 0:fn.address)}),e.jsxs(I,{children:[e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",options:xe,loadingText:"Please wait....",noOptionsText:"No Town available",getOptionLabel:m=>m||"",value:(yn=n==null?void 0:n.parent2)==null?void 0:yn.residence,onChange:(m,x)=>j("parent2.residence",x),renderInput:m=>{var x,S,T,w;return e.jsx(p,{...m,label:"Residence",fullWidth:!0,size:"small",error:!!((x=i.parent2)!=null&&x.residence&&((S=a.parent2)!=null&&S.residence)),helperText:((T=i.parent2)==null?void 0:T.residence)&&((w=a.parent2)==null?void 0:w.residence)})}}),e.jsx(D,{freeSolo:!0,fullWidth:!0,size:"small",loadingText:"Please wait....",options:de,noOptionsText:"No Nationality available",getOptionLabel:m=>m||"",value:(bn=n==null?void 0:n.parent2)==null?void 0:bn.nationality,onChange:(m,x)=>j("parent2.nationality",x),renderInput:m=>{var x,S,T,w;return e.jsx(p,{...m,label:"Nationality",fullWidth:!0,size:"small",error:!!((x=i.parent2)!=null&&x.nationality&&((S=a.parent2)!=null&&S.nationality)),helperText:((T=i.parent2)==null?void 0:T.nationality)&&((w=a.parent2)==null?void 0:w.nationality)})}})]})]})]}),e.jsx(h,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(z,{loading:u,variant:"contained",color:"primary",onClick:f,children:"Save"})})]})}})})]})},Tn=({open:t,setOpen:o})=>{const{schoolSessionDispatch:s}=C.useContext(L),{studentDispatch:d}=C.useContext(te),[c,g]=C.useState(!1),{studentId:u}=ne(),P=()=>o(!1),{isFetching:l,data:r}=Z({queryKey:["parent"],queryFn:()=>hi(u),enabled:!!u}),n=(i,j)=>{s({type:"sendQuickMessage",payload:{open:!0,data:{email:j,phonenumber:i}}})},a=i=>{d({type:"editParent",payload:{open:!0,data:i}})};return e.jsxs(e.Fragment,{children:[e.jsxs(H,{open:t,maxWidth:"sm",fullWidth:!0,onClose:P,children:[e.jsx(q,{title:"Parent Information",onClose:P}),e.jsxs(Y,{children:[l&&e.jsx(W,{children:"Loading...."}),(r==null?void 0:r.length)>0?r==null?void 0:r.map((i,j)=>e.jsxs(J,{children:[e.jsx(je,{flexItem:!0,children:e.jsx(me,{label:`Parent /Guardian ${j+1}`,color:"primary"})}),e.jsx(b,{label:"Name",text:`${i==null?void 0:i.firstname} ${i==null?void 0:i.surname}`}),e.jsx(b,{label:"Relationship",text:i==null?void 0:i.relationship}),e.jsx(b,{label:"Gender",text:i==null?void 0:i.gender}),e.jsx(b,{label:"Email Address",text:i==null?void 0:i.email}),e.jsx(b,{label:"Telephone No.",text:i==null?void 0:i.phonenumber}),e.jsx(b,{label:"Address",text:i==null?void 0:i.address}),e.jsx(b,{label:"Residence",text:i==null?void 0:i.residence}),e.jsx(b,{label:"Nationality",text:i==null?void 0:i.nationality}),e.jsx(J,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",paddingY:2,gap:1,children:e.jsxs(h,{direction:"row",spacing:2,flexWrap:"wrap",children:[e.jsx(z,{size:"small",startIcon:e.jsx(Cn,{}),onClick:()=>n(i==null?void 0:i.phonenumber,i==null?void 0:i.email),children:"Send Message"}),e.jsx(z,{size:"small",endIcon:e.jsx(Dn,{}),onClick:()=>a(i),children:"Edit"})]})})]},i==null?void 0:i._id)):e.jsxs(J,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[e.jsx(W,{children:"No Parent info available"}),e.jsx(z,{onClick:()=>g(!0),children:"Add New"})]})]})]}),e.jsx(ge,{}),e.jsx(yi,{open:c,setOpen:g})]})};Tn.propTypes={open:A.bool,setOpen:A.func};const bi=be.memo(Tn),wn=({medical:t})=>{const o=ee(),{schoolSessionDispatch:s}=C.useContext(L),[d,c]=un(),{mutateAsync:g,isPending:u}=ae({mutationFn:Hn}),P=(r,n)=>{g(r,{onSettled:()=>{o.invalidateQueries(["student-by-id"]),n.setSubmitting(!1)},onSuccess:a=>{s(re(a)),l()},onError:a=>{s(le(a))}})},l=()=>c({open:"false"});return e.jsxs(H,{open:d.get("open")==="true",maxWidth:"sm",fullWidth:!0,onClose:l,children:[e.jsx(q,{title:"Medical History",onClose:l}),e.jsx(Y,{children:e.jsx(ye,{initialValues:t,onSubmit:P,enableReinitialize:!0,validationSchema:Bn,children:({values:r,errors:n,touched:a,handleChange:i,handleSubmit:j,isSubmitting:y})=>{var f,R,B,M,E,O,N,G,$,Q,v,K,_,U,X;return e.jsxs(h,{padding:2,spacing:1,children:[e.jsx(h,{direction:"row",justifyContent:"flex-end",spacing:2,children:e.jsx(z,{loading:y||u,variant:"contained",color:"primary",onClick:j,endIcon:e.jsx(di,{}),children:"Save Changes"})}),e.jsxs(h,{width:{xs:"100%",md:"80%"},py:5,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(F,{title:"1. Heart Disease",value:r==null?void 0:r.heartDisease,setValue:i("heartDisease")}),e.jsx(F,{title:"2. Visual Impairment",value:r==null?void 0:r.visualImpairment,setValue:i("visualImpairment")})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(F,{title:"3. Asthma",value:r==null?void 0:r.asthma,setValue:i("asthma")}),e.jsx(F,{title:"4. Hearing Impairment",value:r==null?void 0:r.hearingImpairment,setValue:i("hearingImpairment")})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[e.jsx(F,{title:"5. Siezures",value:r==null?void 0:r.siezures,setValue:i("siezures")}),e.jsx(F,{title:"6. Physical Disability",value:r==null?void 0:r.physicalDisability,setValue:i("physicalDisability")})]})]}),e.jsxs(h,{py:2,spacing:1,children:[e.jsx(W,{variant:"body2",color:"primary.main",sx:{fontWeight:"bold"},children:"Emergency Contact"}),e.jsxs(I,{children:[e.jsx(p,{label:"Fullname",type:"text",fullWidth:!0,size:"small",value:(f=r==null?void 0:r.emergencyContact)==null?void 0:f.fullname,onChange:i("emergencyContact.fullname"),error:!!((R=a==null?void 0:a.emergencyContact)!=null&&R.fullname&&((B=n==null?void 0:n.emergencyContact)!=null&&B.fullname)),helperText:((M=a==null?void 0:a.emergencyContact)==null?void 0:M.fullname)&&((E=n==null?void 0:n.emergencyContact)==null?void 0:E.fullname)}),e.jsx(p,{label:"Telephone No.",inputMode:"tel",type:"tel",fullWidth:!0,size:"small",value:(O=r==null?void 0:r.emergencyContact)==null?void 0:O.phonenumber,onChange:i("emergencyContact.phonenumber"),error:!!((N=a==null?void 0:a.emergencyContact)!=null&&N.phonenumber&&((G=n==null?void 0:n.emergencyContact)!=null&&G.phonenumber)),helperText:(($=a==null?void 0:a.emergencyContact)==null?void 0:$.phonenumber)&&((Q=n==null?void 0:n.emergencyContact)==null?void 0:Q.phonenumber)})]}),e.jsx(I,{children:e.jsx(p,{label:"Address",fullWidth:!0,size:"small",row:3,maxRows:3,value:(v=r==null?void 0:r.emergencyContact)==null?void 0:v.address,onChange:i("emergencyContact.address"),error:!!((K=a==null?void 0:a.emergencyContact)!=null&&K.address&&((_=n==null?void 0:n.emergencyContact)!=null&&_.address)),helperText:((U=a==null?void 0:a.emergencyContact)==null?void 0:U.address)&&((X=n==null?void 0:n.emergencyContact)==null?void 0:X.address)})})]})]})}})})]})};wn.propTypes={};const Pn=({report:t,open:o,setOpen:s})=>{const d=()=>s(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(H,{open:o,maxWidth:"md",fullWidth:!0,onClose:d,children:[e.jsx(q,{title:"Previous School Report",onClose:d}),e.jsx(Y,{sx:{display:"flex",flexDirection:"column",justifyContent:"center"},children:e.jsx("iframe",{style:{width:"100%",height:"5in"},src:t})})]}),e.jsx(ge,{})]})};Pn.propTypes={open:A.bool,setOpen:A.func};const gi=be.memo(Pn),Rn=({student:t})=>{var R,B,M,E;const{type:o}=ne(),{schoolSessionDispatch:s}=C.useContext(L),{studentDispatch:d}=C.useContext(te),c=ee(),[g,u]=C.useState(!1),[P,l]=C.useState(!1),[r,n]=un(),a=()=>{n({open:!0})},i=()=>{d({type:"editStudent",payload:{open:!0,data:t}})},{mutateAsync:j}=ae(qn),y=()=>{En.fire({title:`${t!=null&&t.active?"Disable":"Enable"} Student Acoount`,text:`Do you want to ${t!=null&&t.active?"disable":"enable"} account?`,showCancelButton:!0,backdrop:!1}).then(({isConfirmed:O})=>{O&&j({id:t==null?void 0:t._id,active:t!=null&&t.active?"Yes":"No"},{onSettled:()=>{c.invalidateQueries(["student-by-id"])},onSuccess:N=>{s(re(N))},onError:N=>{s(le(N))}})})},f=()=>{l(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs(oe,{children:[e.jsx(W,{variant:"h6",children:"Student Profile"}),e.jsxs(h,{direction:"row",justifyContent:"flex-end",alignItems:"center",columnGap:2,children:[e.jsx(z,{startIcon:e.jsx(gn,{}),onClick:i,children:"Edit"}),e.jsx(z,{startIcon:e.jsx($n,{}),onClick:()=>u(!0),children:"Parent Info"}),e.jsx(z,{startIcon:e.jsx(pi,{}),onClick:a,children:"Medical Info"})]}),e.jsx(ie,{divider:!0,label:"Basic Info",icon:e.jsx(Sn,{})}),e.jsxs(h,{paddingY:2,children:[e.jsx(b,{label:"ID",text:t==null?void 0:t.indexnumber}),e.jsx(b,{label:"Name",text:t==null?void 0:t.fullName}),e.jsx(b,{label:"Date of Birth",text:Mn(new Date(t==null?void 0:t.dateofbirth)).format("Do MMMM, YYYY.")}),e.jsx(b,{label:"Gender",text:t==null?void 0:t.gender})]}),e.jsx(ie,{divider:!0,label:"Contact Info.",icon:e.jsx(mi,{})}),e.jsxs(h,{paddingY:2,children:[e.jsx(b,{label:"Email Address",text:t==null?void 0:t.email}),e.jsx(b,{label:"Telephone Number",text:t==null?void 0:t.phonenumber}),e.jsx(b,{label:"Address",text:t==null?void 0:t.address}),e.jsx(b,{label:"Residence",text:t==null?void 0:t.residence}),e.jsx(b,{label:"Nationality",text:t==null?void 0:t.nationality})]}),e.jsx(ie,{divider:!0,label:"Academic Info.",icon:e.jsx(gn,{})}),e.jsxs(h,{paddingY:2,children:[e.jsx(b,{label:"Current Level",text:o||`${t==null?void 0:t.levelName} `}),e.jsx(b,{label:"Previous School",text:`${((B=(R=t==null?void 0:t.academic)==null?void 0:R.previousSchool)==null?void 0:B.name)||"Not Available"} `}),e.jsx(z,{startIcon:e.jsx(xi,{}),onClick:f,variant:"contained",sx:{alignSelf:"flex-end"},children:"Previous Report"})]}),e.jsx(ie,{divider:!0,label:"Account Info.",icon:e.jsx(si,{})}),e.jsx(b,{label:"Account Status",text:t!=null&&t.active?"Active":"Disabled"}),e.jsx(J,{sx:{display:"flex",justifyContent:"flex-end",paddingY:1},children:e.jsx(z,{variant:"contained",color:"error",endIcon:e.jsx(ci,{}),onClick:y,children:t!=null&&t.active?"Disable Account":"Enable Account"})})]}),e.jsx(Vn,{}),e.jsx(bi,{open:g,setOpen:u}),e.jsx(wn,{medical:{...t==null?void 0:t.medical,id:t==null?void 0:t._id}}),e.jsx(gi,{report:(E=(M=t==null?void 0:t.academic)==null?void 0:M.previousSchool)==null?void 0:E.report,open:P,setOpen:l})]})};Rn.propTypes={student:A.object};const In=({data:t})=>{const{studentId:o}=ne();return e.jsxs(oe,{children:[e.jsx(W,{variant:"h6",children:"Student Fees History"}),e.jsx(h,{sx:{width:"100%",maxHeight:"100vh",overflowY:"scroll"},children:(t==null?void 0:t.fees)!==void 0?e.jsx(e.Fragment,{children:t==null?void 0:t.fees.map(s=>{const d=vn();return e.jsx(Qn,{item:s,studentId:o},d)})}):e.jsx("div",{children:"No Fees History Available"})})]})};In.propTypes={studentId:A.string};const zn=({item:t})=>{var d;const{schoolSessionDispatch:o}=C.useContext(L),s=c=>{o({type:"openViewExamsRecord",payload:{open:!0,id:c}})};return e.jsx(Ln,{subheader:e.jsx(Gn,{sx:{bgcolor:"primary.main",color:"secondary.main"},children:t[0]}),sx:{paddingY:1},children:(d=t[1])==null?void 0:d.map(({term:c,_id:g,levelName:u})=>e.jsx(Kn,{onClick:()=>s(g),children:e.jsx(_n,{primary:u,secondary:c,primaryTypographyProps:{fontSize:14},secondaryTypographyProps:{fontSize:13,color:"primary.main",fontWeight:"bold"}})},g))})};zn.propTypes={item:A.array};const Wn=()=>{const{palette:t}=On(),o=C.useRef(),{schoolSessionDispatch:s,schoolSessionState:{examsRecord:d}}=C.useContext(L),{data:c}=Z({queryKey:["student-exams-records",d.id],queryFn:()=>Xn(d.id),enabled:!!d.id}),g=()=>{s({type:"openViewExamsRecord",payload:{open:!1,id:""}})},u=Un.useReactToPrint({documentTitle:"Student Report",contentRef:o});return e.jsxs(e.Fragment,{children:[e.jsxs(H,{open:d.open,onClose:g,maxWidth:"md",fullWidth:!0,TransitionComponent:kn,children:[e.jsx(q,{title:"Exams Details",onClose:g}),e.jsx(ni,{children:e.jsx(z,{onClick:()=>u(),children:"Print Report"})}),e.jsxs(Y,{children:[e.jsx(h,{direction:"row",spacing:2,children:e.jsxs(W,{variant:"h5",children:[c==null?void 0:c.level,"-",c==null?void 0:c.term]})}),e.jsx(h,{children:e.jsxs("table",{style:{textAlign:"center",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Subject"}),e.jsx("th",{children:" Class Score (50%)"}),e.jsx("th",{children:" Exams Score (50%)"}),e.jsx("th",{children:"Total Score (100%)"}),e.jsx("th",{children:"Grade"}),e.jsx("th",{children:"Remarks"})]})}),e.jsx("tbody",{children:(c==null?void 0:c.scores)!==void 0?(c==null?void 0:c.scores.length)!==0&&(c==null?void 0:c.scores.map(P=>e.jsx(Jn,{item:P},P.subject))):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",style:{padding:"3px 1px",fontSize:"20px"},children:"No Student Record Available"})})}),e.jsx("tfoot",{style:{textAlign:"center",textDecoration:"underline",borderTop:`solid 5px ${t.secondary.main}`,bgcolor:"primary.main",color:"primary.contrastText",width:"100%",padding:1},children:e.jsxs("tr",{children:[e.jsx("th",{children:"Overall Score"}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{children:c==null?void 0:c.overallScore}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{})]})})]})})]})]}),e.jsx("div",{className:"print-container",ref:o,children:e.jsx(ei,{student:c})})]})};Wn.propTypes={open:A.bool,setOpen:A.func};const ui=be.memo(Wn),Ci=({data:t})=>e.jsxs(oe,{children:[e.jsx(W,{variant:"h6",children:"Student Academics"}),e.jsx(h,{children:t!==void 0?e.jsx(e.Fragment,{children:t==null?void 0:t.map((o,s)=>e.jsx(zn,{item:o},s))}):e.jsx("div",{children:"No Academic Records Available"})}),e.jsx(ui,{})]}),ct=()=>{var i;const{userState:{session:t}}=C.useContext(Fn),o=ee(),{studentId:s,type:d,id:c}=ne(),{schoolSessionDispatch:g}=C.useContext(L),[u,P]=C.useState("1"),{data:l}=Z({queryKey:["student-profile",s],queryFn:()=>Yn(s),enabled:!!s,initialData:(i=o.getQueryData(["all-students"]))==null?void 0:i.find(j=>(j==null?void 0:j._id)===s)}),r=Z({queryKey:["student-academics",s],queryFn:()=>Zn(t,s,c),enabled:!!s&&!!c}),n=Z({queryKey:["student-fees",s],queryFn:()=>ti(s),enabled:!!s}),a=()=>{g({type:"sendQuickMessage",payload:{open:!0,data:{email:l==null?void 0:l.email,phonenumber:l==null?void 0:l.phonenumber}}})};return e.jsxs(e.Fragment,{children:[e.jsx(ii,{to:"/student/view",color:"primary.main"}),e.jsxs(oe,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},justifyContent:{xs:"center",md:"space-between"},alignItems:{xs:"center",md:"start"},gap:5,pt:5},children:[e.jsxs(h,{spacing:1,justifyContent:"center",alignItems:"center",py:2,sx:{position:{xs:"relative",md:"-webkit-sticky"},top:0,minWidth:300},children:[e.jsx(pe,{srcSet:(l==null?void 0:l.profile)===""||(l==null?void 0:l.profile)===void 0?null:l==null?void 0:l.profile,sx:{width:100,height:100}}),e.jsx(W,{children:l==null?void 0:l.indexnumber}),e.jsx(W,{variant:"h6",children:l==null?void 0:l.fullName}),e.jsx(W,{variant:"body2",children:d||`${l==null?void 0:l.levelName}`}),e.jsx(z,{variant:"contained",startIcon:e.jsx(Cn,{}),onClick:a,children:"Send Message"})]}),e.jsx(J,{sx:{flexGrow:1},children:e.jsxs(ai,{value:u,children:[e.jsxs(ri,{onChange:(j,y)=>P(y),variant:"scrollable",scrollButtons:"auto",children:[e.jsx(se,{value:"1",label:"Profile",icon:e.jsx(Sn,{}),iconPosition:"start"}),e.jsx(se,{value:"2",label:"Academic Records",icon:e.jsx(li,{}),iconPosition:"start"}),e.jsx(se,{value:"3",label:"Fees History",icon:e.jsx(oi,{}),iconPosition:"start"})]}),e.jsx(je,{}),e.jsx(ce,{value:"1",children:e.jsx(Rn,{student:l})}),e.jsx(ce,{value:"2",children:e.jsx(Ci,{data:r==null?void 0:r.data})}),e.jsx(ce,{value:"3",children:e.jsx(In,{data:n==null?void 0:n.data})})]})})]})]})};export{ct as default};
