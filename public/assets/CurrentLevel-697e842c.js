import{r as o,U as b,R as w,a9 as D,u as I,S as L,_ as T,h as A,j as e,i as N,z as k,t as E,B as g,v as B,l as M,q as S,ck as F,cl as O,N as f,w as P,x as _,Q as C,P as z,c0 as U,Y as G,cm as H,M as Q,J as $,bt as q,af as R,cn as X,V as Y,X as J,G as V}from"./index-97ebb758.js";import{d as W}from"./School-e184199c.js";import{a as K}from"./studentColumns-d0a36e3e.js";import{b as Z}from"./studentAPI-95ea0a9f.js";function ee(){var h;const{userState:{session:s}}=o.useContext(b),{state:i}=w();D();const c=I(),[p,m]=o.useState([]),[a,n]=o.useState(!0),{schoolSessionState:d,schoolSessionDispatch:l}=o.useContext(L),t=d.fileData;o.useEffect(()=>{if(t.data.length>0){const r=t.columns.map(u=>({title:T.upperCase(u),field:u}));m(r)}n(!1)},[t]);const j=()=>{f.fire({title:"Exiting",text:"Do you want to exit?",showCancelButton:!0,backdrop:!1}).then(({isConfirmed:r})=>{r&&l({type:"closeFileDialog"})})},{mutateAsync:v}=A({mutationFn:Z}),y=()=>{n(!0);const r={students:t.data,session:{sessionId:s.sessionId,termId:s.termId,levelId:i.levelId},type:t.type};f.fire({title:"Importing students",text:"Do you want to import ?",showCancelButton:!0,backdrop:!1}).then(({isConfirmed:u})=>{u&&v(r,{onSettled:()=>{c.invalidateQueries(["current-students"]),n(!1)},onSuccess:x=>{l(P(x))},onError:x=>{l(_(x))}}),n(!1)})};return e.jsxs(N,{open:t.open,fullScreen:!0,fullWidth:!0,children:[e.jsx(k,{children:"Preview"}),e.jsxs(E,{sx:{paddingX:3},children:[e.jsx(g,{onClick:j,children:"Cancel"}),e.jsx(B,{variant:"contained",loading:a,onClick:y,children:"Save"})]}),e.jsx(M,{children:((h=t.data)==null?void 0:h.length)===0?e.jsx(S,{children:"No data available"}):e.jsx(F,{title:"Students",isLoading:a,icons:O,columns:p,data:t.data,options:{pageSize:10,pageSizeOptions:[10,20,30,50]}})})]})}const te=()=>{const{id:s,type:i}=C(),c=z(),[p,m]=o.useState(!1),{students:a,rollNumber:n,levelLoading:d}=U(s),l=()=>{c("/student/new")},t=()=>{c(`/level/attendance/${s}/${i}`)};return d?e.jsx(G,{value:"Loading Student Information"}):e.jsxs(e.Fragment,{children:[(a==null?void 0:a.length)===0?e.jsx(H,{img:Q.student,message:"ðŸ˜‘ No Student available.Add your first student to this level",buttonText:"New Student",onClick:l,showAddButton:!0}):e.jsx($,{search:!0,isLoading:d,title:i,subtitle:`${n} Students`,exportFileName:i||"",columns:K,data:a,actions:[],autoCompleteComponent:e.jsx(g,{variant:"contained",startIcon:e.jsx(q,{}),onClick:t,children:"Make New Attendance"}),icon:R}),e.jsx(X,{open:p,setOpen:m}),e.jsx(ee,{})]})},ie=()=>{const{type:s}=C();return e.jsxs(e.Fragment,{children:[e.jsx(Y,{to:"/level",color:"primary.main"}),e.jsxs(J,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:{xs:"space-around",md:"space-between"},alignItems:"center",bgcolor:"#fff",mb:4,p:1},children:[e.jsx(V,{title:"Current Level",subtitle:"Track,manage and control academic and class activities",icon:e.jsx(W,{color:"inherit",sx:{width:50,height:50}}),color:"primary.main"}),e.jsx(S,{variant:"h5",paragraph:!0,whiteSpace:"nowrap",children:s})]}),e.jsx(te,{})]})};export{ie as default};
